/*! For license information please see license.js.LICENSE.txt */
!function(e){"use strict";var s=wp.i18n.__,t=wp?.url?.addQueryArgs;function a(){var e=window.location.href,a=t(e,{success:!0,message:s("License has been activated","embedpress")});window.location.href=a}e(document).on("click",".embedpress-license-activation-btn",function(t){t.preventDefault();let o=e(this);const r=e("#embedpress-pro-license-key").val();r&&(o.attr("disabled","disabled"),o.html(s("Sending Request.....","embedpress"))),e.ajax({type:"POST",url:ajaxurl,data:{action:"embedpress/license/activate",_nonce:embedpressLicenseData.nonce,license_key:r},success:function(t){t.success?"valid"===t.data.license?a():"required_otp"===t.data.license&&(o.html(s("Verification Required","embedpress")),e("#valid-license-key-message").removeClass("hidden"),e("#email-placeholder").text(t.data.customer_email),e("#embedpress-pro-license-key").attr("disabled","disabled"),e(".embedpress-toast__message.toast__message--success p").text("Verification Code Sent successfully"),e(".toast__message--success").addClass("show-toast"),setTimeout(()=>{e(".toast__message--success").removeClass("show-toast")},2e3),e("#otp-varify-form").removeClass("hidden")):(o.html(s("Active License","embedpress")),o.removeAttr("disabled"),e(".embedpress-toast__message.toast__message--error p").text(t?.data?.message),e(".toast__message--error").addClass("show-toast"),setTimeout(()=>{e(".toast__message--error").removeClass("show-toast")},2e3))},error:function(e,s,t){console.error("Error:",s,t)}})}),e(document).on("click",".embedpress-verification-activation-btn",function(t){t.preventDefault();let o=e(this);const r=e("#embedpress-pro-license-key").val(),c=e("#embedpress-pro-verification-key").val();e("#invalid-verification-key-message").addClass("hidden"),r&&(o.attr("disabled","disabled"),o.html(s("Verifying.....","embedpress"))),e.ajax({type:"POST",url:ajaxurl,data:{action:"embedpress/license/submit-otp",_nonce:embedpressLicenseData.nonce,license:r,otp:c},success:function(t){console.log("Success:",t),t.success?(o.html(s("Verified","embedpress")),a()):(o.html("Verify"),o.removeAttr("disabled"),e(".embedpress-toast__message.toast__message--error p").text(t?.data?.message),e(".toast__message--error").addClass("show-toast"),setTimeout(()=>{e(".toast__message--error").removeClass("show-toast")},2e3))},error:function(e,s,t){console.error("Error:",s,t)}})}),e(document).on("click","#resend-license-verification-key",function(t){t.preventDefault(),e(this);const a=e("#embedpress-pro-license-key").val();e("#resend-license-verification-key").text(s("Resending","embedpress")),e.ajax({type:"POST",url:ajaxurl,data:{action:"embedpress/license/resend-otp",_nonce:embedpressLicenseData.nonce,license:a},success:function(t){console.log("Success:",t),t.success?(e(".embedpress-toast__message.toast__message--success p").text("Verification Code Resent Successfully."),e(".toast__message--success").addClass("show-toast"),setTimeout(()=>{e(".toast__message--success").removeClass("show-toast")},2e3)):(e(".embedpress-toast__message.toast__message--error p").text(t?.data?.message),e(".toast__message--error").addClass("show-toast"),setTimeout(()=>{e(".toast__message--error").removeClass("show-toast")},2e3)),e("#resend-license-verification-key").text(s("Resend","embedpress"))},error:function(e,s,t){console.error("Error:",s,t)}})}),e(document).on("click",".embedpress-license-deactivation-btn",function(a){a.preventDefault();let o=e(this);const r=e("#embedpress-pro-license-key").val();e("#embedpress-pro-verification-key").val(),console.log(r),r&&(o.attr("disabled","disabled"),o.html(s("Deactivating.....","embedpress"))),e.ajax({type:"POST",url:ajaxurl,data:{action:"embedpress/license/deactivate",_nonce:embedpressLicenseData.nonce},success:function(e){var a,o;console.log("Success:",e),e.success&&(a=window.location.href,o=t(a,{success:!0,message:s("License has been deactivated","embedpress")}),window.location.href=o)},error:function(e,s,t){console.error("Error:",s,t)}})})}(jQuery);