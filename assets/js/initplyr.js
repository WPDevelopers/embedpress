var playerInit=[];function initPlayer(e){const t=e.getAttribute("data-playerid");console.log({wrapper:e});let a=document.querySelector(`[data-playerid='${t}']`)?.getAttribute("data-options");if(!a)return!1;if("string"!=typeof a)return void console.error("Options is not a string");try{a=JSON.parse(a)}catch(e){return void console.error("Invalid JSON format:",e)}const r=document.createElement("div");r.className="pip-play",r.innerHTML='<svg width="20" height="20" viewBox="-0.15 -0.112 0.9 0.9" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMinYMin" class="jam jam-play"><path fill="#fff" d="M.518.357A.037.037 0 0 0 .506.306L.134.08a.039.039 0 0 0-.02-.006.038.038 0 0 0-.038.037v.453c0 .007.002.014.006.02a.039.039 0 0 0 .052.012L.506.37A.034.034 0 0 0 .518.358zm.028.075L.174.658A.115.115 0 0 1 .017.622.109.109 0 0 1 0 .564V.111C0 .05.051 0 .114 0c.021 0 .042.006.06.017l.372.226a.11.11 0 0 1 0 .189z"/></svg>',r.style.display="none";const l=document.createElement("div");l.className="pip-pause",l.innerHTML='<svg fill="#fff" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 2.5 2.5" xml:space="preserve"><path d="M1.013.499 1.006.5V.499H.748a.054.054 0 0 0-.054.054v1.394c0 .03.024.054.054.054h.266a.054.054 0 0 0 .054-.054V.553a.054.054 0 0 0-.054-.054zm.793 1.448V.553a.054.054 0 0 0-.054-.054L1.745.5V.499h-.258a.054.054 0 0 0-.054.054v1.394c0 .03.024.054.054.054h.265a.054.054 0 0 0 .054-.054z"/></svg>';const o=document.createElement("div");if(o.className="pip-close",o.innerHTML='<svg width="20" height="20" viewBox="0 0 0.9 0.9" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M.198.198a.037.037 0 0 1 .053 0L.45.397.648.199a.037.037 0 1 1 .053.053L.503.45l.198.198a.037.037 0 0 1-.053.053L.45.503.252.701A.037.037 0 0 1 .199.648L.397.45.198.252a.037.037 0 0 1 0-.053z" fill="#fff"/></svg>',t&&!e.classList.contains("plyr-initialized")){let r=`[data-playerid='${t}'] .ose-embedpress-responsive`;a.self_hosted&&"video"===a.hosted_format?r=`[data-playerid='${t}'] .ose-embedpress-responsive video`:a.self_hosted&&"audio"===a.hosted_format&&(r=`[data-playerid='${t}'] .ose-embedpress-responsive audio`,e.style.opacity="1"),document.querySelector(`[data-playerid='${t}']`).style.setProperty("--plyr-color-main",a.player_color),document.querySelector(`[data-playerid='${t}'].custom-player-preset-1, [data-playerid='${t}'].custom-player-preset-3, [data-playerid='${t}'].custom-player-preset-4`)?.style.setProperty("--plyr-range-fill-background","#ffffff"),document.querySelector(`[data-playerid='${t}'] iframe`)&&document.querySelector(`[data-playerid='${t}'] iframe`).setAttribute("data-poster",a.poster_thumbnail),document.querySelector(`[data-playerid='${t}'] video`)&&document.querySelector(`[data-playerid='${t}'] video`).setAttribute("data-poster",a.poster_thumbnail);const l=["play-large",a.restart?"restart":"",a.rewind?"rewind":"","play",a.fast_forward?"fast-forward":"","progress","current-time","duration","mute","volume","captions","settings",a.pip?"pip":"","airplay",a.download?"download":"",a.fullscreen?"fullscreen":""].filter(e=>""!==e),o=new Plyr(r,{controls:l,seekTime:10,poster:a.poster_thumbnail,storage:{enabled:!0,key:"plyr_volume"},displayDuration:!0,tooltips:{controls:a.player_tooltip,seek:a.player_tooltip},hideControls:a.hide_controls,youtube:{...a.autoplay&&{autoplay:a.autoplay},...a.start&&{start:a.start},...a.end&&{end:a.end},...a.rel&&{rel:a.rel},...a.fullscreen&&{fs:a.fullscreen}},vimeo:{byline:!1,portrait:!1,title:!1,speed:!0,transparent:!1,controls:!1,...a.t&&{t:a.t},...a.vautoplay&&{autoplay:a.vautoplay},...a.autopause&&{autopause:a.autopause},...a.dnt&&{dnt:a.dnt}}});playerInit[t]=o,e.classList.add("plyr-initialized");const s=e.querySelector(".plyr__poster");if(s){const t=setInterval(()=>{s&&s.style.backgroundImage&&(e.style.opacity="1",clearInterval(t))},200)}}const s=setInterval(()=>{let e=document.querySelector(`[data-playerid="${t}"] [data-plyr="pip"]`);if(e){clearInterval(s);let a=document.querySelector(`[data-playerid="${t}"]`).getAttribute("data-options");if(a=JSON.parse(a),!a.self_hosted){const s=document.querySelector(`[data-playerid="${t}"] .plyr__video-wrapper`);if(e.addEventListener("click",()=>{s.classList.toggle("pip-mode");let e=s.parentElement;for(;e;)e.style.zIndex="9999",e=e.parentElement}),a.pip){s.appendChild(r),s.appendChild(l),s.appendChild(o);const e=document.querySelector(`[data-playerid="${t}"] .plyr__video-wrapper .pip-play`),a=document.querySelector(`[data-playerid="${t}"] .plyr__video-wrapper .pip-pause`);document.querySelector(`[data-playerid="${t}"] .plyr__video-wrapper .pip-close`).addEventListener("click",()=>{s.classList.remove("pip-mode"),console.log(s.classList)}),s.addEventListener("click",()=>{const r=document.querySelector(`[data-playerid="${t}"] .plyr__controls [data-plyr="play"]`).getAttribute("aria-pressed");console.log(r),"true"===r?(a.style.display="none",e.style.display="flex"):(e.style.display="none",a.style.display="flex")})}}}},200)}document.addEventListener("DOMContentLoaded",function(){function e(t){t.nodeType===Node.ELEMENT_NODE&&t.classList.contains("ep-embed-content-wraper")&&initPlayer(t),t.hasChildNodes()&&t.childNodes.forEach(t=>{e(t)})}document.createElement("div").className="overlay-mask",document.querySelectorAll(".ep-embed-content-wraper").forEach(e=>{initPlayer(e)}),new MutationObserver(t=>{t.forEach(t=>{Array.from(t.addedNodes).forEach(t=>{e(t)})})}).observe(document.body,{childList:!0,subtree:!0})});