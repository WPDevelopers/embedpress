const embedpressDocViewer={};document.addEventListener("fullscreenchange",()=>{if(!document.fullscreenElement){const e=document.querySelector(".ep-file-download-option-masked.fullscreen-enabled");e&&(e.classList.remove("fullscreen-enabled"),e.querySelector(".ep-doc-minimize-icon").style.display="none",e.querySelector(".ep-doc-fullscreen-icon").style.display="flex")}}),document.addEventListener("keydown",e=>{"Escape"===e.key&&document.querySelector(".ep-file-download-option-masked.fullscreen-enabled")&&(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen())}),embedpressDocViewer.getColorBrightness=e=>{const t=parseInt(e.slice(1,3),16),n=parseInt(e.slice(3,5),16),o=parseInt(e.slice(5,7),16),c=(Math.max(t,n,o)+Math.min(t,n,o))/2;return Math.round(c/255*100)},embedpressDocViewer.adjustHexColor=(e,t)=>{const n=parseInt(e.slice(1,3),16),o=parseInt(e.slice(3,5),16),c=parseInt(e.slice(5,7),16),s=Math.round(t/100*255);return"#"+((1<<24)+(Math.max(Math.min(n+s,255),0)<<16)+(Math.max(Math.min(o+s,255),0)<<8)+Math.max(Math.min(c+s,255),0)).toString(16).slice(1)},embedpressDocViewer.viewerStyle=()=>{const e=document.querySelectorAll(".ep-file-download-option-masked");let t=document.getElementById("custom-styles")||document.createElement("style");t.id="custom-styles",t.type="text/css",t.innerHTML="",null!==e&&(e.forEach(e=>{let n=e.getAttribute("data-custom-color");if(null==n)return!1;let o=embedpressDocViewer.getColorBrightness(n),c=e.getAttribute("data-id"),s="#f2f2f6";o>60&&(s="#343434"),"custom"==e.getAttribute("data-theme-mode")&&(viewerCustomColor=`    \n                [data-id='${c}'][data-theme-mode='custom'] {\n                    --viewer-primary-color: ${n};\n                    --viewer-icons-color: ${s};\n                    --viewer-icons-hover-bgcolor: ${embedpressDocViewer.adjustHexColor(n,-10)};\n                \n                }`,t.innerHTML+=viewerCustomColor)}),document.head.appendChild(t))},embedpressDocViewer.epDocumentsViewerController=()=>{const e=document.querySelectorAll(".ep-file-download-option-masked");document.addEventListener("click",function(e){e.stopPropagation();const t=e.target.closest(".ep-file-download-option-masked");if(!t)return;const n=t.querySelector("iframe");if(!n)return;const o=decodeURIComponent(n.getAttribute("src"));if(!o)return;const c=o.match(/(url|src)=([^&]+)/);let s=c&&c[2];s||(s=o);const r=e.target.closest(".ep-doc-popup-icon svg"),l=e.target.closest(".ep-doc-print-icon svg"),i=e.target.closest(".ep-doc-download-icon svg"),d=e.target.closest(".ep-doc-minimize-icon svg"),u=e.target.closest(".ep-doc-fullscreen-icon svg");r instanceof SVGElement?window.open(s,"_blank"):l instanceof SVGElement?window.open(`https://view.officeapps.live.com/op/view.aspx?src=${s}&wdOrigin=BROWSELINK`,"_blank"):i instanceof SVGElement?fetch(s,{mode:"no-cors"}).then(e=>{e.ok?e.blob().then(e=>{const t=window.URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download=s.substring(s.lastIndexOf("/")+1),document.body.appendChild(n),n.click(),n.remove()}):window.location.href=s}).catch(e=>{window.location.href=s}):d instanceof SVGElement?document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen():u instanceof SVGElement&&(t.requestFullscreen?t.requestFullscreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen(),t.querySelector(".ep-doc-minimize-icon").style.display="flex",t.querySelector(".ep-doc-fullscreen-icon").style.display="none",t.classList.add("fullscreen-enabled"))}),document.addEventListener("click",function(e){e.stopPropagation();const t=e.target.closest(".ep-doc-draw-icon svg");if(!t)return;const n=t.closest(".ep-file-download-option-masked");if(!n)return;const o=n.querySelector(".ep-doc-canvas"),c=n.querySelector(".ep-doc-draw-icon svg");if(!o||!c)return;const s=o.getContext("2d");let r=!1,l=!1;o.addEventListener("mousedown",function(e){if(l){r=!0;const t=o.getBoundingClientRect(),n=window.pageXOffset||document.documentElement.scrollLeft,c=e.pageX-t.left-n,l=e.pageY-t.top;s.beginPath(),s.moveTo(c,l)}}),o.addEventListener("mousemove",function(e){if(r&&l){const t=o.getBoundingClientRect(),n=window.pageXOffset||document.documentElement.scrollLeft,c=e.pageX-t.left-n,r=e.pageY-t.top;s.lineTo(c,r),s.stroke()}}),o.addEventListener("mouseup",function(e){r=!1}),c.parentNode.classList.toggle("active"),l=c.parentNode.classList.contains("active"),o.style.display=l?"block":"none"}),document.addEventListener("fullscreenchange",function(){document.fullscreenElement||e.forEach(e=>{e.classList.remove("fullscreen-enabled"),e.querySelector(".ep-doc-minimize-icon").style.display="none",e.querySelector(".ep-doc-fullscreen-icon").style.display="flex"})})},"function"==typeof embedpressDocViewer.epDocumentsViewerController&&jQuery(".wp-block-embedpress-document.embedpress-document-embed").length>0&&embedpressDocViewer.epDocumentsViewerController(),"undefined"!=typeof wp&&void 0!==wp.editor&&"function"==typeof embedpressDocViewer.viewerStyle&&embedpressDocViewer.epDocumentsViewerController(),"function"==typeof embedpressDocViewer.viewerStyle&&jQuery(".wp-block-embedpress-document.embedpress-document-embed").length>0&&embedpressDocViewer.viewerStyle(),jQuery(window).on("elementor/frontend/init",function(){elementorFrontend.hooks.addAction("frontend/element_ready/embedpres_document.default",function(e,t){"function"==typeof embedpressDocViewer.epDocumentsViewerController&&embedpressDocViewer.epDocumentsViewerController(),"function"==typeof embedpressDocViewer.epDocumentsViewerController&&embedpressDocViewer.viewerStyle()})});const myDivs=document.querySelectorAll(".ep-file-download-option-masked"),canDownloadDivs=document.querySelectorAll(".enabled-file-download");function preventRightClick(e){e.preventDefault()}myDivs.forEach(function(e){e.addEventListener("contextmenu",preventRightClick)}),canDownloadDivs.forEach(function(e){e.removeEventListener("contextmenu",preventRightClick)});