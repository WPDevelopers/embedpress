(function(){"use strict";/**
 * @package     EmbedPress
 * @author      EmbedPress <help@embedpress.com>
 * @copyright   Copyright (C) 2018 EmbedPress. All rights reserved.
 * @license     GPLv2 or later
 * @since       1.0
 */(function(a,T,_,R){a(window.document).ready(function(){T.prototype.capitalizeFirstLetter=function(){return this.charAt(0).toUpperCase()+this.slice(1)},T.prototype.isValidUrl=function(){var e=/^(https?|embedpresss?):\/\//i;return e.test(this.toString())},T.prototype.hasShortcode=function(e){var g=new RegExp("\\["+e+"(?:\\]|.+?\\])","ig");return!!this.toString().match(g)},T.prototype.stripShortcode=function(e){var g=new RegExp("(\\["+e+"(?:\\]|.+?\\])|\\[\\/"+e+"\\])","ig");return this.toString().replace(g,"")},T.prototype.setShortcodeAttribute=function(e,g,w,r){r=typeof r=="undefined"?!1:r;var t=this.toString();if(t.hasShortcode(w)){var n=t.getShortcodeAttributes(w);if(n.hasOwnProperty(e)?r?n[e]=g:n[e]+=" "+g:n[e]=g,Object.keys(n).length){var i=[];for(var o in n)i.push(o+'="'+n[o]+'"');t="["+w+" "+i.join(" ")+"]"+t.stripShortcode(w)+"[/"+w+"]"}else t="["+w+"]"+t.stripShortcode(w)+"[/"+w+"]";return t}else return t},T.prototype.getShortcodeAttributes=function(e){var g=this.toString();if(g.hasShortcode(e)){var w={},r=new RegExp(/\[embed\s*(.*?)\]/ig).exec(g)[1];if(r.length>0){for(var t=new RegExp(/(\!?\w+-?\w*)(?:="(.+?)")?/ig),n;n=t.exec(r);){var i=n[1],o;n[2]===R?i.toLowerCase()!=="class"&&(i.indexOf("!")===0?(i=i.replace("!",""),o="false"):o="true",w[i]=o):(o=n[2],o.isBoolean()&&(o=o.isFalse()?"false":"true"),w[i]=o)}n=t=null}return r=null,w}else return{}},T.prototype.isBoolean=function(){var e=this.toString().trim().toLowerCase();return e.isTrue(!1)||e.isFalse()},T.prototype.isTrue=function(e){var g=this.toString().trim().toLowerCase();switch(e=typeof e===R?!0:e,g){case"":return e+="",!e.isFalse();case"1":case"true":case"on":case"yes":case"y":return!0;default:return!1}},T.prototype.isFalse=function(){var e=this.toString().trim().toLowerCase();switch(e){case"0":case"false":case"off":case"no":case"n":case"nil":case"null":return!0;default:return!1}};var k=new RegExp("\\[/?"+_.shortcode+"\\]","gi"),W=function(){var e=this,g=_.assetsUrl+"css",w=g;e.params={baseUrl:"",versionUID:"0"},e.iOS=/iPad|iPod|iPhone/.test(window.navigator.userAgent),e.activeWrapper=null,e.activeWrapperForModal=null,e.activeControllerPanel=null,e.loadedEditors=[],e.init=function(r){a.extend(e.params,r),e.iOS&&a(window.document.body).css("cursor","pointer"),a(e.onReady)},e.addEvent=function(r,t,n){typeof t.on!="undefined"?t.on(r,n):t["on"+r.capitalizeFirstLetter()]&&t["on"+r.capitalizeFirstLetter()].add(n)},e.isEmpty=function(r){return r.length===0},e.isDefined=function(r){return typeof r!="undefined"&&r!==null},e.makeId=function(){for(var r="",t="abcdefghijklmnopqrstuvwxyz0123456789",n=0;n<5;n++)r+=t.charAt(Math.floor(Math.random()*t.length));return r},e.loadAsyncDynamicJsCodeFromElement=function(r,t,n){if(r=a(r),r.prop("tagName")&&r.prop("tagName").toLowerCase()==="script"){var i=r.attr("src")||null;i?e.addScript(i,null,t,n):e.addScriptDeclaration(t,r.html(),n)}else{var o=a("script",r);o.length>0&&a.each(o,function(s,d){e.loadAsyncDynamicJsCodeFromElement(d,t,n)})}},e.onReady=function(){var r=function(){var t=window.setInterval(function(){var n=e.getEditors();if(n.length){e.loadedEditors=n;for(var i=0;i<e.loadedEditors.length;i++)e.onFindEditor(e.loadedEditors[i]);return window.clearInterval(t),e.loadedEditors}},250)};e.tinymceIsAvailable()&&r(),typeof FLLightbox!="undefined"&&a.each(FLLightbox._instances,function(t){FLLightbox._instances[t].on("open",function(){setTimeout(function(){r()},500)}),FLLightbox._instances[t].on("didHideLightbox",function(){setTimeout(function(){r()},500)})})},e.tinymceIsAvailable=function(){return typeof window.tinymce=="object"||typeof window.tinyMCE=="object"},e.controllerPanelIsActive=function(){return typeof e.activeControllerPanel!="undefined"&&e.activeControllerPanel!==null},e.getEditors=function(){return!window.tinymce||!window.tinymce.editors||window.tinymce.editors.length===0?[]:window.tinymce.editors||[]},e.getParsedContent=function(r,t){a.ajax({type:"POST",url:e.params.baseUrl+"wp-admin/admin-ajax.php",data:{action:"embedpress_do_ajax_request",subject:r},success:t,dataType:"json",async:!0})},e.addStylesheet=function(r,t){var n=t.getDoc().getElementsByTagName("head")[0],i=a('<link rel="stylesheet" type="text/css" href="'+r+'">');i.appendTo(n)},e.convertURLSchemeToPattern=function(r){var t="(.*)((?:http|embedpress)s?:\\/\\/(?:www\\.)?",n="[\\/]?)(.*)";return r=r.replace(/\*/g,"[a-zA-Z0-9=&_\\-\\?\\.\\/!\\+%:@,#]+"),r=r.replace(/\./g,"\\."),r=r.replace(/\//g,"\\/"),t+r+n},e.getProvidersURLPatterns=function(){var r=[];return e.each(_.urlSchemes,function(n){r.push(e.convertURLSchemeToPattern(n))}),r},e.addScript=function(r,t,n,i){var o=i.getDoc();(typeof n=="undefined"||!n)&&(n=a(o.getElementsByTagName("head")[0]));var s=a(o.createElement("script"));s.attr("async",1),typeof t=="function"&&s.ready(t),s.attr("src",r),n.append(s)},e.addScriptDeclaration=function(r,t,n){var i=n.getDoc(),o=a(i.createElement("script"));a(r).append(o),o.text(t)},e.addURLsPlaceholder=function(r,t,n){var i=e.makeId(),o=["embedpress_wrapper","embedpress_placeholder","wpview","wpview-wrap"],s=r.value.getShortcodeAttributes(_.shortcode),d=s;if(Object.keys(s).length){var v=["class","href","data-href"],l="data-",h=[];for(var f in s)v.indexOf(f)===-1?f.indexOf(l)!==0?h[l+f]=s[f]:h[f]=s[f]:(f=f.replace(l,""),f==="class"&&o.push(s[f]));s=h,h=l=null}("data-width"in s||"data-height"in s)&&"data-responsive"in s&&(s["data-responsive"]="false");var p=new e.Node("div",1),u={class:Array.from(new Set(o)).join(" "),"data-url":t,"data-uid":i,id:"embedpress_wrapper_"+i,"data-loading-text":"Loading your embed..."};u=a.extend({},u,s),u.class.indexOf("is-loading")===-1&&(u.class+=" is-loading"),p.attr(u);var c=new e.Node("div",1);c.attr({id:"embedpress_controller_panel_"+i,class:"embedpress_controller_panel embedpress_ignore_mouseout hidden"}),p.append(c);function y(E,L){E=E||"span",L=L||"&nbsp;";var N=new e.Node(E,1);N.attr({class:"hidden"});var x=new e.Node("#text",3);return x.value=L,N.append(x),N}var m=new e.Node("div",1);m.attr({id:"embedpress_button_edit_"+i,class:"embedpress_ignore_mouseout embedpress_controller_button"});var C=new e.Node("div",1);C.attr({class:"embedpress-icon-pencil embedpress_ignore_mouseout"}),C.append(y()),m.append(C),c.append(m);var P=new e.Node("div",1);P.attr({id:"embedpress_button_remove_"+i,class:"embedpress_ignore_mouseout embedpress_controller_button"});var b=new e.Node("div",1);return b.attr({class:"embedpress-icon-x embedpress_ignore_mouseout"}),b.append(y()),P.append(b),c.append(P),r.value=r.value.trim(),r.replace(p),window.setTimeout(function(){e.parseContentAsync(i,t,d,n)},200),p},e.parseContentAsync=function(r,t,n,i){n=typeof n=="undefined"?{}:n,t=e.decodeEmbedURLSpecialChars(t,!0,n);var o=t.stripShortcode(_.shortcode);a(e).triggerHandler("EmbedPress.beforeEmbed",{url:o,meta:{attributes:n||{}}}),e.getParsedContent(t,function(d){var v=(typeof d.data=="object"?d.data.embed:d.data).stripShortcode(_.shortcode),l=a(e.getElementInContentById("embedpress_wrapper_"+r,i)),h=a(l.parent());if(h.prop("tagName")&&h.prop("tagName").toUpperCase()==="P"){h.replaceWith(l);var f=a(l).next();!f.length||f.prop("tagName").toUpperCase(),f=null}if(h=null,o===v){l.replaceWith(a("<p>"+o+"</p>"));return}l.removeClass("is-loading");var p;try{p=a(v)}catch(c){p=a("<div>"),p.html(v)}if(!a("iframe",p).length&&d.data.provider_name!=="Infogram"){var u=a(p).clone();u.html(""),l.removeClass("embedpress_placeholder"),l.append(u),setTimeout(function(){i.undoManager.transact(function(){var c=i.getDoc().createElement("iframe");c.src=tinymce.Env.ie?'javascript:""':"",c.frameBorder="0",c.allowTransparency="true",c.scrolling="no",c.class="wpview-sandbox",c.style.width="100%",u.append(c);var y=c.contentWindow;if(y){var m=y.document;a(c).load(function(){var C=8,P=0,b=setInterval(function(){P===C?(clearInterval(b),setTimeout(function(){l.css("width",c.width),l.css("height",c.height)},100)):(n.height?(c.height=n.height,c.style.height=n.height+"px"):c.height=a("body",m).height(),n.width?(c.width=n.width,c.style.width=n.width+"px"):c.width=a("body",m).width(),P++)},250)}),m.open(),m.write('<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style>html {background: transparent;padding: 0;margin: 0;}body#wpview-iframe-sandbox {background: transparent;padding: 1px 0 !important;margin: -1px 0 0 !important;}body#wpview-iframe-sandbox:before,body#wpview-iframe-sandbox:after {display: none;content: "";}</style></head><body id="wpview-iframe-sandbox" class="'+i.getBody().className+'" style="display: inline-block; width: 100%;" >'+p.html()+"</body></html>"),m.close()}})},50)}else l.removeClass("embedpress_placeholder"),e.appendElementsIntoWrapper(p,l,i);l.append(a('<span class="wpview-end"></span>')),d&&d.data&&typeof d.data=="object"&&(d.data.width=a(l).width(),d.data.height=a(l).height()),a(e).triggerHandler("EmbedPress.afterEmbed",{meta:d.data,url:o,wrapper:l})})},e.appendElementsIntoWrapper=function(r,t,n){return r.length>0&&a.each(r,function(o,s){s.tagName&&s.tagName.toLowerCase()!=="script"&&(t.append(a(s)),s.tagName.toLowerCase()==="iframe"?a(s).ready(function(){window.setTimeout(function(){a.each(n.dom.select("div.embedpress_wrapper iframe"),function(d,v){e.fixIframeSize(v)})},300)}):s.tagName.toLowerCase()==="div"&&((a("img",a(s)).length||a("blockquote",t).length)&&a(a(s).parents(".embedpress_wrapper").get(0)).addClass("dynamic-width"),a(s).css("max-width",a(a(s).parents("body").get(0)).width()))),e.loadAsyncDynamicJsCodeFromElement(s,t,n)}),t},e.encodeEmbedURLSpecialChars=function(r){if(r.match(k)){var t=r.replace(k,"");if(!t.isValidUrl())return r;r=t,t=null}return r=r.replace(/http(s?)\:\/\//i,"embedpress$1://"),r=r.replace("@","::__at__::").trim(),r},e.decodeEmbedURLSpecialChars=function(r,t,n){var i=/embedpress(s?):\/\//;t=typeof t=="undefined"?!0:t,n=typeof n=="undefined"?{}:n;var o=r.match(i);if(r=r.replace(/embedpress(s?):\/\//,"http$1://"),r=r.replace("::__at__::","@").trim(),"class"in n){for(var s=n.class.split(/\s/g),d=!1,v=0;v<s.length;v++)if(s[v]==="dynamic-width"){d=v;break}d!==!1&&(s.splice(d,1),s.length===0&&delete n.class,n.class=s.join(" ")),d=s=v=null}if(o&&t){var l="["+_.shortcode;if(Object.keys(n).length){var h;for(var f in n)h=n[f],f.toLowerCase()==="class"&&!h.length||(h.isBoolean()?(l+=" ",h.isFalse()&&(l+="!"),l+=f):l+=" "+f+'="'+h+'"');h=f=null}r=l+"]"+r+"[/"+_.shortcode+"]"}return r},e.onFindEditor=function(r){e.each=tinymce.each,e.extend=tinymce.extend,e.JSON=tinymce.util.JSON,e.Node=tinymce.html.Node;function t(){a(window.document.getElementsByTagName("head")[0]).append(a('<link rel="stylesheet" type="text/css" href="'+(g+"/vendor/bootstrap/bootstrap.min.css?v="+e.params.versionUID)+'">')),e.addStylesheet(g+"/font.css?v="+e.params.versionUID,r,r),e.addStylesheet(g+"/preview.css?v="+e.params.versionUID,r,r),e.addStylesheet(w+"/embedpress.css?v="+e.params.versionUID,r,r),e.addEvent("nodechange",r,e.onNodeChange),e.addEvent("keydown",r,function(v){e.onKeyDown(v,r)});var s=function(v){e.onUndo(v,r)};e.addEvent("undo",r,s),e.addEvent("undo",r.undoManager,s);var d=r.getDoc();a(d).on("mouseenter",".embedpress_wrapper",function(v){e.onMouseEnter(v,r)}),a(d).on("mouseout",".embedpress_wrapper",e.onMouseOut),a(d).on("mousedown",".embedpress_wrapper > .embedpress_controller_panel",function(v){e.cancelEvent(v,r)}),d=null,r.parser.addNodeFilter("#text",function(l,h){e.each(l,function(p){if(!(p.parent===null&&p.prev===null)){var u=p.value.trim();if(!(!u.isValidUrl()&&!u.match(k))&&(u=e.decodeEmbedURLSpecialChars(u),!(!u.isValidUrl()&&!u.match(k)))){u=p.value.stripShortcode(_.shortcode).trim();var c=e.getProvidersURLPatterns();(function y(m){if(m<c.length){var C=c[m],P=new RegExp(C),b=e.decodeEmbedURLSpecialChars(u).trim(),E=b.match(P);if(E&&E!==null&&E.length){b=e.encodeEmbedURLSpecialChars(E[2]);var L=e.addURLsPlaceholder(p,b,r);setTimeout(function(){var N=r.getDoc();if(N!==null){var x=a(N.querySelector("#"+L.attributes.map.id)),U=a(x.parent());U&&U.prop("tagName")&&U.prop("tagName").toUpperCase()==="P"&&U.replaceWith(x);var S=x.prev();S&&S.prop("tagName")&&S.prop("tagName").toUpperCase()==="P"&&!S.html().replace(/\&nbsp\;/i,"").length?S.remove():typeof S.html()!="undefined"&&S.html().match(/<[\/]?br>/)&&(S.prev().length||S.remove());var F=x.next();F&&F.length&&F.prop("tagName").toUpperCase()==="P"?!F.next().length&&!F.html().replace(/\&nbsp\;/i,"").length&&(F.remove(),a("<p>&nbsp;</p>").insertAfter(x)):a("<p>&nbsp;</p>").insertAfter(x),setTimeout(function(){r.selection.select(r.getBody(),!0),r.selection.collapse(!1)},50)}},50)}else y(m+1)}})(0)}}})}),r.serializer.addNodeFilter("div",function(l,h){e.each(l,function(p){if(!(p.parent===null&&p.prev===null)){var u=(p.attributes.map.class||"").split(" "),c=["embedpress_wrapper","embedpress_placeholder","wpview","wpview-wrap"],y=u.filter(function(S){return c.indexOf(S)!=-1}).length>0;if(y){var m=["id","style","data-loading-text","data-uid","data-url"],C={},P="data-";for(var b in p.attributes.map)if(b.toLowerCase()!=="class")m.indexOf(b)<0&&(C[b.replace(P,"")]=p.attributes.map[b]);else{var E=[];for(var L in u){var N=u[L];c.indexOf(N)===-1&&E.push(N)}E.length&&(C.class=E.join(" "))}var x=new e.Node("p",1),U=new e.Node("#text",3);U.value=p.attributes.map&&typeof p.attributes.map["data-url"]!="undefined"?e.decodeEmbedURLSpecialChars(p.attributes.map["data-url"].trim(),!0,C):"",x.append(U.clone()),p.replace(U),U.replace(x)}}})}),r.serializer.addNodeFilter("p",function(l,h){e.each(l,function(p){p.firstChild==p.lastChild&&p.firstChild&&"value"in p.firstChild&&(p.firstChild.value==="&nbsp;"||!p.firstChild.value.trim().length)&&p.remove()})}),tinymce.each(tinymce.editors,function(l){e.addEvent("loadContent",l,function(f){e.configureWrappers(l)})}),window.setTimeout(function(){r.load()},500)}var n=100,i=0,o=setInterval(function(){if(i===n)clearInterval(o),alert("For some reason TinyMCE was not fully loaded yet. Please, refresh the page and try again.");else{var s=r.getDoc();s?(clearInterval(o),t()):i++}},250)},e.fixIframeSize=function(r){var t=480;if(a(r).width()>t&&!a(r).data("size-fixed")){var n=a(r).height()/a(r).width();a(r).width(t),a(r).height(t*n),a(r).css("max-width",t),a(r).attr("max-width",t),a(r).data("size-fixed",!0)}},e.onMouseEnter=function(r,t){e.displayPreviewControllerPanel(a(r.currentTarget),t)},e.onMouseOut=function(r){if(e.isDefined(r.toElement)&&(r.toElement.parentElement==r.fromElement||a(r.toElement).hasClass("embedpress_ignore_mouseout"))||e.isDefined(r.relatedTarget)&&a(r.relatedTarget).hasClass("embedpress_ignore_mouseout"))return!1;e.hidePreviewControllerPanel()},e.onPaste=function(r,t){var n=new RegExp(/(https?):\/\/([w]{3}\.)?.+?(?:\s|$)/i),i=e.getProvidersURLPatterns(),o=t.content.split(/\n/g)||[];o=o.map(function(d,v){if(d.match(n)){let l=d.trim().split(/\s+/);l=l.map(function(h,f){var p=h.match(n);if(p)for(var u=0;u<i.length;u++){var c=new RegExp(i[u]);if(c.test(h))return"</p><p>"+p[0]+"</p><p>"}return h}),l[l.length-1]=l[l.length-1]+"<br>",d=l.join(" ")}return d});var s=o.join("");s.replace(/<br>$/,"")!==t.content&&(t.content="<p>"+t.content+"</p>")},e.onNodeChange=function(r){r.element.tagName==="BR"?r.parents.length>0&&a.each(r.parents,function(t,n){a(n).hasClass("embedpress_wrapper")&&a(n).replaceWith(a("<br>"))}):r.element.tagName==="IFRAME"&&r.parents.length>0&&a.each(r.parents,function(t,n){if(n=a(n),n.hasClass("embedpress_wrapper")){var i=a(".embedpress-wrapper",n);i.length>1&&i.get(0).remove()}})},e.onKeyDown=function(r,t){var n=t.selection.getNode();if(r.keyCode==8||r.keyCode==46){if(n.nodeName.toLowerCase()==="p"){var i=a(n).children();i.length>0&&a.each(i,function(){(a(this).hasClass("embedpress_wrapper")||a(this).hasClass("embedpress_ignore_mouseout"))&&(a(this).remove(),t.focus())})}}else{var o=[37,38,39,40];if(o.indexOf(r.keyCode)==-1&&(a(n).hasClass("embedpress_wrapper")||a(n).hasClass("embedpress_ignore_mouseout")))if(r.keyCode==13){if(wrapper=a(e.getWrapperFromChild(n)),wrapper.length>0){var s="__embedpress__tmp_"+e.makeId();wrapper.after(a('<span id="'+s+'"></span>'));var d=t.dom.select("span#"+s)[0];t.selection.select(d),a(d).remove()}return!0}else return e.cancelEvent(r,t)}return!0},e.getWrapperFromChild=function(r){if(a(r).hasClass("embedpress_wrapper"))return r;var t=a(r).parent();return t.length>0?e.getWrapperFromChild(t[0]):!1},e.onUndo=function(r,t){t.load()},e.cancelEvent=function(r,t){return r.preventDefault(),r.stopPropagation(),t.dom.events.cancel(),!1},e.onClickEditButton=function(r,t){e.cancelEvent(r,t),e.activeWrapperForModal=e.activeWrapper;var n=e.activeWrapperForModal,i=n.prop("id").replace("embedpress_wrapper_",""),o={},s=a(".embedpress-wrapper",n),d=a("iframe",n);d.length||(d=null),s.length>1&&a.each(s[0].attributes,function(){this.specified&&this.name!=="class"&&(o[this.name.replace("data-","").toLowerCase()]=this.value)});var v=d&&d.width()||s.data("width")||s.width()||"",l=d&&d.height()||s.data("height")||s.height()||"";return d=s=null,a('<div class="loader-indicator"><i class="embedpress-icon-reload"></i></div>').appendTo(n),setTimeout(function(){a.ajax({type:"GET",url:e.params.baseUrl+"wp-admin/admin-ajax.php",data:{action:"embedpress_get_embed_url_info",url:e.decodeEmbedURLSpecialChars(n.data("url"),!1)},beforeSend:function(h,f){a(".loader-indicator",n).addClass("is-loading")},success:function(h){if(!h){bootbox.alert("Unable to get a valid response from the server.");return}if(h.canBeResponsive){var f=!0;("width"in o||"height"in o||"responsive"in o&&o.responsive.isFalse())&&(f=!1)}bootbox.dialog({className:"embedpress-modal",title:"Editing Embed properties",message:'<form id="form-'+i+'" embedpress><div class="row"><div class="col-md-12"><div class="form-group"><label for="input-url-'+i+'">Url</label><input class="form-control" type="url" id="input-url-'+i+'" value="'+e.decodeEmbedURLSpecialChars(n.data("url"),!1)+'"></div></div></div><div class="row">'+(h.canBeResponsive?'<div class="col-md-12"><label>Responsive</label><div class="form-group"><label class="radio-inline"><input type="radio" name="input-responsive-'+i+'" id="input-responsive-1-'+i+'" value="1"'+(f?' checked="checked"':"")+'> Yes</label><label class="radio-inline"><input type="radio" name="input-responsive-'+i+'" id="input-responsive-0-'+i+'" value="0"'+(f?"":' checked="checked"')+"> No</label></div></div>":"")+'<div class="col-md-6"><div class="form-group"><label for="input-width-'+i+'">Width</label><input class="form-control" type="integer" id="input-width-'+i+'" value="'+v+'"'+(f?" disabled":"")+'></div></div><div class="col-md-6"><div class="form-group"><label for="input-height-'+i+'">Height</label><input class="form-control" type="integer" id="input-height-'+i+'" value="'+l+'"'+(f?" disabled":"")+"></div></div></div></form>",buttons:{danger:{label:"Cancel",className:"btn-default",callback:function(){e.activeWrapperForModal=null}},success:{label:"Save",className:"btn-primary",callback:function(){var p=e.activeWrapperForModal;if(t.focus(),t.selection.select(p[0]),p.children().remove(),p.remove(),h.canBeResponsive)if(a("#form-"+i+' input[name="input-responsive-'+i+'"]:checked').val().isFalse()){var u=a("#input-width-"+i).val();parseInt(u)>0&&(o.width=u);var c=a("#input-height-"+i).val();parseInt(c)>0&&(o.height=c),o.responsive="false"}else delete o.width,delete o.height,o.responsive="true";else{var u=a("#input-width-"+i).val();parseInt(u)>0&&(o.width=u);var c=a("#input-height-"+i).val();parseInt(c)>0&&(o.height=c)}var y=[];if(Object.keys(o).length)for(var m in o)y.push(m+'="'+o[m]+'"');var C="["+_.shortcode+(y.length>0?" "+y.join(" "):"")+"]"+a("#input-url-"+i).val()+"[/"+_.shortcode+"]";t.execCommand("mceInsertContent",!1,C),e.configureWrappers(t)}}}}),a("form[embedpress]").on("change",'input[type="radio"]',function(p){var u=a(this),c=u.parents("form[embedpress]");a('input[type="integer"]',c).prop("disabled",u.val().isTrue())})},complete:function(h,f){a(".loader-indicator",n).removeClass("is-loading"),setTimeout(function(){a(".loader-indicator",n).remove()},350)},dataType:"json",async:!0})},200),!1},e.onClickRemoveButton=function(r,t){e.cancelEvent(r,t);var n=e.activeWrapper;return n.children().remove(),n.remove(),!1},e.recursivelyAddClass=function(r,t){a(r).children().each(function(n,i){a(i).addClass(t);var o=a(i).children();o.length>0&&e.recursivelyAddClass(i,t)})},e.setInterval=function(r,t,n){var i=0,o=0,s=window.setInterval(function(){i+=t,o++,i<=n?r(o,i):e.stopInterval(s)},t);return s},e.stopInterval=function(r){window.clearInterval(r),r=null},e.configureWrappers=function(r){window.setTimeout(function(){var n=r.getDoc(),i=null,o=n.getElementsByClassName("embedpress_wrapper");if(o.length>0){for(var s=0;s<o.length;s++)if(i=a(o[s]),i.data("configured")!=!0){window.setTimeout(function(){e.recursivelyAddClass(i,"embedpress_ignore_mouseout")},500);var d=e.setInterval(function(v){var l=i.find("iframe");l.length>0&&a.each(l,function(h,f){a(f).attr("id")!=="fb_xdm_frame_https"&&a(f).attr("id")!=="fb_xdm_frame_http"&&(i.css("width",a(f).width()+"px"),e.stopInterval(d))})},500,8e3);i.data("configured",!0)}}},200)},e.hidePreviewControllerPanel=function(){e.controllerPanelIsActive()&&(a(e.activeControllerPanel).addClass("hidden"),e.activeControllerPanel=null,e.activeWrapper=null)},e.getElementInContentById=function(r,t){var n=t.getDoc();if(n!==null)return a(n.getElementById(r))},e.displayPreviewControllerPanel=function(r,t){if(e.controllerPanelIsActive()&&r!==e.activeWrapper&&e.hidePreviewControllerPanel(),!e.controllerPanelIsActive()&&!r.hasClass("is-loading")){var n=r.data("uid"),i=e.getElementInContentById("embedpress_controller_panel_"+n,t);if(!i.data("event-set")){var o=e.getElementInContentById("embedpress_button_edit_"+n,t),s=e.getElementInContentById("embedpress_button_remove_"+n,t);e.addEvent("mousedown",o,function(v){e.onClickEditButton(v,t)}),e.addEvent("mousedown",s,function(v){e.onClickRemoveButton(v,t)}),i.data("event-set",!0)}var d=i.next()[0];typeof d!="undefined"&&d.nodeName.toLowerCase()==="iframe"&&i.css("left",a(d).width()/2),i.removeClass("hidden"),e.activeControllerPanel=i,e.activeWrapper=r}}};window.EmbedPress||(window.EmbedPress=new W),window.EmbedPress.init(_.previewSettings)})})(jQuery,String,embedpressPreviewData)})();
