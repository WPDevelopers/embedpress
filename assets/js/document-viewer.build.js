(function(){"use strict";const o={};document.addEventListener("fullscreenchange",()=>{if(!document.fullscreenElement){const e=document.querySelector(".ep-file-download-option-masked.fullscreen-enabled");e&&(e.classList.remove("fullscreen-enabled"),e.querySelector(".ep-doc-minimize-icon").style.display="none",e.querySelector(".ep-doc-fullscreen-icon").style.display="flex")}}),document.addEventListener("keydown",e=>{e.key==="Escape"&&document.querySelector(".ep-file-download-option-masked.fullscreen-enabled")&&(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen())}),o.getColorBrightness=e=>{const l=parseInt(e.slice(1,3),16),i=parseInt(e.slice(3,5),16),d=parseInt(e.slice(5,7),16),n=Math.max(l,i,d),t=Math.min(l,i,d),s=(n+t)/2;return Math.round(s/255*100)},o.adjustHexColor=(e,l)=>{const i=parseInt(e.slice(1,3),16),d=parseInt(e.slice(3,5),16),n=parseInt(e.slice(5,7),16),t=Math.round(l/100*255),s=Math.max(Math.min(i+t,255),0),c=Math.max(Math.min(d+t,255),0),m=Math.max(Math.min(n+t,255),0);return"#"+((1<<24)+(s<<16)+(c<<8)+m).toString(16).slice(1)},o.viewerStyle=()=>{const e=document.querySelectorAll(".ep-file-download-option-masked");let l=document.getElementById("custom-styles")||document.createElement("style");l.id="custom-styles",l.type="text/css",l.innerHTML="",e!==null&&(e.forEach(i=>{let d=i.getAttribute("data-custom-color");if(d==null)return!1;let n=o.getColorBrightness(d),t=i.getAttribute("data-id"),s="#f2f2f6";n>60&&(s="#343434"),i.getAttribute("data-theme-mode")=="custom"&&(viewerCustomColor=`    
                [data-id='${t}'][data-theme-mode='custom'] {
                    --viewer-primary-color: ${d};
                    --viewer-icons-color: ${s};
                    --viewer-icons-hover-bgcolor: ${o.adjustHexColor(d,-10)};
                
                }`,l.innerHTML+=viewerCustomColor)}),document.head.appendChild(l))},o.epDocumentsViewerController=()=>{const e=document.querySelectorAll(".ep-file-download-option-masked");function l(){document.fullscreenElement||e.forEach(n=>{n.classList.remove("fullscreen-enabled"),n.querySelector(".ep-doc-minimize-icon").style.display="none",n.querySelector(".ep-doc-fullscreen-icon").style.display="flex"})}function i(n){n.stopPropagation();const t=n.target.closest(".ep-file-download-option-masked");if(!t)return;const s=t.querySelector("iframe");if(!s)return;const c=decodeURIComponent(s.getAttribute("src"));if(!c)return;const m=/(url|src)=([^&]+)/,a=c.match(m);let r=a&&a[2];r||(r=c);const w=n.target.closest(".ep-doc-popup-icon svg"),u=n.target.closest(".ep-doc-print-icon svg"),f=n.target.closest(".ep-doc-download-icon svg"),g=n.target.closest(".ep-doc-minimize-icon svg"),y=n.target.closest(".ep-doc-fullscreen-icon svg");w instanceof SVGElement?window.open(r,"_blank"):u instanceof SVGElement?window.open(`https://view.officeapps.live.com/op/view.aspx?src=${r}&wdOrigin=BROWSELINK`,"_blank"):f instanceof SVGElement?fetch(r,{mode:"no-cors"}).then(p=>{p.ok?p.blob().then(x=>{const k=window.URL.createObjectURL(x),v=document.createElement("a");v.href=k,v.download=r.substring(r.lastIndexOf("/")+1),document.body.appendChild(v),v.click(),v.remove()}):window.location.href=r}).catch(p=>{window.location.href=r}):g instanceof SVGElement?document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen():y instanceof SVGElement&&(t.requestFullscreen?t.requestFullscreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen(),t.querySelector(".ep-doc-minimize-icon").style.display="flex",t.querySelector(".ep-doc-fullscreen-icon").style.display="none",t.classList.add("fullscreen-enabled"))}function d(n){n.stopPropagation();const t=n.target.closest(".ep-doc-draw-icon svg");if(!t)return;const s=t.closest(".ep-file-download-option-masked");if(!s)return;const c=s.querySelector(".ep-doc-canvas"),m=s.querySelector(".ep-doc-draw-icon svg");if(!c||!m)return;const a=c.getContext("2d");let r=!1,w=!1;c.addEventListener("mousedown",function(u){if(w){r=!0;const f=c.getBoundingClientRect(),g=window.pageXOffset||document.documentElement.scrollLeft,y=u.pageX-f.left-g,p=u.pageY-f.top;a.beginPath(),a.moveTo(y,p)}}),c.addEventListener("mousemove",function(u){if(r&&w){const f=c.getBoundingClientRect(),g=window.pageXOffset||document.documentElement.scrollLeft,y=u.pageX-f.left-g,p=u.pageY-f.top;a.lineTo(y,p),a.stroke()}}),c.addEventListener("mouseup",function(u){r=!1}),m.parentNode.classList.toggle("active"),w=m.parentNode.classList.contains("active"),c.style.display=w?"block":"none"}document.addEventListener("click",i),document.addEventListener("click",d),document.addEventListener("fullscreenchange",l)},typeof o.epDocumentsViewerController=="function"&&jQuery(".wp-block-embedpress-document.embedpress-document-embed").length>0&&o.epDocumentsViewerController(),typeof wp!="undefined"&&typeof wp.editor!="undefined"&&typeof o.viewerStyle=="function"&&o.epDocumentsViewerController(),typeof o.viewerStyle=="function"&&jQuery(".wp-block-embedpress-document.embedpress-document-embed").length>0&&o.viewerStyle(),jQuery(window).on("elementor/frontend/init",function(){var e=function(l,i){typeof o.epDocumentsViewerController=="function"&&o.epDocumentsViewerController(),typeof o.epDocumentsViewerController=="function"&&o.viewerStyle()};elementorFrontend.hooks.addAction("frontend/element_ready/embedpres_document.default",e)});const h=document.querySelectorAll(".ep-file-download-option-masked"),b=document.querySelectorAll(".enabled-file-download");h.forEach(function(e){e.addEventListener("contextmenu",E)});function E(e){e.preventDefault()}b.forEach(function(e){e.removeEventListener("contextmenu",E)})})();
