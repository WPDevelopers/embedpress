function embedPressRemoveURLParameter(e,t){let n=e.split("?");if(n.length>=2){let e=encodeURIComponent(t)+"=",a=n[1].split(/[&;]/g);for(var o=a.length;o-- >0;)-1!==a[o].lastIndexOf(e,0)&&a.splice(o,1);return n[0]+(a.length>0?"?"+a.join("&"):"")}return e}jQuery(document).ready(function(e){e(".ep-color-picker").wpColorPicker();let t=!1,n=e(".embedpress-settings-form"),o=e(".embedpress-settings-form :input:not([type=submit], [disabled], button, [readonly])");function a(){let t=e(".toast__message--success");t.addClass("show"),setTimeout(function(){t.removeClass("show")},3e3)}function s(){let t=e(".toast__message--error");t.addClass("show"),setTimeout(function(){t.removeClass("show")},3e3)}function i(e){if(window.clipboardData&&window.clipboardData.setData)return window.clipboardData.setData("Text",e);if(document.queryCommandSupported&&document.queryCommandSupported("copy")){var t=document.createElement("textarea");t.textContent=e,t.style.position="fixed",document.body.appendChild(t),t.select();try{return document.execCommand("copy")}catch(e){return console.warn("Copy to clipboard failed.",e),!1}finally{document.body.removeChild(t)}}}o.on("change",function(a){t=!1;let s=["ep_settings_nonce","_wp_http_referer","g_loading_animation","submit"],i=["button"],r=["yt_branding","embedpress_document_powered_by","embedpress_pro_twitch_autoplay","embedpress_pro_twitch_chat"],l=[];for(var d=0;d<o.length;d++){let n=o[d],a=n.type,c=n.name;if(!s.includes(c)&&!i.includes(a)){let o=e(n);if("radio"===a){if(!l.includes(c)){let n=e(`input[name="${c}"]:checked`),o=n.parents(".input__radio_wrap"),a=n.val();o.data("value",a),o.data("value")!=o.data("default")&&(t=!0),l.push(c)}}else"checkbox"===a?(o.is(":checked")?o.data("value",o.val()):r.includes(c)?o.data("value","no"):o.data("value",""),o.data("value")!=o.data("default")&&(t=!0)):o.val()!=o.data("default")&&(t=!0)}}!0===t?n.find(".embedpress-submit-btn").addClass("ep-settings-form-changed"):n.find(".embedpress-submit-btn").removeClass("ep-settings-form-changed")}),window.onbeforeunload=function(){return!0===t?"You have unsaved data. Are you sure to leave without saving them?":void 0},e(".sidebar__dropdown .sidebar__link--toggler").on("click",function(t){t.preventDefault();let n=e(this),o=e(".sidebar__item");o.removeClass("show"),n.parent().addClass("show"),n.siblings(".dropdown__menu").hasClass("show")?(n.siblings(".dropdown__menu").removeClass("show"),n.siblings(".dropdown__menu").slideUp(),o.removeClass("show")):(e(".dropdown__menu.show").slideUp().removeClass("show"),n.siblings(".dropdown__menu").addClass("show"),n.siblings(".dropdown__menu").slideDown())}),e(".sidebar__toggler").on("click",function(t){t.preventDefault(),e(this).siblings(".sidebar__menu").slideToggle()}),e(".preview__remove").on("click",function(o){o.preventDefault();let a=e(this).parents(".logo__adjust__wrap");a.find(".preview__logo").attr("src",""),a.find(".logo__upload__preview").hide(),a.find(".logo__upload").show(),a.find(".instant__preview__img").attr("src",""),a.find(".preview__logo__input").val(""),a.find(".preview__logo__input_id").val(""),n.find(".embedpress-submit-btn").addClass("ep-settings-form-changed"),t=!0}),e(".logo__adjust").each(function(){let t=e(this),n=t.find(".preview__logo"),o=t.find(".opacity__range"),a=t.find(".x__range"),s=t.find(".y__range"),i=t.find(".range__value");i.each(function(){e(this).html(e(this).prev().attr("value"))}),o.on("input",function(){e(this).next(i).val(this.value),n.css("opacity",this.value/100)}),a.on("input",function(){e(this).next(i).val(this.value),n.css("right",this.value+"%")}),s.on("input",function(){e(this).next(i).val(this.value),n.css("bottom",this.value+"%")})}),e(".template__wrapper .input__switch .logo__adjust__toggler").on("click",function(t){t.preventDefault(),e(".logo__adjust__wrap").not(e(this).parents(".form__control__wrap").children(".logo__adjust__wrap")).slideUp(),e(".template__wrapper .input__switch .logo__adjust__toggler").not(e(this)).removeClass("show"),e(this).toggleClass("show"),e(this).parents(".form__control__wrap").children(".logo__adjust__wrap").slideToggle()}),e(".form__control__wrap .input__switch input").on("click",function(){e(this).siblings(".logo__adjust__toggler.show").trigger("click")}),e(document).on("click",".isPro",function(){e(this).siblings(".pro__alert__wrap").fadeIn()}),e(document).on("click",".pro__alert__card .button",function(t){t.preventDefault(),e(this).parents(".pro__alert__wrap").fadeOut()}),e(document).on("click",".logo__upload",function(o){o.preventDefault();let a=e(this),s=a.parent(".logo__adjust__wrap"),i=s.find(".preview__logo"),r=s.find(".logo__upload__preview"),l=s.find(".instant__preview__img"),d=s.find(".preview__logo__input"),c=s.find(".preview__logo__input_id"),u=(e(this),wp.media({title:"Custom Logo",library:{uploadedTo:wp.media.view.settings.post.id,type:"image"},button:{text:"Use this image"},multiple:!1}).on("select",function(){let e=u.state().get("selection").first().toJSON();e&&e.id&&e.url?(a.hide(),d.val(e.url),c.val(e.id),l.attr("src",e.url),r.show(),i.attr("src",e.url),n.find(".embedpress-submit-btn").addClass("ep-settings-form-changed"),t=!0):console.log("something went wrong using selected image")}).open())}),e(document).on("change",".element-check",function(t){let n=e(this);e.ajax({url:ajaxurl,type:"post",data:{action:"embedpress_elements_action",_wpnonce:embedpressObj.nonce,element_type:n.data("type"),element_name:n.data("name"),checked:n.is(":checked")},success:function(e){e&&e.success?a():s()},error:function(e){s()}})}),e(document).on("submit","form.embedpress-settings-form",function(n){n.preventDefault();let o=e(this),i=o.find(".embedpress-submit-btn"),r=i.text();const l=o.serializeArray(),d=i.attr("value");i.text("Saving..."),l.push({name:"action",value:"embedpress_settings_action"}),l.push({name:"submit",value:d}),e.ajax({url:ajaxurl,type:"post",dataType:"json",data:l,success:function(e){i.removeClass("ep-settings-form-changed"),e&&e.success?(a(),i.text(r),t=!1):(i.text(r),s())},error:function(e){i.removeClass("ep-settings-form-changed"),i.text(r),s()}})}),e(document).on("click",".embedpress-license-deactivation-btn",function(t){let n=e(this);setTimeout(function(){n.attr("disabled","disabled")},2e3),n.html("Deactivating.....")}),e(document).on("click",".embedpress-license-activation-btn",function(t){let n=e(this);e("#embedpress-pro-license-key").val()&&(setTimeout(function(){n.attr("disabled","disabled")},2e3),n.html("Activating....."))});let r=e("#ep-shortcode");e(document).on("click","#ep-shortcode-btn",function(t){t.preventDefault();let n=e("#ep-link"),o=n.val();if(!/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[/?#]\S*)?$/i.test(o))return function(t=""){let n=e(".toast__message--attention");t.length>0&&n.find("p").html(t),n.addClass("show"),setTimeout(function(){n.removeClass("show"),history.pushState("","",embedPressRemoveURLParameter(location.href,"attention"))},3e3)}("Please enter a valid URL."),n.val(""),void r.val("");n.val("");var a=o.split(".");"pdf"===a[a.length-1]?r.val("[embedpress_pdf]"+o+"[/embedpress_pdf]"):r.val("[embedpress]"+o+"[/embedpress]"),r.focus()}),e(document).on("click","#ep-shortcode-cp",function(t){t.preventDefault();let n=r.val();n.length<1?function(t=""){let n=e(".toast__message--error");t.length>0&&n.find("p").html(t),n.addClass("show"),setTimeout(function(){n.removeClass("show"),history.pushState("","",embedPressRemoveURLParameter(location.href,"error"))},3e3)}("Please enter a valid URL and generate a shortcode first."):(i(n),r.removeClass("active"),function(t=""){let n=e(".toast__message--success");t.length>0&&n.find("p").html(t),n.addClass("show"),setTimeout(function(){n.removeClass("show"),history.pushState("","",embedPressRemoveURLParameter(location.href,"success"))},3e3)}("Copied to your clipboard successfully."))}),r.on("focus",function(t){e(this).select()}),e(".account-delete-button").on("click",function(){!function(){const e=document.createElement("div");e.classList.add("custom-dialog");const t=document.createElement("p");t.textContent="Are you sure you want to delete?";const n=document.createElement("button");n.textContent="Yes",n.addEventListener("click",()=>{var t;document.body.removeChild(e),t={action:"delete_instagram_account",user_id:$userId,account_type:$accountType,_nonce:embedpressObj.nonce},jQuery.post(ajaxurl,t,function(e){console.log(e),e&&($that.css("pointer-events","all"),$that.closest("tr").remove())})});const o=document.createElement("button");o.textContent="No",o.addEventListener("click",()=>{document.body.removeChild(e),$that.css("pointer-events","all"),console.log("Deletion cancelled.")}),e.appendChild(t),e.appendChild(n),e.appendChild(o),document.body.appendChild(e)}(),$that=e(this),$userId=$that.closest("tr").data("userid"),$accountType=$that.closest("tr").data("accounttype"),$that.css("pointer-events","none")}),e("#instagram-form").on("submit",function(t){t.preventDefault(),e("#instagram-form p").length>0&&e("#instagram-form p").remove();var n=e("#instagram-access-token").val(),o=e("#account-option").val();e("#instagram-form button").text("Connecting..."),e("#instagram-form button").attr("disabled","disabled"),e.ajax({url:ajaxurl,type:"POST",data:{action:"get_instagram_userdata_ajax",access_token:n,account_type:o,_nonce:embedpressObj.nonce},success:function(t){console.log(t),t.error?(e("#instagram-form button").text("Connect"),e("#instagram-access-token").after(`<p>${t.error}</p>`),e("#instagram-form button").removeAttr("disabled"),setTimeout(()=>{e("#instagram-form p").remove()},1e4)):(e("#instagram-form button").text("Connected"),setTimeout(()=>{window.location.reload()},1e3))},error:function(e,t,n){console.error(n)}})}),e(".instagram-sync-data").on("click",function(t){t.preventDefault(),$that=e(this);var n=$that.data("acceess-token"),o=$that.data("account-type"),a=$that.data("userid");$that.find("i").addClass("sync-spin"),$that.attr("disabled","disabled"),e.ajax({url:ajaxurl,type:"POST",data:{action:"sync_instagram_data_ajax",access_token:n,account_type:o,user_id:a,_nonce:embedpressObj.nonce},success:function(e){console.log(e),e.error?$that.removeAttr("disabled"):($that.removeClass("sync-spin"),$that.text("Synced."),setTimeout(()=>{window.location.reload()},1e3))},error:function(e,t,n){console.error(n)}})}),e(".calendly-event-copy-link").click(function(){var t=e(this).data("event-link"),n=e("<input>");e("body").append(n),n.val(t).select(),document.execCommand("copy"),n.remove();var o=e(this);o.find("span").text("Copied!"),setTimeout(function(){o.find("span").text("Copy link")},1500)}),e("#open-modal-btn").click(function(){e(".modal-overlay").css("display","block")}),e(".modal-overlay .close-btn").click(function(){e(".modal-overlay").css("display","none")}),e(document).on("click",function(t){t.target.classList.contains("modal-overlay")&&e(".modal-overlay").css("display","none")}),e(".user-profile-link").click(function(){var t=e(this).attr("title");i(t),alert("Link copied to clipboard: "+t)}),e(document).on("click",".popup-video-wrap, .close-video_btn",function(t){t.preventDefault(),e(".popup-video").remove(),e(".popup-video-wrap").removeClass("popup-active")}),e(".video-play_btn").click(function(t){e(".popup-video-wrap").append('\n                <div class="popup-video">\n                    <button class="close-video_btn">\n                        <a href="#" class="close-btn"></a>\n                    </button>\n                   <iframe src="https://www.youtube.com/embed/fvYKLkEnJbI?autoplay=1" \n                        title="YouTube video player" \n                        frameborder="0" \n                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" \n                        allowfullscreen>\n                    </iframe>\n\n                </div>\n            ')})});