/*! For license information please see 3dflipbook.min.js.LICENSE.txt */
!function(e){function t(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var i={};t.m=e,t.c=i,t.i=function(e){return e},t.d=function(e,i,n){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=76)}([function(e,t,i){"use strict";t.__esModule=!0;var n=window.jQuery,o=window.html2canvas,r=window.THREE,s=window.React,a=window.ReactDOM,l=window.pdfjsLib;t.$=n,t.html2canvas=o,t.THREE=r,t.React=s,t.ReactDOM=a,t.PDFJS=l,t.tr=function(e){return(window.iberezansky||{}).tr&&window.iberezansky.tr(e)||e}},function(e,t,i){"use strict";t.__esModule=!0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},o=window.jQuery,r=window.html2canvas,s=window.THREE,a=window.PDFJS;window.FB3D_LOCALE&&(window.iberezansky=n({},window.iberezansky,{tr:function(e){return(FB3D_LOCALE.dictionary||{})[e]||e}})),t.$=o,t.html2canvas=r,t.THREE=s,t.PDFJS=a,t.tr=function(e){return(window.iberezansky||{}).tr&&window.iberezansky.tr(e)||e}},function(e,t,i){"use strict";t.__esModule=!0;var n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.sum1=function(e,t,i,n){return[e*t[0]+i*n[0]]},e.sum2=function(e,t,i,n){return[e*t[0]+i*n[0],e*t[1]+i*n[1]]},e.sum3=function(e,t,i,n){return[e*t[0]+i*n[0],e*t[1]+i*n[1],e*t[2]+i*n[2]]},e.sum4=function(e,t,i,n){return[e*t[0]+i*n[0],e*t[1]+i*n[1],e*t[2]+i*n[2],e*t[3]+i*n[3]]},e.rk4=function(t,i,n,o){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e.sum[o.length-1],s=t(i,o),a=t(i+n/2,r(1,o,n/2,s)),l=t(i+n/2,r(1,o,n/2,a)),h=t(i+n,r(1,o,n,l));return r(1,o,n/6,r(1,r(1,s,2,a),1,r(2,l,1,h)))},e.extrapolateLinear=function(e,t,i){return t[0]+(t[1]-t[0])/(e[1]-e[0])*(i-e[0])},e.interpolateLinear=function(t,i,n){return t[0]>t[1]&&(t=t.reverse(),i=i.reverse()),n<t[0]?i[0]:n>t[1]?i[1]:e.extrapolateLinear(t,i,n)},e.calcScale=function(e,t,i,n){return i/e},e.mulM=function(e,t){for(var i=[],n=0;n<e.length;++n){i.push([]);for(var o=0;o<t[0].length;++o){i[n][o]=0;for(var r=0;r<t.length;++r)i[n][o]+=e[n][r]*t[r][o]}}return i},e.transM=function(e){for(var t=[],i=0;i<e.length;++i)for(var n=0;n<e[0].length;++n)t[n]||(t[n]=[]),t[n][i]=e[i][n];return t},e.mat=function(e){var t=0,i=e,n=Array.isArray(i),o=0;for(i=n?i:i[Symbol.iterator]();;){var r;if(n){if(o>=i.length)break;r=i[o++]}else{if((o=i.next()).done)break;r=o.value}t+=r}return t/e.length},e.disp=function(t){var i=e.mat(t),n=0,o=t,r=Array.isArray(o),s=0;for(o=r?o:o[Symbol.iterator]();;){var a;if(r){if(s>=o.length)break;a=o[s++]}else{if((s=o.next()).done)break;a=s.value}n+=(a-i)*(a-i)}return n/t.length},e.predict1=function(t,i){var n=[],o=t.length;if(e.disp(t)<o&&o>1){for(var r=[],s=[],a=0;a<o;++a)r.push([a,1]),s.push([t[a]]);for(var l=e.transM(r),h=e.mulM(l,r),c=e.mulM(l,s),u=h[0][0]*h[1][1]-h[1][0]*h[0][1],d=[-(h[0][1]*c[1][0]-c[0][0]*h[1][1])/u,(h[0][0]*c[1][0]-h[1][0]*c[0][0])/u],p=0;p<i;++p){var f=Math.round(d[0]*(p+o)+d[1]);-1===n.indexOf(f)&&n.push(f)}}return n},e.predict=function(e,t){for(var i=[],n=e.length,o=0,r=0;r<n-1;++r)o+=Math.sign(e[r+1]-e[r]);o=Math.abs(o)<=(n-1)%2?-1:Math.sign(o);for(var s=0,a=e[n-1];s<t&&a>0;++s)a+=o,i.push(a);return i},e.getUnique=function(){return Math.ceil(1e9*Math.random())},e.setSplinePoints=function(e,t){e.points.length!==t.x.length&&console.warn("setSplinePoints: bad points");for(var i=0;i<e.points.length;++i)e.points[i].set(t.x[i],t.y[i],t.z?t.z[i]:0)},e.mapl2L=function(e,t,i,n){for(var o=t/(i-1),r=0,s=0,a=e[0];s<e.length-1&&r<t+.1*o;a+=e[++s])Math.abs(r-a)<Math.abs(r-a-e[s+1])&&(n(s,r),r+=o);r<t+.1*o&&console.warn("mapl2L: ls is not enought")},e.det2=function(e,t,i,n){return e*n-t*i},e.solve2Lin=function(t,i,n,o){var r=void 0,s=e.det2(t[0],t[1],n[0],n[1]);return Math.abs(s)>e.eps&&(r={x:e.det2(i,t[1],o,n[1])/s,y:e.det2(t[0],i,n[0],o)/s}),r},e.isInsidePoly=function(t,i){for(var n=!1,o=void 0,r=0;r<t.length;++r)if(e.v2dist(i,t[r])<e.eps){o=1,n=!0;break}for(;!n;){n=!0,o=0;for(var s={x:i.x+Math.random()-.5,y:i.y+Math.random()-.5},a={x:s.x-i.x,y:s.y-i.y},l=[a.y,-a.x],h=i.x*a.y-i.y*a.x,c=0;c<t.length;++c){var u=t[c],d=t[(c+1)%t.length],p={x:d.x-u.x,y:d.y-u.y},f=[p.y,-p.x],v=u.x*p.y-u.y*p.x,g=e.solve2Lin(l,h,f,v);if(g){if(e.v2dist(g,u)<e.eps||e.v2dist(g,d)<e.eps){n=!1;break}if(g.x>Math.min(u.x,d.x)-e.eps&&g.x<Math.max(u.x,d.x)+e.eps&&g.y>Math.min(u.y,d.y)-e.eps&&g.y<Math.max(u.y,d.y)+e.eps){if(e.v2dist(g,i)<e.eps){o=1;break}var m={x:g.x-i.x,y:g.y-i.y};o+=m.x*a.x+m.y*a.y>0}}}}return o%2},e.isInsideConvPoly=function(e,t){for(var i=[0,0],n=0;n<e.length;++n){var o=e[n],r=e[(n+1)%e.length],s={x:o.x-t.x,y:o.y-t.y},a={x:r.x-t.x,y:r.y-t.y};++i[(s.x*a.y-s.y*a.x<0)+0]}return~i.indexOf(e.length)},e.v2len=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},e.v2dist=function(t,i){return e.v2len({x:i.x-t.x,y:i.y-t.y})},e.computeSquare=function(t){for(var i=[],n=0,o=0;o<t.length;++o)i.push(e.v2dist(t[o],t[(o+1)%t.length])),n+=.5*i[o];return Math.sqrt(n*(n-i[0])*(n-i[1])*(n-i[2]))},e.computeInterpCoefs=function(t,i){for(var n=e.computeSquare(t),o=[],r=t.length,s=0;s<r;++s)o[s]=e.computeSquare([i,t[(s+1)%r],t[(s+2)%r]])/n;return o},e}();n.sum=[n.sum1,n.sum2,n.sum3,n.sum4],n.eps=1e-4,t.default=n},function(e,t,i){"use strict";t.__esModule=!0;var n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.normalizeUrl=function(e){function t(e){return e.replace(/\\/g,"/").split("/")}var i=t(window.location.href);return e=t(e),i[2]===e[2]&&(e[0]=i[0]),e.join("/")},e._escapeHTMLclb=function(t){return e._escapeHTMLchars[t]||t},e.escapeHTML=function(t){return t.replace(/[&<>]/g,e._escapeHTMLclb)},e.extends=function(e,t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])},e.defaultCmp=function(e,t){return e-t},e.lowerBound=function(t,i,n){n=n||e.defaultCmp;for(var o=0,r=t.length-1;r-o>1;){var s=Math.floor((o+r)/2);n(i,t[s])<0?r=s:o=s}return n(i,t[r])>=0?r:o},e}();n.MOBILE_DIAG=11,n._escapeHTMLchars={"&":"&amp;","<":"&lt;",">":"&gt;"},t.default=n},function(e,t,i){"use strict";t.__esModule=!0;var n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.createCanvas=function(e,t){var i=document.createElement("canvas");return e&&(i.width=e),t&&(i.height=t),i},e.extrapolateLinear=function(e,t,i){return t[0]+(t[1]-t[0])/(e[1]-e[0])*(i-e[0])},e.interpolate01=function(t,i,n){return e.extrapolateLinear([0,1],[t,i],n)},e.getColorBytes=function(e){return[e>>16&255,e>>8&255,255&e]},e.inverseColor=function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=e.getColorBytes(t),o=[255-n[0],255-n[1],255-n[2]],r=[Math.round(e.interpolate01(n[0],o[0],i)),Math.round(e.interpolate01(n[1],o[1],i)),Math.round(e.interpolate01(n[2],o[2],i))];return e.bytes2Color(r)},e.color2Rgba=function(t,i){return e.bytes2Rgba(e.getColorBytes(t),i)},e.bytes2Rgba=function(e,t){return"rgba("+e.join(",")+","+t+")"},e.bytes2Color=function(e){return e[2]|e[1]<<8|e[0]<<16},e}();t.default=n},function(e,t,i){"use strict";t.__esModule=!0;var n,o=i(0),r=(n=i(2))&&n.__esModule?n:{default:n},s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.splitSpline=function(e,i){for(var n={len:0,ls:[0]},o=1/i,r=0;r<=i;++r){var s=e.getPoint(r*o);if(r){var a=t.v1.distanceTo(s);n.len+=a,n.ls.push(a)}t.v1.copy(s)}return n},t.getLinearIndeces=function(e,i){for(var n=[0],o=0,r=0;r<=5e3;++r){var s=e.getPoint(2e-4*r);if(r){var a=t.v1.distanceTo(s);o+=a,n.push(a)}t.v1.copy(s)}n.push(1e7);for(var l=[],h=o/(i-1),c=0,u=0,d=n[0];c<n.length-1;d+=n[++c])Math.abs(u-d)<Math.abs(u-d-n[c+1])&&(l.push(2e-4*c),u+=h);return l},t.refinePoly=function(e,t){for(var i=[],n=0;n<e.length;++n){var s=e[n],a=e[(n+1)%e.length],l=r.default.v2dist(s,a),h=Math.ceil(l/t),c=l/h;i.push(s);for(var u=1;u<h;++u)i.push(new o.THREE.Vector2(s.x+u*c*(a.x-s.x)/l,s.y+u*c*(a.y-s.y)/l))}return i},t}(r.default);s.v1=new o.THREE.Vector3,t.default=s},function(e,t,i){"use strict";t.__esModule=!0;var n,o=(n=i(4))&&n.__esModule?n:{default:n},r=function(){function e(t,i,n,o){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.renderPause=!1,this.context=t,this.wnd=t.wnd,this.doc=t.doc,this.element=t.element||t.doc.body,this.c=t.renderCanvas||e.renderCanvas,this.ctx=t.renderCanvasCtx||e.renderCanvasCtx,this.resW=this.width=i,this.resH=this.height=n,this.color=o}return e.prototype.setRenderCanvas=function(e,t){this.c=e,this.ctx=t},e.prototype.setResolution=function(e){var t=e.width/this.resW;this.resW=e.width,this.resH=t*this.resH},e.prototype.dispose=function(){},e.prototype.renderBlankPage=function(){this.ctx.beginPath(),this.ctx.fillStyle=o.default.color2Rgba(this.color,1),this.ctx.rect(0,0,this.c.width,this.c.height),this.ctx.fill()},e.prototype.setRenderPause=function(e){this.renderPause=e,!e&&this.continueRender&&(this.continueRender(),delete this.continueRender)},e.prototype.cancelRender=function(){this.renderTask&&this.renderTask.cancel&&(this.renderTask.cancel(),delete this.renderTask)},e.prototype.renderImage=function(e){this.pushCtx(),this.ctx.clearRect(0,0,this.c.width,this.c.height),this.ctx.drawImage(e,0,0),this.popCtx()},e.prototype.normToConv=function(e){return{x:e.x*this.c.width,y:(1-e.y)*this.c.height}},e.prototype.renderHit=function(e){var t=this.ctx;t.fillStyle="rgba(255,255,0,0.4)",t.beginPath();var i=this.normToConv(e[0]);t.moveTo(i.x,i.y);for(var n=1;n<e.length;++n)i=this.normToConv(e[n]),t.lineTo(i.x,i.y);t.closePath(),t.fill()},e.prototype.pushCtx=function(){return Math.abs(this.resW-this.c.width)>=1&&(this.c.width=Math.ceil(this.resW)),Math.abs(this.resH-this.c.height)>=1&&(this.c.height=Math.ceil(this.resH)),this.ctx.save(),this.ctx.scale(this.c.width/this.width,this.c.height/this.height),this.ctx},e.prototype.popCtx=function(){this.ctx.restore()},e.prototype.renderNotFoundPage=function(){this.renderBlankPage()},e.prototype.finishRender=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.onChange&&this.onChange(this.c,e)},e.prototype.finishLoad=function(){this.onLoad?this.onLoad():this.startRender()},e.prototype.getSimulatedDoc=function(){},e}();r.renderCanvas=o.default.createCanvas(),r.renderCanvasCtx=r.renderCanvas.getContext("2d"),t.default=r},function(e,t,i){"use strict";t.__esModule=!0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},o=i(0),r=function(){function e(t,i){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.wnd=t,this.doc=i,this.enabled=!0}return e.prototype.setEnable=function(e){e||(this.mCapObject&&(this.notify(this.mCapObject,o.$.Event("mouseup"),"mouseup"),this.mCapObject=void 0),this.mHovObject&&(this.notify(this.mHovObject,o.$.Event("mouseout"),"mouseout"),this.mHovObject=void 0)),this.enabled=e},e.prototype.getCallback=function(e){},e.prototype.notify=function(e,t,i){var r=this.getCallback(e);if(r){var s=n({},t,{type:i,view:this.wnd});r(o.$.Event(i,s),e)}},e.prototype.convert=function(e,t){if(this.enabled){this.filter&&(e=this.filter(this.element,e));var i=this.getObject(e,t);(~e.type.indexOf("touch")?this.convertTouch(e,t,i):this.convertMouse(e,t,i))&&i&&this.notify(i,e,e.type)}},e.prototype.convertTouch=function(e,t,i){var n=!0;switch(e.type){case"touchstart":this.tCapObject&&this.notify(this.tCapObject,e,"touchend"),this.tCapObject=i;break;case"touchend":this.tCapObject&&!this.test(this.tCapObject,i)?(this.notify(this.tCapObject,e,"touchend"),n=!1):i&&this.test(this.tCapObject,i)&&this.notify(i,e,"touchtap"),this.tCapObject=void 0;break;case"touchtap":n=!1}return n},e.prototype.convertMouse=function(e,t,i){if(e.originalEvent&&e.originalEvent.sourceCapabilities&&e.originalEvent.sourceCapabilities.firesTouchEvents)return!1;var n=!0;switch(e.type){case"mousedown":this.mCapObject&&this.notify(this.mCapObject,e,"mouseup"),this.mCapObject=i;break;case"mouseup":this.mCapObject&&!this.test(this.mCapObject,i)&&(this.notify(this.mCapObject,e,"mouseup"),n=!1);break;case"click":n=this.test(this.mCapObject,i),this.mCapObject=void 0;break;case"mouseenter":case"mouseover":case"mousemove":!this.test(this.mHovObject,i)&&this.mHovObject&&(this.notify(this.mHovObject,e,"mouseout"),this.mHovObject=void 0),!this.mHovObject&&i&&(this.notify(i,e,"mouseover"),this.mHovObject=i),n="mousemove"===e.type;break;case"mouseleave":case"mouseout":this.mHovObject&&(this.notify(this.mHovObject,e,"mouseout"),this.mHovObject=void 0),n=!1}return n},e}();t.default=r},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o=n(i(14)),r=n(i(46)),s=n(i(62)),a=n(i(60)),l=n(i(54)),h=function(){function e(t,i){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.context=t,this.cache=i||new o.default}return e.prototype.build=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:210,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:297,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:16777215,h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0,c=void 0;switch(e.type){case"html":c=new l.default(this.context,i,n,o,e.src,this.cache,h);break;case"image":c=new s.default(this.context,i,n,o,e.src);break;case"pdf":c=new a.default(this.context,i,n,o,e.src,t);break;default:c=new r.default(this.context,i,n,o)}return c},e}();t.default=h},function(e,t,i){"use strict";t.__esModule=!0;var n,o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},r=i(11),s=(n=i(2))&&n.__esModule?n:{default:n},a=function(){function e(t,i){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.onReady=t,this.defaults=(0,r.props)(i)}return e.prototype.dispose=function(){},e.prototype.calcSize=function(e,t){var i=s.default.calcScale(e,t,this.defaults.width,this.defaults.height);return{width:i*e,height:i*t}},e.prototype.calcTexels=function(e,t){var i=this.defaults.sheet,n=s.default.calcScale(e,t,i.widthTexels,i.heightTexels);return{widthTexels:n*e,heightTexels:n*t}},e.prototype.calcProps=function(e,t){this.props=o({},this.defaults,{pages:this.pages},this.calcSize(e,t),{sheet:o({},this.defaults.sheet,this.calcTexels(e,t)),cover:o({},this.defaults.cover),page:o({},this.defaults.page)})},e.prototype.calcSheets=function(e){return this.sheets=Math.ceil(Math.max(0,e-4)/2)},e.prototype.getSheets=function(){return this.sheets},e.prototype.getProps=function(){return this.props},e.prototype.getPageCallback=function(){return this.binds.pageCallback},e.prototype.ready=function(){this.onReady&&this.onReady(this.getProps(),this.getSheets(),this.getPageCallback())},e}();t.default=a},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},s=i(1),a=n(i(44)),l=n(i(5)),h=n(i(21)),c=function(){function e(t,i,n,o){var l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,c=this,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"closed",d=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.visual=t,this.p=r({},i,{first:n,last:o});var p=this.getProps(),f=this.loadPoints();Object.keys(f).map(function(e){c[e]=f[e][p.shape]||f[e][0]}),this.pSpline=new s.THREE.CatmullRomCurve3([]);for(var v=0;v<this.interpolationPoints.x[0].length;++v)this.pSpline.points.push(new s.THREE.Vector3);this.iSpline=new s.THREE.CatmullRomCurve3([]);for(var g=0;g<a.default.resX;++g)this.iSpline.points.push(new s.THREE.Vector3);if(this.aSplines=[],this.geometry=a.default.geometry.clone(),this.p.sideFaces=[{first:0,last:a.default.faces[0]},{first:a.default.faces[0],last:a.default.faces[1]}],this.sideTexture=new s.THREE.Texture,this.sideTexture.wrapT=s.THREE.RepeatWrapping,this.sideTexture.repeat.set(0,o-n),this.sideTexture.image=p.sideTexture,this.sideTexture.needsUpdate=!0,this.materials=[new s.THREE.MeshPhongMaterial,new s.THREE.MeshPhongMaterial,new s.THREE.MeshPhongMaterial({map:this.sideTexture}),new s.THREE.MeshPhongMaterial({map:this.sideTexture}),new s.THREE.MeshPhongMaterial,new s.THREE.MeshPhongMaterial({map:this.sideTexture})],this.p.setTexture(this.materials[0],2*n),this.p.setTexture(this.materials[1],2*o-1),this.mesh=new s.THREE.Mesh(this.geometry,this.materials),this.mesh.castShadow=!0,this.mesh.receiveShadow=!0,this.three=this.mesh,this.three.userData.self=this,this.markers=[],this.p.marker.use){var m,b=this.geometry.vertices.length;m=Array.apply(0,Array(b)).map(function(e,t){return t});var y=m,w=Array.isArray(y),k=0;for(y=w?y:y[Symbol.iterator]();;){var x;if(w){if(k>=y.length)break;x=y[k++]}else{if((k=y.next()).done)break;x=k.value}var P=x,C=h.default.createMarker(this.geometry.vertices[P],P<b/2?16711680:65280,this.p.marker.size);this.markers.push({marker:C,vertex:P}),this.three.add(C)}}this.corner={use:!0,height:0,maxDistance:0,points:[],OZ:new s.THREE.Vector3(0,0,1),axis:new s.THREE.Vector3},this.set(0,"closed",d,n,o),this.set(l,u,d,n,o)}return e.prototype.dispose=function(){var e=this.materials,t=Array.isArray(e),i=0;for(e=t?e:e[Symbol.iterator]();;){var n;if(t){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}var o=n;o.map&&(o.map=null,o.needsUpdate=!0),o.dispose()}delete this.materials,this.geometry.dispose()},e.prototype.getSize=function(){return this.p.last-this.p.first},e.prototype.getProps=function(){return r({},this.p.page,{width:this.p.page.width-(this.reducedWidth?.001*this.p.page.width:0),sheets:this.p.sheets})},e.prototype.reduceWidth=function(e){this.reducedWidth=e,this.set(this.angle)},e.prototype.getTopCerners=function(){var e=this.angle>Math.PI/2?0:this.geometry.vertices.length/2;return[this.geometry.vertices[e],this.geometry.vertices[a.default.resX-1+e],this.geometry.vertices[(a.default.resZ-1)*a.default.resX+e],this.geometry.vertices[a.default.resZ*a.default.resX-1+e]]},e.prototype.getTopSize=function(){var e=this.getTopCerners(),t=new s.THREE.Vector3,i=new s.THREE.Vector3;return t.copy(e[0]),this.three.localToWorld(t),i.copy(e[1]),this.three.localToWorld(i),{width:Math.abs(i.x-t.x),height:e[0].distanceTo(e[2])}},e.prototype.getTopWorldRotation=function(e){return e.x=-Math.PI/2,e},e.prototype.getTopWorldPosition=function(e){var t=this.getTopCerners();e.set(0,-100,0);var i=new s.THREE.Vector3,n=t,o=Array.isArray(n),r=0;for(n=o?n:n[Symbol.iterator]();;){var a;if(o){if(r>=n.length)break;a=n[r++]}else{if((r=n.next()).done)break;a=r.value}var l=a;i.copy(l),this.three.localToWorld(i),e.x+=.25*i.x,e.y=Math.max(i.y,i.y),e.z+=.25*i.z}return e},e.prototype.getInterpolationPoints=function(e,t){var i={x:[],y:[]},n=this.getProps().wave,o=e,r=Array.isArray(o),s=0;for(o=r?o:o[Symbol.iterator]();;){var a;if(r){if(s>=o.length)break;a=o[s++]}else{if((s=o.next()).done)break;a=s.value}var l=a;i.x.push([].concat(this.interpolationPoints.x[l])),i.y.push(~t.indexOf(l)?this.interpolationPoints.y[l].map(function(e){return n*e}):[].concat(this.interpolationPoints.y[l]))}return i},e.prototype.set=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.corner.height,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.p.first,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.p.last,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"right",a=Math.PI;this.state=t;var l=void 0,h=void 0;"object"===(void 0===e?"undefined":o(e))?(this.angle=e.openedAngle,l=e.closedAngle,h=e.binderTurn>a/2?a-e.binderTurn:e.binderTurn):this.angle=e,this.corner.height=i,this.p.first===n&&this.p.last===r||(this.sideTexture.repeat.set(0,r-n),this.sideTexture.needsUpdate=!0,this.p.first!==n&&this.p.setTexture(this.materials[0],2*n),this.p.last!==r&&this.p.setTexture(this.materials[1],2*r-1)),this.p.first=n,this.p.last=r;var c=void 0,u=this.getProps();if("closed"===this.state)c=this.getInterpolationPoints(this.closedInterpolationIndeces,this.closedInterpolationIndeces);else if("opened"===this.state)if(void 0!==l&&Math.abs(l-a/2)>.01){c=this.getInterpolationPoints(this.flatInterpolationIndeces,[]);var d=this.getPointsAtAngle(this.getInterpolationPoints(this.closedInterpolationIndeces,this.closedInterpolationIndeces),l>a/2?a-l:l);c.x=[d.x].concat(c.x),c.y=[d.y].concat(c.y)}else c=this.getInterpolationPoints(this.openedInterpolationIndeces["right"===s?this.angle>a/2?"left":"right":this.angle<a/2?"left":"right"],this.closedInterpolationIndeces);var p=void 0,f=void 0,v=.5*u.sheets*u.depth;"closed"===this.state&&(v-=7e-6*this.p.scale),this.angle<=a/2?(p=(u.sheets-n)*u.depth,f=(u.sheets-r)*u.depth):(p=n*u.depth,f=r*u.depth);var g=.1*u.depth;p>f?(f-=g,p+=g):(f+=g,p-=g);var m=this.angle>a/2?a-this.angle:this.angle,b="closed"===this.state?m:void 0===h?a/2:h,y=this.getPointsAtAngleAndHs(c,m,b,[p/u.width,f/u.width]),w=y[0],k=y[1];this.angle>a/2&&(this.inverse(w),this.inverse(k),v=-v),this.setPoints(w,k,v)},e.prototype.setPoints=function(e,t,i){for(var n=this,o=this.getProps(),r=0,l=[t,e],h=0;h<a.default.resY;++h)for(var c=0;c<a.default.resZ;++c)for(var u=0;u<a.default.resX;++u)this.geometry.vertices[r++].set(l[h].x[u]*o.width+i,l[h].y[u]*o.width,c*o.height/(a.default.resZ-1)-.5*o.height);if(r!==this.geometry.vertices.length&&console.warn("setPoints: bad mapping!"),this.corner.use&&!this.corner.points.length){var d=new s.THREE.Plane,p=d.normal,f=(1-this.getProps().flexibleCorner)*Math.min(o.width,o.height),v=new s.THREE.Vector3;d.setFromNormalAndCoplanarPoint(new s.THREE.Vector3(-1,0,-1).normalize(),new s.THREE.Vector3(f+i,0,.5*o.height));for(var g=0,m=this.geometry.vertices.length;g<m;++g)if(d.projectPoint(this.geometry.vertices[g],v),v.sub(this.geometry.vertices[g]),v.x*p.x+v.y*p.y+v.z*p.z>0){var b=v.length()/f;this.corner.maxDistance=Math.max(this.corner.maxDistance,b),this.corner.points.push({vertex:g,distance:b})}}if(this.corner.use&&Math.abs(this.corner.height)>.001){this.corner.axis.set(-1,0,1).normalize(),this.corner.axis.applyAxisAngle(this.corner.OZ,this.angle);var y=this.corner.points,w=Array.isArray(y),k=0;for(y=w?y:y[Symbol.iterator]();;){var x;if(w){if(k>=y.length)break;x=y[k++]}else{if((k=y.next()).done)break;x=k.value}var P=x;this.geometry.vertices[P.vertex].applyAxisAngle(this.corner.axis,function(e){return o.cornerDeviation*n.corner.height/(1+Math.exp(-o.bending*(e-.5*n.corner.maxDistance)))}(P.distance))}}var C=this.markers,_=Array.isArray(C),S=0;for(C=_?C:C[Symbol.iterator]();;){var E;if(_){if(S>=C.length)break;E=C[S++]}else{if((S=C.next()).done)break;E=S.value}var T=E;T.marker.position.copy(this.geometry.vertices[T.vertex])}this.geometry.computeVertexNormals(),this.geometry.computeBoundingSphere(),this.geometry.verticesNeedUpdate=!0,this.markup&&this.markup.computeVertices()},e.prototype.inverse=function(e){for(var t=0;t<e.x.length;++t)e.x[t]=-e.x[t];return e},e.prototype.getPointsAtHs=function(e,t,i){var n=this,o=1e3;l.default.setSplinePoints(this.pSpline,e);var s=void 0,h=[],c=r({},this.pSpline.getPoint(.999)),u=r({},this.pSpline.getPoint(1)),d=u.x-c.x,p=u.y-c.y,f=Math.sqrt(d*d+p*p),v=this.pSpline.points[this.pSpline.points.length-1];v.set(v.x+.2*d/f,v.y+.2*p/f,0),(s=l.default.splitSpline(this.pSpline,o)).ls.push(1e7),l.default.mapl2L(s.ls,s.len,a.default.resX,function(e){for(var s=0;s<i.length;++s)if(e){var a=r({},n.pSpline.getPoint((e-1)/o)),l=n.pSpline.getPoint(e/o),c=-(l.y-a.y),u=l.x-a.x,d=Math.sqrt(c*c+u*u);h[s].x.push(l.x+c/d*i[s]),h[s].y.push(l.y+u/d*i[s])}else h[s]={x:[-i[s]*Math.sin(t)],y:[i[s]*Math.cos(t)]}});for(var g=[],m=0;m<i.length;++m)!function(e){g[e]={x:[],y:[]},l.default.setSplinePoints(n.iSpline,h[e]);var t=l.default.splitSpline(n.iSpline,o);t.ls.push(1e7),l.default.mapl2L(t.ls,1,a.default.resX,function(t){var i=n.iSpline.getPoint(t/o);g[e].x.push(i.x),g[e].y.push(i.y)})}(m);return g},e.prototype.getPointsAtAngleAndHs=function(e,t,i,n){var o=this.getPointsAtAngle(e,t);return this.getPointsAtHs(o,i,n)},e.prototype.getPointsAtAngle=function(e,t){var i={x:[],y:[]},n=[];t/=Math.PI/2;for(var o=0;o<e.x.length;++o)n.push(o/(e.x.length-1));for(var r=0;r<e.x[0].length;++r){for(var s=[],a=[],l=0;l<e.x.length;++l)s.push(e.x[l][r]),a.push(e.y[l][r]);i.x.push(this.interpolate(n,s,t)),i.y.push(this.interpolate(n,a,t))}return i},e.prototype.interpolate=function(e,t,i){if(!this.aSplines[e.length]){this.aSplines[e.length]=new s.THREE.CatmullRomCurve3([]);for(var n=this.aSplines[e.length].points,o=0;o<e.length;++o)n.push(new s.THREE.Vector3)}for(var r=this.aSplines[e.length],a=0;a<e.length;++a)r.points[a].set(e[a],t[a],0);return r.getPoint(Math.min(1,Math.max(i,0))).y},e.prototype.loadPoints=function(){for(var e=[],t=[],i=[0,.2877,.6347,.8174,1],n=0;n<i.length;n++){var o=i[n];e.push(o*Math.cos(.9*Math.PI/4)),t.push(o*Math.sin(.9*Math.PI/4))}return{interpolationPoints:[{x:[[0,.25,.5,.75,1],[0,.2482,.4997,.75,1],[0,.2428,.4989,.75,1],[0,.125,.3214,.566,.8192],[0,0,0,0,0],e],y:[[0,0,0,0,0],[0,.03,.0166,.0033,1e-4],[0,.0596,.0331,.0065,2e-4],[0,.2165,.383,.492,.5736],[0,.25,.5,.75,1],t]},{x:[[0,.25,.5,.75,1],[0,.2482,.4997,.75,1],[0,.2428,.4989,.75,1],[0,.125,.3214,.5574,.8192],[0,-.0434,0,.1302,.342],[0,.0434,-0,-.1302,-.342],[0,.1705,.341,.4821,.5736],[0,0,0,0,0],e],y:[[0,0,0,0,0],[0,.03,.0166,.0033,1e-4],[0,.0596,.0331,.0065,2e-4],[0,.2165,.383,.5018,.5736],[0,.2462,.5,.7386,.9397],[0,.2462,.5,.7386,.9397],[0,.1828,.3657,.5745,.8192],[0,.25,.5,.75,1],t]},{x:[[0,.2877,.6347,.8174,1],[0,.286,.632,.815,.997],[0,.279,.623,.806,.988],[0,.126,.411,.593,.774],[0,0,0,0,0],e],y:[[0,0,0,0,0],[0,.03,.01,.002,0],[0,.06,.017,.004,0],[0,.259,.44,.446,.429],[0,.2877,.6347,.8174,1],t]}],openedInterpolationIndeces:[{left:[2,3,4],right:[2,3,4]},{left:[2,6,5],right:[2,3,4]},{left:[2,3,4],right:[2,3,4]}],closedInterpolationIndeces:[[0,1,2],[0,1,2],[0,1,2]],flatInterpolationIndeces:[[5,4],[8,7],[5,4]]}},e}();t.default=c},function(e,t,i){"use strict";t.__esModule=!0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e};t.props=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"volume",t={height:.297,width:.21,backgroundColor:"",backgroundImage:"",backgroundStyle:"",highlightLinks:!0,lighting:"mixed",gravity:1,cachedPages:50,renderInactivePages:!0,renderInactivePagesOnMobile:!0,renderWhileFlipping:!1,pagesForPredicting:5,preloadPages:5,autoPlayDuration:5e3,rtl:!1,interactiveCorners:!0,maxDepth:.008,sheet:{startVelocity:1.2,cornerDeviation:.15,flexibility:10,flexibleCorner:.5,bending:11,wave:.3,shape:0,widthTexels:1920,heightTexels:1080,color:16777215,side:"color"},cover:{side:"transparent",binderTexture:"",depth:3e-4,padding:0,mass:.001},page:{depth:1e-4,mass:.001},cssLayerProps:{width:1024}},i={volume:t,flat:n({},t,{lighting:"ambient",sheet:n({},t.sheet,{wave:.05,side:"transparent",shape:1}),cover:n({},t.cover,{depth:2e-5}),page:n({},t.page,{depth:1e-5})}),"volume-paddings":n({},t,{cover:n({},t.cover,{padding:.0025})})};return i["volume-unrolling"]=n({},i.volume,{sheet:n({},i.volume.sheet,{shape:1})}),i["volume-paddings-unrolling"]=n({},i["volume-paddings"],{sheet:n({},i["volume-paddings"].sheet,{shape:1})}),i[e]||t}},function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0,t.CSS3DSprite=t.CSS3DObject=void 0;var s=i(0);s.THREE.CSS3DObject=function(e){function t(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;n(this,t);var r=o(this,e.call(this));return i&&r.set(i),r}return r(t,e),t.prototype.set=function(e){this.element=e,this.element.style.position="absolute",this.addEventListener("removed",function(){null!==this.element.parentNode&&this.element.parentNode.removeChild(this.element)})},t}(s.THREE.Object3D),s.THREE.CSS3DSprite=function(e){function t(i){return n(this,t),o(this,e.call(this,i))}return r(t,e),t}(s.THREE.CSS3DObject),s.THREE.CSS3DRenderer=function e(){function t(e){return Math.round(1e5*(e+Number.EPSILON))/1e5}function i(e,i){var n=e.elements,o="matrix3d("+[t(n[0]),t(n[1]),t(n[2]),t(n[3]),t(-n[4]),t(-n[5]),t(-n[6]),t(-n[7]),t(n[8]),t(n[9]),t(n[10]),t(n[11]),t(n[12]),t(n[13]),t(n[14]),t(n[15])].join(",")+")";return f?"translate(-50%,-50%)translate("+l+"px,"+h+"px)"+i+o:"translate(-50%,-50%)"+o}function o(e,t,n){if(e instanceof s.THREE.CSS3DObject){var r;e instanceof s.THREE.CSS3DSprite?(c.copy(t.matrixWorldInverse),c.transpose(),c.copyPosition(e.matrixWorld),c.scale(e.scale),c.elements[3]=0,c.elements[7]=0,c.elements[11]=0,c.elements[15]=1,r=i(c,n)):r=i(e.matrixWorld,n);var a=e.element,l=u.objects[e.id]&&u.objects[e.id].style;void 0!==l&&l===r||(a.style.WebkitTransform=r,a.style.MozTransform=r,a.style.transform=r,u.objects[e.id]={style:r},f&&(u.objects[e.id].distanceToCameraSquared=m(t,e))),a.parentNode!==p&&p.appendChild(a)}for(var h=0,d=e.children.length;h<d;h++)o(e.children[h],t,n)}n(this,e);var r,a,l,h,c=new s.THREE.Matrix4,u={camera:{fov:0,style:""},objects:{}},d=document.createElement("div");d.style.overflow="hidden",this.domElement=d;var p=document.createElement("div");p.style.WebkitTransformStyle="preserve-3d",p.style.MozTransformStyle="preserve-3d",p.style.transformStyle="preserve-3d",d.appendChild(p);var f=1;this.setClearColor=function(){},this.getSize=function(){return{width:r,height:a}},this.setSize=function(e,t){l=(r=e)/2,h=(a=t)/2,d.style.width=e+"px",d.style.height=t+"px",p.style.width=e+"px",p.style.height=t+"px"};var v,g,m=(v=new s.THREE.Vector3,g=new s.THREE.Vector3,function(e,t){return v.setFromMatrixPosition(e.matrixWorld),g.setFromMatrixPosition(t.matrixWorld),v.distanceToSquared(g)});this.render=function(e,i){var n=i.projectionMatrix.elements[5]*h;u.camera.fov!==n&&(d.style.WebkitPerspective=n+"px",d.style.MozPerspective=n+"px",d.style.perspective=n+"px",u.camera.fov=n),e.updateMatrixWorld(),null===i.parent&&i.updateMatrixWorld();var r="translateZ("+n+"px)"+function(e){var i=e.elements;return"matrix3d("+[t(i[0]),t(-i[1]),t(i[2]),t(i[3]),t(i[4]),t(-i[5]),t(i[6]),t(i[7]),t(i[8]),t(-i[9]),t(i[10]),t(i[11]),t(i[12]),t(-i[13]),t(i[14]),t(i[15])].join(",")+")"}(i.matrixWorldInverse),s=r+"translate("+l+"px,"+h+"px)";u.camera.style===s||f||(p.style.WebkitTransform=s,p.style.MozTransform=s,p.style.transform=s,u.camera.style=s),o(e,i,r),f&&function(e){var t=Object.keys(u.objects).sort(function(e,t){return u.objects[e].distanceToCameraSquared-u.objects[t].distanceToCameraSquared}),i=t.length;e.traverse(function(e){var n=t.indexOf(e.id+"");-1!==n&&(e.element.style.zIndex=i-n)})}(e)}},t.default=s.THREE.CSS3DRenderer;var a=s.THREE.CSS3DObject,l=s.THREE.CSS3DSprite;t.CSS3DObject=a,t.CSS3DSprite=l},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _libs=__webpack_require__(0),_CSS3DRenderer=__webpack_require__(12),CSSLayer=function(_CSS3DObject){function CSSLayer(e,t,i){_classCallCheck(this,CSSLayer);var n=_possibleConstructorReturn(this,_CSS3DObject.call(this));return n.props=i,n.jContainer=(0,_libs.$)('<div class="hidden css-layer"></div>'),n.setSize(e,t),n.setData(),n.set(n.jContainer[0]),n}return _inherits(CSSLayer,_CSS3DObject),CSSLayer.init=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:150;CSSLayer.delay=t,CSSLayer.style=(0,_libs.$)(("<style type=text/css>\n      .css-layer {\n    \t\topacity: 1;\n    \t\ttransition: opacity "+t+"ms ease-out;\n        visibility: visible;\n        overflow: hidden;\n    \t}\n    \t.css-layer.hidden {\n    \t\ttransition: opacity "+t+"ms ease-in, visibility "+t+"ms step-end;\n    \t\topacity: 0;\n        visibility: hidden;\n        display: block;\n        pointer-events: none;\n      }\n      .fb3d-block {\n        position: absolute;\n      }\n      .fb3d-audio audio, .fb3d-link a, .fb3d-iframe iframe, .fb3d-video video, .fb3d-youtube .youtube {\n        display: block;\n        position: absolute;\n        left: 0;\n        top: 0;\n        width: 100%;\n        height: 100%;\n      }\n      .fb3d-image {\n        text-align: center;\n      }\n      .fb3d-link a {\n        cursor: pointer;\n        background-color: rgba(255,255,0,.1);\n        transition: background-color .15s ease-in;\n      }\n      .fb3d-link a:hover {\n        background-color: rgba(255,255,0,.2);\n        transition: background-color .15s ease-out;\n      }\n      .fb3d-iframe iframe {\n        border: 0;\n      }\n      .fb3d-image img {\n        max-width: 100%;\n        max-height: 100%;\n      }\n    </style>").fb3dQFilter()).appendTo(e.head)},CSSLayer.dispose=function(){CSSLayer.style.remove()},CSSLayer.prototype.setSize=function(e,t){var i=this.props.width,n=t/e*i;this.jContainer.width(i).height(n),this.scale.x=1/(i/e),this.scale.y=1/(i/e)},CSSLayer.prototype.callInternal=function(e){if(this.object&&this.object[e])try{this.object[e]()}catch(e){console.error(e)}},CSSLayer.prototype.dispose=function(){this.clearInternals()},CSSLayer.prototype.clearInternals=function(){this.callInternal("dispose"),!this.css||this.css.remove(),!this.html||this.html.remove()},CSSLayer.prototype.setData=function setData(){var css=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",html=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",js=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";this.clearInternals(),this.css=(0,_libs.$)('<style type="text/css">'+css+"</style>").appendTo(this.jContainer),this.html=(0,_libs.$)(html).appendTo(this.jContainer);var init=eval(js);init&&(this.object=init(this.jContainer,this.props)||{})},CSSLayer.prototype.pendedCall=function(e){var t=this,i=this.timestamp=Date.now();setTimeout(function(){i===t.timestamp&&e()},.5*CSSLayer.delay)},CSSLayer.prototype.isHidden=function(){return this.jContainer.hasClass("hidden")},CSSLayer.prototype.hide=function(){var e=this,t=void 0;return this.isHidden()?t=Promise.resolve():(this.jContainer.addClass("hidden"),this.callInternal("hide"),t=new Promise(function(t){e.pendedCall(function(){e.callInternal("hidden"),t()})})),t},CSSLayer.prototype.show=function(){var e=this,t=void 0;return this.isHidden()?(this.jContainer.removeClass("hidden"),this.callInternal("show"),t=new Promise(function(t){e.pendedCall(function(){e.callInternal("shown"),t()})})):t=Promise.resolve(),t},CSSLayer}(_CSS3DRenderer.CSS3DObject);exports.default=CSSLayer},function(e,t,i){"use strict";t.__esModule=!0;var n=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.countSizeof;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.os=new Map,this.sizeof=i,this.maxSize=t,this.size=0}return e.prototype.forEach=function(e){this.os.forEach(function(t,i){return e([i,t])})},e.countSizeof=function(e){return 1},e.prototype.remove=function(e){var t=!1,i=this.os.get(e);return i.locked&&i.locked(e)||(this.size-=this.sizeof(i),i.dispose&&i.dispose(),this.os.delete(e),t=!0),t},e.prototype.freeSpace=function(){var e=[],t=this.os,i=Array.isArray(t),n=0;for(t=i?t:t[Symbol.iterator]();;){var o;if(i){if(n>=t.length)break;o=t[n++]}else{if((n=t.next()).done)break;o=n.value}var r=o;e.push({timestamp:r[1].timestamp,key:r[0]})}e.sort(function(e,t){return e.timestamp-t.timestamp});for(var s=0;s<e.length&&this.size>3*this.maxSize/4;++s)this.remove(e[s].key)},e.prototype.dispose=function(){var e=[],t=this.os,i=Array.isArray(t),n=0;for(t=i?t:t[Symbol.iterator]();;){var o;if(i){if(n>=t.length)break;o=t[n++]}else{if((n=t.next()).done)break;o=n.value}var r=o;e.push({v:r[1],k:r[0]})}var s=e,a=Array.isArray(s),l=0;for(s=a?s:s[Symbol.iterator]();;){var h;if(a){if(l>=s.length)break;h=s[l++]}else{if((l=s.next()).done)break;h=l.value}var c=h;c.v.dispose&&c.v.dispose(),this.os.delete(c.k)}},e.recursionSizeof=function(t){var i=0;if(t){++i;var n=t.length;if(void 0===n)for(var o in t)t.hasOwnProperty(o)&&(i+=e.recursionSizeof(t[o]));else i+=n}return i},e.prototype.getTimestamp=function(){return Date.now()},e.prototype.get=function(e){var t=this.os.get(e);return t&&(t.timestamp=this.getTimestamp()),t},e.prototype.put=function(e,t){return t.timestamp=this.getTimestamp(),this.os.set(e,t),this.size+=this.sizeof(t),this.size>this.maxSize&&this.freeSpace(),t},e}();t.default=n},function(e,t,i){"use strict";t.__esModule=!0;var n=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.handleDefault=function(e,t,i){},t.prototype.dispatchAsync=function(e){var t=this;Promise.resolve().then(function(){return t.dispatchEvent(e)})},t.prototype.dispose=function(){},t}(i(0).THREE.EventDispatcher);t.default=n},function(e,t,i){"use strict";t.__esModule=!0;var n,o=function(e){function t(i,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return!1},r=arguments[3];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var s=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,i,n));return s.eDoc=r,s.customTest=o,s.customs=[],s}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.test=function(e,t){return!(!e||!t)&&this.customTest(e,t)},t.prototype.getCallback=function(e){return e.target.callback},t.prototype.addCustom=function(e){this.customs.push(e)},t.prototype.getObject=function(e,t){var i=void 0;if(t.doc===this.eDoc){var n=this.customs,o=Array.isArray(n),r=0;for(n=o?n:n[Symbol.iterator]();;){var s;if(o){if(r>=n.length)break;s=n[r++]}else{if((r=n.next()).done)break;s=r.value}if(i=s.testIntersection(e,t))break}}return i},t}(((n=i(7))&&n.__esModule?n:{default:n}).default);t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var n,o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},r=(n=i(3))&&n.__esModule?n:{default:n},s=function(){function e(t,i,n){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.props=o({},e.defaults,n),this.strs=t,this.merge(t),this.hits=[],this.contexts=[],this.pattern=i.toLowerCase(),this.lstr=this.str.toLowerCase();for(var r=0;-1!==(r=this.lstr.indexOf(this.pattern,r));)this.addHits(r),this.addContext(r),r+=this.pattern.length}return e.isDelimetr=function(t){return t===e.DELIMITER},e.prototype.merge=function(){for(var t=[],i=[],n=this.strs,o=0,r=0;r<n.length;++r)n[r].length&&(i.push({base:r,offset:o}),t.push(n[r]),o+=n[r].length,r<n.length-1&&!e.isDelimetr(n[r].charAt(n[r].length-1))&&!e.isDelimetr(n[r+1].charAt(0))&&(t.push(e.DELIMITER),++o));this.map=i,this.str=t.join("")},e.prototype.addHits=function(t){var i=this.map[r.default.lowerBound(this.map,{offset:t},function(e,t){return e.offset-t.offset})],n=this.pattern.length,o=i.base;for(t-=i.offset;n;)if(this.strs[o].length){var s=o<this.strs.length-1&&!e.isDelimetr(this.strs[o].charAt(this.strs[o].length-1))&&!e.isDelimetr(this.strs[o+1].charAt(0)),a=Math.min(this.strs[o].length+(s?1:0)-t,n);t<this.strs[o].length&&this.hits.push({index:o,offset:t,length:Math.min(a,this.strs[o].length-t)}),n-=a,++o,t=0}},e.prototype.addContext=function(t){for(var i=t,n=t+this.pattern.length-1,o=this.props.contextLength,r=o+1;o&&r-o;)if(r=o,o%2){for(var s=i-2;s>=0;--s)if(e.isDelimetr(this.str[s])||0===s){i=0===s?0:s+1,--o;break}}else for(var a=n+2;a<this.str.length;++a)if(e.isDelimetr(this.str[a])||a===this.str.length-1){n=a===this.str.length-1?a===this.str.length-1:a-1,--o;break}this.contexts.push(this.str.substr(i,n-i+1))},e.prototype.getHits=function(){return this.hits},e.prototype.getContexts=function(){return this.contexts},e}();s.DELIMITER=" ",s.defaults={contextLength:7,hits:!0,contexts:!0},t.default=s},function(e,t,i){"use strict";t.__esModule=!0;var n,o=i(0),r=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.available=function(){return!0},t.activated=function(){return e.available.call(this)?e.activated.call(this):t.node.hasClass(t.classX)},t.addEventListener=function(i,n){e.available.call(this)?e.addEventListener.call(this,i,n):t.handler=n},t.removeEventListener=function(i,n){e.available.call(this)?e.removeEventListener.call(this,i,n):t.handler=t.defHandler},t.request=function(i){e.available.call(this)?e.request.call(this,i):t.node.hasClass(t.classX)||(t.node=(0,o.$)(i||document.body),t.node.addClass(t.classX),Promise.resolve().then(t.handler))},t.cancel=function(){e.available.call(this)?e.cancel.call(this):t.node.hasClass(t.classX)&&(t.node.removeClass(t.classX),t.node=t.defNode,Promise.resolve().then(t.handler))},t}(((n=i(53))&&n.__esModule?n:{default:n}).default);r.defNode=(0,o.$)(),r.node=r.defNode,r.defHandler=function(){},r.handler=r.defHandler,r.classX="fb3d-fullscreenx",r.style=(0,o.$)(('\n\t\t<style type="text/css">\n      .'+r.classX+" {\n        position: fixed !important;\n\t\t\t\tleft: 0 !important;\n        top: 0 !important;\n        width: 100% !important;\n        height: 100% !important;\n\t\t\t\tz-index: 2147483647 !important;\n\t\t\t\tmargin: 0 !important;\n\t\t\t\tbox-sizing: border-box !important;\n        background-color: #333;\n      }\n    </style>\n\t").fb3dQFilter()).appendTo("head"),t.default=r},function(e,t,i){"use strict";t.__esModule=!0;var n,o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},r=i(0),s=(n=i(3))&&n.__esModule?n:{default:n};r.PDFJS.GlobalWorkerOptions.workerSrc=(window.PDFJS_LOCALE?PDFJS_LOCALE:i.i({pdfJsWorker:"js/pdf.worker.js",pdfJsCMapUrl:"cmaps/"})).pdfJsWorker,r.PDFJS.cMapUrl=(window.PDFJS_LOCALE?PDFJS_LOCALE:i.i({pdfJsWorker:"js/pdf.worker.js",pdfJsCMapUrl:"cmaps/"})).pdfJsCMapUrl,r.PDFJS.cMapPacked=!0,r.PDFJS.disableAutoFetch=!0,r.PDFJS.disableStream=!0,r.PDFJS.disableRange=!1,r.PDFJS.imageResourcesPath="images/pdfjs/",r.PDFJS.externalLinkTarget=r.PDFJS.LinkTarget.BLANK,r.PDFJS.disableFontFace=void 0;var a=function(){function e(t,i,n){var a=this;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.src=s.default.normalizeUrl(t),this.handlerQueue=[],this.progresData={loaded:-1,total:1},this.loadingProgress=i,this.task=r.PDFJS.getDocument(o({url:this.src,rangeChunkSize:524288,cMapUrl:r.PDFJS.cMapUrl,cMapPacked:r.PDFJS.cMapPacked,disableAutoFetch:r.PDFJS.disableAutoFetch,disableStream:r.PDFJS.disableStream,disableRange:r.PDFJS.disableRange,imageResourcesPath:r.PDFJS.imageResourcesPath,externalLinkTarget:r.PDFJS.externalLinkTarget,disableFontFace:r.PDFJS.disableFontFace},n)),this.task.onProgress=function(e){if(a.loadingProgress){var t=Math.floor(100*e.loaded/e.total),i=Math.floor(100*a.progresData.loaded/a.progresData.total);t!==i&&(t=(t=isNaN(t)?0:t)>100?100:t,Promise.resolve().then(function(){a.loadingProgress(t)}))}a.progresData=e},this.task.promise.then(function(e){e.numPages>1?Promise.all([e.getPage(1),e.getPage(2)]).then(function(t){a.init(e,t)}):a.init(e)}).catch(function(e){console.error(e),a.errorHandler&&a.errorHandler(e)})}return e.prototype.init=function(t,i){if(this.handler=t,i){var n=e.getPageSize(i[0]),o=e.getPageSize(i[1]);this.doubledPages=n.width/n.height/(o.width/o.height)<.75}else this.doubledPages=!1;var r=Promise.resolve(t),s=this.handlerQueue.reverse(),a=Array.isArray(s),l=0;for(s=a?s:s[Symbol.iterator]();;){var h;if("break"===function(){if(a){if(l>=s.length)return"break";h=s[l++]}else{if((l=s.next()).done)return"break";h=l.value}var e=h;r=r.then(function(t){return e(t),t})}())break}},e.prototype.getPageType=function(e){return this.doubledPages&&0!==e&&e!==this.getPagesNum()-1?1&e?"left":"right":"full"},e.prototype.getPage=function(e){return this.handler.getPage(this.doubledPages?Math.ceil(e/2)+1:e+1)},e.prototype.getDestination=function(e){var t=this;return("string"==typeof e?this.handler.getDestination(e):Promise.resolve(e)).then(function(e){return t.handler.getPageIndex(e[0])}).then(function(e){return t.doubledPages?e<1?e:1+2*(e-1):e}).catch(function(){return console.error("Bad bookmark")})},e.prototype.dispose=function(){this.handlerQueue.splice(0,this.handlerQueue.length),delete this.handler},e.prototype.setLoadingProgressClb=function(e){this.loadingProgress=e},e.prototype.setErrorHandler=function(e){this.errorHandler=e},e.prototype.getPagesNum=function(){return this.handler?this.doubledPages?2*(this.handler.numPages-1):this.handler.numPages:void 0},e.getPageSize=function(e){var t=e.view[2]-e.view[0],i=e.view[3]-e.view[1],n=e.rotate*Math.PI/180;return{width:Math.abs(t*Math.cos(n)-i*Math.sin(n)),height:Math.abs(t*Math.sin(n)+i*Math.cos(n))}},e.prototype.getHandler=function(e){this.handler?e(this.handler):this.handlerQueue.push(e)},e}();t.default=a},function(e,t,i){"use strict";t.__esModule=!0;var n=i(0),o=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.objectsAndFacesTest;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.visual=t,this.coords=new n.THREE.Vector2,this.raycaster=this.visual.raycaster,this.camera=this.visual.camera,this.threes=[],this.test=i}return e.objectsTest=function(e,t){return!(!e||!t)&&e.object===t.object},e.objectsAndFacesTest=function(e,t){return!(!e||!t)&&e.object===t.object&&e.face.materialIndex===t.face.materialIndex},e.prototype.addThree=function(e){this.threes.push(e)},e.prototype.removeThree=function(e){var t=this.threes.indexOf(e);~t&&this.threes.splice(t,1)},e.prototype.getObject=function(e){return this.setCoordsFromEvent(e),this.raycaster.setFromCamera(this.coords,this.camera),this.raycaster.intersectObjects(this.threes)[0]},e}();t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var n,o=(n=i(2))&&n.__esModule?n:{default:n},r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.vertices2UVs=function(e,t,i,n,o){for(var r=[],s=i;s<n;++s)for(var a=[t[s].a,t[s].b,t[s].c],l=0;l<a.length;++l)r[a[l]]||(r[a[l]]=o(e[a[l]]));return r},e.computeFaceVertexUvs=function(t,i){for(var n=[e.vertices2UVs(t.vertices,t.faces,0,i[0],function(e){return new THREE.Vector2(e.x,1-e.z)}),e.vertices2UVs(t.vertices,t.faces,i[0],i[1],function(e){return new THREE.Vector2(1-e.x,1-e.z)}),e.vertices2UVs(t.vertices,t.faces,i[1],i[2],function(e){return new THREE.Vector2(e.x,e.y)}),e.vertices2UVs(t.vertices,t.faces,i[2],i[3],function(e){return new THREE.Vector2(1-e.x,e.y)}),e.vertices2UVs(t.vertices,t.faces,i[3],i[4],function(e){return new THREE.Vector2(e.z,e.y)}),e.vertices2UVs(t.vertices,t.faces,i[4],t.faces.length,function(e){return new THREE.Vector2(1-e.z,e.y)})],o=0,r=0;r<t.faces.length;++r){o+=i[o]===r;var s=t.faces[r];s.materialIndex=o,t.faceVertexUvs[0][r]=[n[o][s.a],n[o][s.b],n[o][s.c]]}},e.createMarker=function(e,t,i){var n=new THREE.Mesh(new THREE.SphereGeometry(i),new THREE.MeshPhongMaterial({color:t}));return n.position.set(e.x,e.y,e.z),n},e.findUvTris=function(e,t,i,n){var r=[],s=t,a=Array.isArray(s),l=0;for(s=a?s:s[Symbol.iterator]();;){var h;if(a){if(l>=s.length)break;h=s[l++]}else{if((l=s.next()).done)break;h=l.value}for(var c=h,u=!1,d=i;d<n&&!u;++d){var p=e.faceVertexUvs[0][d];o.default.isInsideConvPoly(p,c)&&(r.push({coefs:o.default.computeInterpCoefs(p,c),i:d}),u=!0)}u||(console.error("Bad point"),r.push(void 0))}return r},e.findInternalVertices=function(e,t,i,n){for(var r={},s=i;s<n;++s)for(var a=e.faceVertexUvs[0][s],l=e.faces[s],h=[l.a,l.b,l.c],c=0;c<a.length;++c)void 0===r[h[c]]&&o.default.isInsidePoly(t,a[c])&&(r[h[c]]={p:a[c],i:h[c],n:l.vertexNormals[c]});return Object.values(r)},e}();t.default=r},function(e,t,i){"use strict";t.__esModule=!0;var n,o=function(e){function t(i,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this));return o.name=n,o.view=i,o.visible=!1,o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.togle=function(){this.visible=!this.visible,this.fireChange()},t.prototype.hide=function(){this.visible=!1,this.fireChange()},t.prototype.fireChange=function(){this.onChange&&this.onChange(),this.updateView()},t.prototype.updateView=function(){this.view&&this.view.setState(this.name,{enable:!0,visible:this.visible,active:!1})},t}(((n=i(15))&&n.__esModule?n:{default:n}).default);t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.test=function(e,t){return e.target===t.target},e}();t.default=n},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},r=i(1),s=n(i(48)),a=n(i(70)),l=n(i(37)),h=n(i(28)),c=n(i(31)),u=n(i(29)),d=n(i(36)),p=n(i(32)),f=n(i(56)),v=n(i(68)),g=n(i(61)),m=n(i(47)),b=n(i(66)),y=n(i(43)),w=n(i(39)),k=n(i(30)),x=n(i(26)),P=n(i(42)),C=n(i(18));r.$.fn.FlipBook=function(e){var t={dispose:function(){this.ready?(!t.pdfLinksHandler||t.pdfLinksHandler.dispose(),delete t.pdfLinksHandler,t.sounds.dispose(),delete t.sounds,t.userMessageCtrl.dispose(),delete t.userMessageCtrl,t.tocCtrl.dispose(),delete t.tocCtrl,t.thumbnails.dispose(),delete t.thumbnails,!t.bookmarks||t.bookmarks.dispose(),delete t.bookmarks,t.shareCtrl.dispose(),delete t.shareCtrl,t.ctrl.dispose(),delete t.ctrl,t.bookPrinter.dispose(),delete t.bookPrinter,t.book.dispose(),delete t.book,t.propsBuilder.dispose(),delete t.propsBuilder,delete t.bookBuilder,t.visual.dispose(),delete t.visual,t.view.dispose(),delete t.view,delete t.dispose):this.pendingDispose=!0}};e=o({},e);var i=this.length?this[0]:(0,r.$)("<div>").appendTo("body");return e.activateFullScreen&&C.default.request(i),t.view=new c.default(i,function(){if(s.default.webgl){t.loadingCtrl=new f.default(t.view,!0,function(e){return 0===e?(0,r.tr)("Please wait... the Application is Loading"):(0,r.tr)("PDF is Loading:")+" "+e+"%"}),t.userMessageCtrl=new v.default(t.view),t.visual=new a.default(t.view.getContainer().ownerDocument.defaultView,t.view.getContainer().ownerDocument,t.view.getView()),e.propertiesCallback&&new p.default(t.visual,function(){return{type:"blank"}},1,function(i){var n=[];""!==(i=e.propertiesCallback(i)).backgroundColor&&n.push("background-color:#"+new THREE.Color(i.backgroundColor).getHexString()),""!==i.backgroundImage&&n.push("background-image:url('"+i.backgroundImage+"')"),""!==i.backgroundStyle&&n.push(i.backgroundStyle),n.length&&t.view.getView().attr("style",n.join(";"))}),t.bookBuilder=function(i,n,s){i.cssLayerProps=o({},i.cssLayerProps,{scene:t}),e.propertiesCallback&&(i=e.propertiesCallback(i)),t.book=new h.default(t.visual,n,s,i),t.bookPrinter=new k.default(t.visual,t.book,(e.template||{}).printStyle),t.loadingCtrl.dispose(),delete t.loadingCtrl,t.ctrl=new u.default(t.book,t.view,e.controlsProps),t.book.setInjector(function(e){e.jQuery=e.$=r.$,e.book=t.book,e.bookCtrl=t.ctrl,i.injector&&i.injector(e)}),t.view.addHandler(t.ctrl),t.ctrl.setPrinter(t.bookPrinter);var a=s(0);t.thumbnails=new b.default(t.visual,t.view.getThumbnailsView(),s,t.book.getPages(),{kWtoH:i.width/i.height}),t.tocCtrl=new y.default(t.view,t.ctrl),t.tocCtrl.setThumbnails(t.thumbnails),e.outline&&(t.bookmarks=new m.default(t.view.getBookmarksView(),e.outline),t.tocCtrl.setBookmarks(t.bookmarks)),t.ctrl.setTocCtrl(t.tocCtrl),t.view.addHandler(t.tocCtrl),"pdf"===a.type&&(t.search=new g.default(t.view.getSearchView(),t.book.getPages()),t.search.onQuery=t.book.setQuery.bind(t.book),t.book.addEventListener("searchResults",function(e){t.search.setResults(e.results,e.lastPage)}),t.tocCtrl.setSearch(t.search),t.ctrl.setTocCtrl(t.tocCtrl),t.pdfLinksHandler=new l.default(a.src,t.ctrl,t.visual.element),t.book.addEventListener("pdfAnnotation",t.pdfLinksHandler.handleEvent.bind(t.pdfLinksHandler)),t.bookmarks||a.src.getHandler(function(e){e.getOutline().then(function(e){e&&e.length&&(t.bookmarks=new m.default(t.view.getBookmarksView(),e),t.tocCtrl.setBookmarks(t.bookmarks,a.src),t.ctrl.setTocCtrl(t.tocCtrl))})}),e.pdfLinks&&e.pdfLinks.handler&&t.pdfLinksHandler.setHandler(e.pdfLinks.handler)),t.sounds=new P.default(e.template),t.ctrl.setSounds(t.sounds),t.sounds.subscribeFlips(t.ctrl),t.ready=!0;var c=new x.default(t.visual,t.ctrl,e.autoNavigation);t.shareCtrl=new w.default(t.view,t.ctrl,e.shareLinkBuilder?e.shareLinkBuilder:function(e){return new RegExp("([?&])"+c.urlParam+"=[0-9]+").test(location.href)?location.href.replace(new RegExp("([?&])"+c.urlParam+"=[0-9]+"),"$1"+c.urlParam+"="+e):location.href.split("#")[0]+(~location.href.indexOf("?")?"&":"?")+c.urlParam+"="+e+location.hash}),t.ctrl.setShareCtrl(t.shareCtrl),t.view.addHandler(t.shareCtrl),c.dispose(),e.ready&&e.ready(t),t.ctrl.ready(t),t.pendingDispose&&t.dispose()};var i=function(e){!t.loadingCtrl||t.loadingCtrl.dispose(),delete t.loadingCtrl,t.userMessageCtrl.setError(e.message)};e.pdf?(t.propsBuilder=new d.default(e.pdf,t.bookBuilder,e.bookStyle,e.pdfOpenOptions),t.propsBuilder.pdf.setLoadingProgressClb(t.loadingCtrl.setProgress.bind(t.loadingCtrl)),t.propsBuilder.pdf.setErrorHandler(e.error||i)):e.pageCallback?(e.onPageCallbackError&&e.onPageCallbackError.push(e.error||i),t.propsBuilder=new p.default(t.visual,e.pageCallback,e.pages,t.bookBuilder,e.bookStyle)):t.propsBuilder=new p.default(t.visual,h.default.pageCallback,6,t.bookBuilder,e.bookStyle)}else s.default.addGetWebGLMessage({parent:t.view.getView()})},e.template),t},(0,r.$)(function(){for(var e=(0,r.$)(".flip-book-container"),t=0;t<e.length;++t){var i=(0,r.$)(e[t]),n=i.attr("src");n&&i.FlipBook({pdf:n})}}),window.jQuery=window.$=r.$},function(e,t,i){"use strict";Array.prototype.fill||(Array.prototype.fill=function(e){if(null==this)throw new TypeError("this is null or not defined");for(var t=Object(this),i=t.length>>>0,n=0|arguments[1],o=n<0?Math.max(i+n,0):Math.min(n,i),r=arguments[2],s=void 0===r?i:0|r,a=s<0?Math.max(i+s,0):Math.min(s,i);o<a;)t[o]=e,o++;return t}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null==this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var t,i=Object(this),n=i.length>>>0,o=arguments[1],r=0;r<n;r++)if(t=i[r],e.call(o,t,r,i))return t}}),Array.prototype.findIndex||(Array.prototype.findIndex=function(e){if(null==this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var t,i=Object(this),n=i.length>>>0,o=arguments[1],r=0;r<n;r++)if(t=i[r],e.call(o,t,r,i))return r;return-1}),Object.values||(Object.values=function(e){return Object.keys(e).map(function(t){return e[t]})||[]}),RegExp.escape||(RegExp.escape=function(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}),String.prototype.replaceAll||(String.prototype.replaceAll=function(e,t){return this.replace(new RegExp(RegExp.escape(e),"g"),t)}),String.prototype.fb3dQFilter||(String.prototype.fb3dQFilter=function(){return this.replace(/(\n|\t|  )/g,"")})},function(e,t,i){"use strict";t.__esModule=!0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},o=function(){function e(t,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),o=n({},o,{urlParam:o.urlParam||"fb3d-page",navigates:void 0===o.navigates?1:o.navigates,pageN:o.pageN||0}),this.props=o,this.context=t,this.bookCtrl=i,this.urlParam=o.urlParam,this.pageN=o.pageN,this.wnd=t.wnd,this.wnd.fb3d=n({},this.wnd.fb3d),this.wnd.fb3d.navigator=n({},this.wnd.fb3d.navigator),this.navigator=this.wnd.fb3d.navigator[this.urlParam]=n({},this.wnd.fb3d.navigator[this.urlParam]),this.navigator.instances=(this.navigator.instances||0)+1,this.navigator.instances<=this.props.navigates&&this.bookCtrl.goToPage(this.getPageNumber())}return e.prototype.dispose=function(){},e.prototype.getParameterByName=function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var i=new RegExp("[?&]"+e+"(=([^]*)|&|#|$)").exec(t);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null},e.prototype.getPageNumber=function(){var e=parseInt(this.pageN);return(isNaN(e)||0===e)&&(e=this.getParameterByName(this.urlParam),e=parseInt(e),isNaN(e)&&(e=1)),e-1},e}();t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var n,o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},r=i(1),s=(n=i(5))&&n.__esModule?n:{default:n},a=function(){function e(t,i){var n=this,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.visual=t,this.p=o({},i,{backSize:2*i.cover.depth+i.sheets*i.page.depth}),this.OZ=new r.THREE.Vector3(0,0,1),this.backG=new r.THREE.BoxGeometry(.001,this.p.backSize,i.cover.height);var a={color:i.cover.color},l={opacity:0,transparent:!0};this.materials=[new r.THREE.MeshPhongMaterial(a),new r.THREE.MeshPhongMaterial(a),new r.THREE.MeshPhongMaterial(l),new r.THREE.MeshPhongMaterial(l),new r.THREE.MeshPhongMaterial(l),new r.THREE.MeshPhongMaterial(l)];var h=new r.THREE.Mesh(this.backG,this.materials);""!==i.cover.binderTexture&&this.visual.textureLoader.load(i.cover.binderTexture,function(e){n.materials[1].color.setHex(16777215),n.materials[1].map=e,e.minFilter=r.THREE.LinearFilter,e.needsUpdate=!0,n.materials[1].needsUpdate=!0}),this.three=new r.THREE.Object3D,this.back=new r.THREE.Object3D,this.backRT=new r.THREE.Object3D,this.backRR=new r.THREE.Object3D,this.backLT=new r.THREE.Object3D,this.backLR=new r.THREE.Object3D,this.leftPivot=new r.THREE.Object3D,this.rightPivot=new r.THREE.Object3D,s||(h.position.set(.5*(i.cover.depth-.001),0,0),this.back.add(h)),this.back.add(this.leftPivot),this.back.add(this.rightPivot),this.backRT.add(this.back),this.backRR.add(this.backRT),this.backLT.add(this.backRR),this.backLR.add(this.backLT),this.three.add(this.backLR)}return e.prototype.dispose=function(){var e=this.materials,t=Array.isArray(e),i=0;for(e=t?e:e[Symbol.iterator]();;){var n;if(t){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}var o=n;o.map&&(o.map=null,o.needsUpdate=!0),o.dispose()}delete this.materials,this.backG.dispose()},e.prototype.set=function(e){var t=void 0,i=void 0;e>Math.PI/2?(t=Math.PI/2,i=e-Math.PI/2):(t=e,i=0);var n=this.p,o={x:-.5*n.cover.depth,y:.5*n.backSize-n.cover.depth};this.backRT.position.set(o.x,o.y,0),this.backRR.position.set(-o.x,-o.y,0),this.backRR.quaternion.setFromAxisAngle(this.OZ,t);var r={x:n.backSize-2*n.cover.depth-.5*n.cover.depth,y:.5*n.backSize-n.cover.depth};this.backLT.position.set(r.x,r.y,0),this.backLR.position.set(-r.x,-r.y,0),this.backLR.quaternion.setFromAxisAngle(this.OZ,i)},e.prototype.setLeft=function(e){var t=Math.PI;this.leftPivot.position.set(s.default.interpolateLinear([-t,-t/2],[0,this.p.cover.depth],e),.5*this.p.backSize-.5*this.p.cover.depth,0),this.leftPivot.quaternion.setFromAxisAngle(this.OZ,e)},e.prototype.setRight=function(e){var t=Math.PI;this.rightPivot.position.set(s.default.interpolateLinear([-t/2,0],[this.p.cover.depth,0],e),-.5*this.p.backSize+.5*this.p.cover.depth,0),this.rightPivot.quaternion.setFromAxisAngle(this.OZ,e)},e.prototype.joinLeftCover=function(e){e.three.position.set(0,-.5*this.p.cover.depth,0),this.leftPivot.add(e.three)},e.prototype.disconnectLeftCover=function(e){this.leftPivot.remove(e.three)},e.prototype.joinRightCover=function(e){e.three.position.set(0,-.5*this.p.cover.depth,0),this.rightPivot.add(e.three)},e.prototype.disconnectRightCover=function(e){this.rightPivot.remove(e.three)},e}();t.default=a},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},_libs=__webpack_require__(1),_book=__webpack_require__(11),_GraphUtils=__webpack_require__(4),_GraphUtils2=_interopRequireDefault(_GraphUtils),_Binder=__webpack_require__(27),_Binder2=_interopRequireDefault(_Binder),_Cover=__webpack_require__(33),_Cover2=_interopRequireDefault(_Cover),_SheetBlock=__webpack_require__(10),_SheetBlock2=_interopRequireDefault(_SheetBlock),_SheetPhysics=__webpack_require__(41),_SheetPhysics2=_interopRequireDefault(_SheetPhysics),_PageManager=__webpack_require__(35),_PageManager2=_interopRequireDefault(_PageManager),_CSSLayer=__webpack_require__(13),_CSSLayer2=_interopRequireDefault(_CSSLayer),_CssLayersManager=__webpack_require__(34),_CssLayersManager2=_interopRequireDefault(_CssLayersManager),_SearchEngine=__webpack_require__(38),_SearchEngine2=_interopRequireDefault(_SearchEngine),_CustomEventConverter=__webpack_require__(16),_CustomEventConverter2=_interopRequireDefault(_CustomEventConverter),_CircleTarget=__webpack_require__(72),_CircleTarget2=_interopRequireDefault(_CircleTarget),_YouTubeApi=__webpack_require__(71),_YouTubeApi2=_interopRequireDefault(_YouTubeApi),Book=function(_THREE$EventDispatche){function Book(e,t,i,n){_classCallCheck(this,Book);var o=_possibleConstructorReturn(this,_THREE$EventDispatche.call(this));o.cssFs={play:function(e){if(e.play)e.fb3dNoPlay=!1,(e.play()||{catch:function(){}}).catch(function(t){e.fb3dNoPlay||"NotAllowedError"!==t.name||(o.pendingPlayers.push(e),o.dispatchEvent({type:"pendingPlayers"}))});else if((0,_libs.$)(e).hasClass("youtube")){var t=e.player;e.fb3dNoPlay=!1,t&&t.playVideo?t.playVideo():setTimeout(function(){e.fb3dNoPlay||o.cssFs.play(e)},200)}},pause:function(e){if(e.pause)e.fb3dNoPlay=!0,e.pause();else if((0,_libs.$)(e).hasClass("youtube")){var t=e.player;e.fb3dNoPlay=!0,t&&t.pauseVideo&&t.pauseVideo()}}},o.visual=e,o.mouseController=!0,o.p=_extends({},o.prepareProps(_extends({},n,{sheets:t})),{pageCallback:i,zoom:1,singlePage:!1,autoResolution:{enabled:!1}}),o.userDirection={lastTopPage:0,direction:1},o.pageManager=new _PageManager2.default(e,o,o.p),_CSSLayer2.default.init(e.doc),o.layerManager=new _CssLayersManager2.default(o),o.searchEngine=new _SearchEngine2.default(i,2*(t+2)),o.searchEngine.onPageHitsChanged=function(e,t){o.pageManager.refreshPageQuery(e,t),o.dispatchEvent({type:"searchResults",results:o.searchEngine.results,lastPage:e,query:t})},o.three=new _libs.THREE.Object3D,o.binder=new _Binder2.default(e,o.p,o.getPages()<3),o.three.add(o.binder.three);var r={left:o.p.cover,right:o.p.cover};return o.enableMouse(o.p.interactiveCorners),2===o.getPages()&&(o.enableMouse(!1),r[o.p.rtl?"left":"right"]=_extends({},o.p.cover,{width:1e-6,height:1e-6})),o.leftCover=new _Cover2.default(e,_extends({},o.p,{cover:r.left,setTexture:o.setLeftCoverTexture.bind(o)}),Math.PI/2,"opened"),o.binder.joinLeftCover(o.leftCover),o.subscribeSheetBlock(o.leftCover,0),o.rightCover=new _Cover2.default(e,_extends({},o.p,{cover:r.right,setTexture:o.setRightCoverTexture.bind(o)}),0,"closed"),o.binder.joinRightCover(o.rightCover),o.subscribeSheetBlock(o.rightCover,2*(o.p.sheets+1)),o.threeSheetBlocks=new _libs.THREE.Object3D,o.three.add(o.threeSheetBlocks),o.threeSheetBlocks.position.set(.5*o.p.cover.depth-.5*t*o.p.page.depth,-.5*t*o.p.page.depth,0),o.sheetBlocks=[],t>0&&o.addSheetBlock(0,new _SheetBlock2.default(e,_extends({},o.p,{setTexture:o.setPageTexture.bind(o)}),0,t,0,"closed")),o.reducePagesWidth(!0),o.set(Math.PI/2),o.openedBox=(new _libs.THREE.Box3).setFromObject(o.leftCover.three),o.openedBox.union((new _libs.THREE.Box3).setFromObject(o.rightCover.three)),o.angle=o.p.rtl?Math.PI:0,o.closedAngle=0,o.set(o.angle,0),o.lastMousePos={t:0},o.pendingPlayers=[],o.three.position.set(-.5*o.p.cover.depth+.5*t*o.p.page.depth,0,0),o.sheetPhysics=new _SheetPhysics2.default(o.p.page.width/o.p.scale,o.p.gravity,o.p.page.cornerDeviation),o.binds={update:o.update.bind(o),lastMousePos:function(e){o.lastMousePos=_extends({},o.lastMousePos,{pageX:e.pageX,pageY:e.pageY})}},o.visual.addRenderCallback(o.binds.update),(0,_libs.$)(o.visual.element).on("mousemove",o.binds.lastMousePos),o.binds.onPickCallback=o.onPickCallback.bind(o),o.visual.drag.onPickCallback=o.binds.onPickCallback,o.binds.onDragCallback=o.onDragCallback.bind(o),o.visual.drag.onDragCallback=o.binds.onDragCallback,o.binds.onReleaseCallback=o.onReleaseCallback.bind(o),o.visual.drag.onReleaseCallback=o.binds.onReleaseCallback,o.dragAngle=.05,o.tmp={boxs:[new _libs.THREE.Box3,new _libs.THREE.Box3]},o.visual.addObject(o.three),o.tmpBox=new _libs.THREE.Box3,o.bookShadowMaterial=new _libs.THREE.MeshPhongMaterial({color:0,side:_libs.THREE.DoubleSide,transparent:!0}),o.bookShadow=new _libs.THREE.Mesh(new _libs.THREE.PlaneGeometry(1,1).rotateX(-Math.PI/2),o.bookShadowMaterial),o.visual.addObject(o.bookShadow),o.calculateShadow(),o.visual.addEventListener("resize",o.pageManager.refreshZoom.bind(o.pageManager)),setTimeout(function(){o.isProcessing()||(o.notifyBeforeAnimation(),o.notifyAfterAnimation())},100),o.updateThree(),o}return _inherits(Book,_THREE$EventDispatche),Book.prototype.calculateShadow=function(){var e=this.tmpBox;e.setFromObject(this.three),this.bookShadow.scale.set(e.max.x-e.min.x,1,e.max.z-e.min.z),this.bookShadow.position.set(.5*(e.max.x+e.min.x)-.015,e.min.y-.0015,.5*(e.max.z+e.min.z)-.015),this.bookShadowMaterial.opacity=.03,this.visual.shadowPlace.position.set(0,e.min.y-.015,0)},Book.prototype.dispose=function(){this.visual.removeObject(this.three),this.sheetPhysics.dispose(),delete this.visual.drag.onPickCallback,delete this.visual.drag.onDragCallback,delete this.visual.drag.onReleaseCallback,(0,_libs.$)(this.visual.element).off("mousemove",this.binds.lastMousePos),this.visual.removeRenderCallback(this.binds.update),this.removeSheetBlocks(0,this.sheetBlocks.length),this.binder.disconnectLeftCover(this.leftCover),this.removeSheetBlock(this.leftCover),this.binder.disconnectRightCover(this.rightCover),this.removeSheetBlock(this.rightCover),this.binder.dispose(),this.layerManager.dispose(),_CSSLayer2.default.dispose(),this.pageManager.dispose()},Book.prototype.hasPendingPlayers=function(){return this.pendingPlayers.length>0},Book.prototype.resolvePendingPlayers=function(){var e=this.pendingPlayers,t=Array.isArray(e),i=0;for(e=t?e:e[Symbol.iterator]();;){var n;if(t){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}n.play()}this.pendingPlayers=[],this.dispatchEvent({type:"pendingPlayers"})},Book.prototype.updateThree=function(){this.three.userData.needsUpdate=!0},Book.prototype.setAutoResolution=function(e){this.p.autoResolution=_extends({},this.p.autoResolution,e)},Book.prototype.setZoom=function(e,t){(Math.abs(this.p.zoom-e)>.001||t!==this.p.singlePage)&&(this.p.zoom=e,this.p.singlePage=t,this.pageManager.refreshZoom())},Book.prototype.getPageCallback=function(){return this.p.pageCallback},Book.prototype.setQuery=function(e){this.searchEngine.setQuery(e)},Book.prototype.isProcessing=function(){return 0!==this.sheetPhysics.getSize()},Book.prototype.getPages=function(){return this.p.pages},Book.prototype.getBookPages=function(){return 4+2*this.p.sheets},Book.prototype.setFlipProgressClb=function(e){this.p.flipProgressClb=e},Book.prototype.setInjector=function(e){this.p.injector=e},Book.prototype.isActivePage=function(e){var t=!0;if(e>1&&e<this.getBookPages()-2){var i=this.sheetBlocks,n=Array.isArray(i),o=0;for(i=n?i:i[Symbol.iterator]();;){var r;if(n){if(o>=i.length)break;r=i[o++]}else{if((o=i.next()).done)break;r=o.value}var s=r;if(e-2>2*s.p.first&&e-2<2*s.p.last-1){t=!1;break}}}return t},Book.prototype.getBlockByPage=function(e){var t=void 0;if(e<2)t=this.leftCover;else if(e<2*(this.p.sheets+1)){var i=this.sheetBlocks,n=Array.isArray(i),o=0;for(i=n?i:i[Symbol.iterator]();;){var r;if(n){if(o>=i.length)break;r=i[o++]}else{if((o=i.next()).done)break;r=o.value}var s=r;if(e-2>=2*s.p.first&&e-2<2*s.p.last){t=s;break}}}else t=this.rightCover;return t},Book.prototype.getBlockPages=function(e){var t=void 0;switch(e){case this.leftCover:t=[0,1];break;case this.rightCover:t=[2*(this.p.sheets+1),2*(this.p.sheets+1)+1];break;default:t=e?[2*(e.p.first+1),2*(e.p.last+1)-1]:void 0}return t},Book.prototype.getPage=function(){var e=Math.PI,t=void 0;if(this.angle===e/2||this.angle===3*e/2){var i=this.sheetBlocks,n=Array.isArray(i),o=0;for(i=n?i:i[Symbol.iterator]();;){var r;if(n){if(o>=i.length)break;r=i[o++]}else{if((o=i.next()).done)break;r=o.value}var s=r;if(s.angle<=e/2){t=this.getBlockPages(s)[0]-1;break}}t||(t=this.getBookPages()-3)}else this.angle<e/2?t=0:this.angle>3*e/2?t=1:this.angle<e?t=this.getBookPages()-3:this.angle>=e&&(t=this.getBookPages()-1);return t},Book.prototype.getTopPages=function(){var e=this.getPage();return 0===e||e===this.getBookPages()-1?[e]:[e,e+1]},Book.prototype.getPageState=function(e){return this.pageManager.getPageState(e)},Book.prototype.enableLoadingAnimation=function(e){this.pageManager.enableLoadingAnimation(e)},Book.prototype.getLeftFlipping=function(){var e=void 0,t=this.sheetBlocks[0],i=Math.PI;return this.angle===i?this.getPages()>1&&(e=this.rightCover):t&&"closed"===t.state&&t.angle>i/2?e=t:this.angle!==i/2&&this.angle!==3*i/2||this.p.rtl&&this.getPages()!==this.getBookPages()||(e=this.leftCover),e},Book.prototype.getRightFlipping=function(){var e=void 0,t=this.sheetBlocks[this.sheetBlocks.length-1],i=Math.PI;return 0===this.angle?this.getPages()>1&&(e=this.leftCover):t&&"closed"===t.state&&t.angle<=i/2?e=t:this.angle!==i/2&&this.angle!==3*i/2||(this.p.rtl||this.getPages()===this.getBookPages())&&(e=this.rightCover),e},Book.prototype.getClosedBlockAngle=function(e){var t=void 0,i=Math.PI;if(this.leftCover.physicId){var n=void 0;try{n=Math.abs(this.sheetPhysics.getParametr(this.leftCover.physicId,"angle")-e)}catch(e){n=0}t=e>i/2||n>i/6?i/2:this.closedAngle}else if(this.rightCover.physicId){var o=void 0;try{o=Math.abs(this.sheetPhysics.getParametr(this.rightCover.physicId,"angle")-e)}catch(e){o=0}t=e<i/2||o>i/6?i/2+1e-7:this.closedAngle}else t=i/2+1e-7*(0!==e);return{openedAngle:e,closedAngle:t,binderTurn:this.closedAngle}},Book.prototype.flipLeft=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.p.flipProgressClb;if(!this.flipDisabled){this.sheetPhysics.getSize()||(this.flipDirection="left");var n=void 0,o=void 0;if(this.sheetPhysics.getSize()<25){var r=this.sheetBlocks[0],s=Math.PI;this.angle===s?o=this.connectPhysics(n=this.rightCover,this.p.cover.mass,s,-this.p.cover.startVelocity,this.p.cover.flexibility,0,function(t,i){return e.set(3*s/2-t/2,i)},function(t,i){e.set(3*s/2-t/2,0),e.setSheetBlocks(t?s:s/2+1e-7,"closed")},i):r&&"closed"===r.state&&r.angle>s/2?(n=t<r.getSize()?this.splitSheetBlock(0,r.getSize()-t)[1]:r,o=this.connectPhysics(n,this.p.page.mass*n.getSize(),s,-this.p.page.startVelocity,this.p.page.flexibility,0,function(t,i){return n.set(e.getClosedBlockAngle(t),"opened",i,n.p.first,n.p.last,e.flipDirection)},Book.finishAnimationClb.bind({book:this,block:n}),i)):this.angle!==s/2&&this.angle!==3*s/2||(o=this.connectPhysics(n=this.leftCover,this.p.cover.mass,s,-this.p.cover.startVelocity,this.p.cover.flexibility,0,function(t,i){e.set(2*s-t/2,i),t>s/2&&e.setSheetBlocks(t?s/2:0,"closed")},function(t,i){return e.set(0===t?0:2*s-t/2,0)},i))}return o}},Book.prototype.flipRight=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.p.flipProgressClb;if(!this.flipDisabled){this.sheetPhysics.getSize()||(this.flipDirection="right");var n=void 0,o=void 0;if(this.sheetPhysics.getSize()<25){var r=this.sheetBlocks[this.sheetBlocks.length-1],s=Math.PI;0===this.angle?o=this.connectPhysics(n=this.leftCover,this.p.cover.mass,0,this.p.cover.startVelocity,this.p.cover.flexibility,0,function(t,i){return e.set(t/2,i)},function(t,i){e.set(t/2,0),e.setSheetBlocks(t?s/2:0,"closed")},i):r&&"closed"===r.state&&r.angle<=s/2?(n=t<r.getSize()?this.splitSheetBlock(this.sheetBlocks.length-1,t)[0]:r,o=this.connectPhysics(n,this.p.page.mass*n.getSize(),0,this.p.page.startVelocity,this.p.page.flexibility,0,function(t,i){return n.set(e.getClosedBlockAngle(t),"opened",i,n.p.first,n.p.last,e.flipDirection)},Book.finishAnimationClb.bind({book:this,block:n}),i)):this.angle!==s/2&&this.angle!==3*s/2||(o=this.connectPhysics(n=this.rightCover,this.p.cover.mass,0,this.p.cover.startVelocity,this.p.cover.flexibility,0,function(t,i){e.set(s/2+t/2,i),t<s/2&&e.setSheetBlocks(s/2+1e-7,"closed")},function(t,i){return e.set(s/2+t/2,0)},i))}return o}},Book.prototype.clearHoverInfo=function(){this.pageManager.turnOnEvents(),delete this.hoverInfo.block.force,delete this.hoverInfo.block.cornerForce,delete this.hoverInfo},Book.prototype.xSegment=function(){var e=this.tmp.boxs,t={};return this.leftCover.physicId?(e[0].setFromObject(this.rightCover.three),t.min=-(t.max=e[0].max.x)):this.rightCover.physicId?(e[0].setFromObject(this.leftCover.three),t.max=-(t.min=e[0].min.x)):(e[0].setFromObject(this.leftCover.three),e[1].setFromObject(this.rightCover.three),e[0].union(e[1]),t.min=e[0].min.x,t.max=e[0].max.x),t},Book.prototype.computeTarget=function(e){var t,i=e.x,n=(e.y,this.xSegment());return t=(n.max-i)/(n.max-n.min)*Math.PI,Math.max(this.dragAngle,Math.min(Math.PI-this.dragAngle,t))},Book.prototype.onPickCallback=function(e){var t=!1,i=e.object.userData.self,n=_extends({},e.uv),o=e.face.materialIndex;return o<2&&(n.x=0===o?n.x:1-n.x,i.cornerTarget.testIntersection(null,n)&&i.physicId&&(this.hoverInfo&&this.clearHoverInfo(),i.force=_SheetPhysics2.default.dragForceClb,i.cornerForce=_SheetPhysics2.default.getDragCornerForceClb(this.computeTarget(e.point)),this.dragInfo={object:e,block:i},t=!0,this.pageManager.turnOffEvents())),t},Book.prototype.onDragCallback=function(e){var t=this.dragInfo.block;return t.getProps(),t.force=_SheetPhysics2.default.dragForceClb,t.cornerForce=_SheetPhysics2.default.getDragCornerForceClb(this.computeTarget(e)),!0},Book.prototype.onReleaseCallback=function(){delete this.dragInfo.block.force,delete this.dragInfo.block.cornerForce,delete this.dragInfo,this.pageManager.turnOnEvents()},Book.prototype.getFlipping=function(e){return e?this.getLeftFlipping():this.getRightFlipping()},Book.prototype.flip=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e?this.flipLeft(t):this.flipRight(t)},Book.prototype.enableMouse=function(e){this.mouseController=e},Book.prototype.cornerCallback=function(e,t){var i=this;if(this.mouseController){var n=t.data,o=n.i,r=n.n;if("mouseover"===e.type){if(this.hoverInfo&&void 0!==this.hoverInfo.pendings)++this.hoverInfo.pendings;else if(this.hoverInfo&&(console.warn("Wrong state: element is already hover"),this.hoverInfo.n!==r&&this.clearHoverInfo()),!this.hoverInfo&&!this.dragInfo){var s=Promise.resolve(void 0),a=this.getBlockByPage(r),l=this.getFlipping(o);if(r>1&&r<2*(this.p.sheets+1)&&a.physicId&&(a.angle<.02||a.angle>Math.PI-.02))s=Promise.resolve(a);else if(a===l){var h=[this.leftCover].concat(this.sheetBlocks,[this.rightCover]),c=h.indexOf(a),u=~c?h[c+2*o-1]:void 0;(!u||!u.physicId||u.angle>.02&&u.angle<Math.PI-.02)&&(s=this.flip(o,1).then(function(e){return e?i.sheetPhysics.setParametr(e.physicId,"velocity",0):delete i.hoverInfo,e}),this.hoverInfo={pendings:1})}s.then(function(e){if(i.hoverInfo&&i.hoverInfo.pendings<1&&(e=void 0,delete i.hoverInfo),e){i.pageManager.turnOffEvents();var t=e.getProps();e.force=i.sheetPhysics.getTargetForceClb(t.mass*e.getSize(),o?Math.PI-.02:.02),e.cornerForce=function(){return(o?-1:1)*_SheetPhysics2.default.hoverCornerForceClb()},i.sheetPhysics.setParametr(e.physicId,"angle",o?Math.PI-.01:.01),i.hoverInfo={n:r,block:e},i.update(1/30)}})}}else if(this.hoverInfo&&"mouseout"===e.type)void 0!==this.hoverInfo.pendings?--this.hoverInfo.pendings:r===this.hoverInfo.n&&this.clearHoverInfo();else if("mousedown"===e.type)this.cornerClickData={x:e.pageX,y:e.pageY};else if("click"===e.type){if(Math.sqrt(Math.pow(this.cornerClickData.x-e.pageX,2)+Math.pow(this.cornerClickData.y-e.pageY,2))<5){var d=this.getBlockByPage(r);if(d.physicId){var p=d.physicId,f=d.getProps();this.sheetPhysics.setParametr(p,"velocity",(o?-1:1)*f.startVelocity)}}delete this.cornerClickData}}},Book.prototype.addSheetBlock=function(e,t){this.sheetBlocks.splice(e,0,t),this.subscribeSheetBlock(t,2),this.threeSheetBlocks.add(t.three)},Book.prototype.subscribeSheetBlock=function(e,t){var i=this,n=new _CustomEventConverter2.default(this.visual.wnd,this.visual.doc,_CircleTarget2.default.test),o=new _CircleTarget2.default(.925,.075,.15);o.block=e,o.callback=this.cornerCallback.bind(this),n.addCustom(o),e.cornerTarget=o,e.three.userData.mouseCallback=function(o,r){var s=r.face.materialIndex;if(s<2){var a=0===s?t+2*e.p.first:t+2*e.p.last-1;n.convert(o,{x:0===s?r.uv.x:1-r.uv.x,y:r.uv.y,i:s,n:a}),i.pageManager.transferEventToTexture(a,o,r)}},e.three.userData.touchCallback=function(n,o){var r=o.face.materialIndex;if(r<2){var s=0===r?t+2*e.p.first:t+2*e.p.last-1;i.pageManager.transferEventToTexture(s,n,o)}},this.visual.drag.addThree(e.three),this.visual.mouseEvents.addThree(e.three),this.visual.touchEvents.addThree(e.three)},Book.prototype.removeSheetBlock=function(e){this.visual.mouseEvents.removeThree(e.three),this.visual.touchEvents.removeThree(e.three),this.visual.drag.removeThree(e.three),this.threeSheetBlocks.remove(e.three),e.dispose()},Book.prototype.removeSheetBlocks=function(e,t){var i=this.sheetBlocks.splice(e,t),n=Array.isArray(i),o=0;for(i=n?i:i[Symbol.iterator]();;){var r;if(n){if(o>=i.length)break;r=i[o++]}else{if((o=i.next()).done)break;r=o.value}var s=r;this.removeSheetBlock(s)}},Book.prototype.setTexture=function(e,t){this.pageManager.setTexture(e,t)},Book.prototype.setPageTexture=function(e,t){this.setTexture(e,t+2)},Book.prototype.setLeftCoverTexture=function(e,t){this.setTexture(e,t)},Book.prototype.setRightCoverTexture=function(e,t){this.setTexture(e,t+2*(this.p.sheets+1))},Book.finishAnimationClb=function(e){this.block.set(this.book.getClosedBlockAngle(e).closedAngle,"closed",0);var t=this.book.sheetBlocks.indexOf(this.block);~t&&(0===e?this.book.mergeSheetBlocks(t,this.book.sheetBlocks.length-t):this.book.mergeSheetBlocks(0,t+1))},Book.prototype.calcBlockForce=function(e,t,i,n,o){return e.force?e.force(t,i,n,o):0},Book.prototype.calcBlockCornerForce=function(e,t,i,n,o){return e.cornerForce?e.cornerForce(t,i,n,o):0},Book.prototype.setVisualMode=function(e){var t=Book.lightModes[this.p.lighting][e],i=[this.leftCover].concat(this.sheetBlocks,[this.rightCover]),n=Array.isArray(i),o=0;for(i=n?i:i[Symbol.iterator]();;){var r;if(n){if(o>=i.length)break;r=i[o++]}else{if((o=i.next()).done)break;r=o.value}var s=r;s.mesh.receiveShadow="live"===e;var a=s.materials,l=Array.isArray(a),h=0;for(a=l?a:a[Symbol.iterator]();;){var c;if(l){if(h>=a.length)break;c=a[h++]}else{if((h=a.next()).done)break;c=h.value}c.needsUpdate=!0}}this.visual.setLight(t.ambient,t.directional)},Book.prototype.notifyBeforeAnimation=function(){var e=this,t=void 0;return this.animationNotification?t=Promise.reject():(this.animationNotification=!0,this.dispatchEvent({type:"beforeAnimation"}),this.setVisualMode("live"),this.flipDisabled=!0,t=this.layerManager.hide().then(function(){return delete e.flipDisabled})),t},Book.prototype.notifyAfterAnimation=function(){if(this.animationNotification){var e=this.getPage();this.userDirection.lastTopPage!==e&&(this.userDirection.direction=Math.sign(e-this.userDirection.lastTopPage),this.userDirection.lastTopPage=e),delete this.animationNotification,this.setVisualMode("static"),this.layerManager.show(),this.dispatchEvent({type:"afterAnimation"})}},Book.prototype.getUserDirection=function(){return this.userDirection},Book.prototype.reducePagesWidth=function(e){var t=this.sheetBlocks,i=Array.isArray(t),n=0;for(t=i?t:t[Symbol.iterator]();;){var o;if(i){if(n>=t.length)break;o=t[n++]}else{if((n=t.next()).done)break;o=n.value}o.reduceWidth(e)}},Book.prototype.connectPhysics=function(e,t,i,n,o,r,s,a,l){var h=this,c=function(){return h.hoverInfo?"hover":h.dragInfo?"drag":"free"},u=this.sheetPhysics.getSize()?Promise.resolve():this.notifyBeforeAnimation();return e!==this.leftCover&&e!==this.rightCover||(this.bookShadowMaterial.opacity=0),u.then(function(){return e.physicId=h.sheetPhysics.addObject(t,i,n,o,r,function(t,n){s(t,n),l(e,Math.abs(i-t)/Math.PI,"process",c()),h.calculateShadow(),h.updateThree()},function(t,n){if(a(t,n),delete e.physicId,l(e,Math.abs(i-t)/Math.PI,"finish",c()),!h.sheetPhysics.getSize()){var o=h.getPage();0!==o&&o!==h.getPages()-1||h.reducePagesWidth(!0)}Promise.resolve().then(function(){h.sheetPhysics.getSize()||(h.notifyAfterAnimation(),h.calculateShadow())}),h.updateThree()},function(t,i,n,o){return h.calcBlockForce(e,t,i,n,o)},function(t,i,n,o){return h.calcBlockCornerForce(e,t,i,n,o)}),l(e,0,"init",c()),1===h.sheetPhysics.getSize()&&h.reducePagesWidth(!1),e}).catch(function(){})},Book.prototype.update=function(e){var t=this;this.lastMousePos.t+=e,this.isProcessing()&&void 0!==this.lastMousePos.pageX&&this.lastMousePos.t-(this.lastMousePos.lastT||0)>.25&&!this.hoverInfo&&!this.dragInfo&&(this.lastMousePos.lastT=this.lastMousePos.t,Promise.resolve().then(function(){(0,_libs.$)(t.visual.element).trigger(_libs.$.Event("mousemove",t.lastMousePos))})),this.sheetPhysics.simulate(e)},Book.prototype.splitSheetBlock=function(e,t){var i=this.sheetBlocks[e];if(i&&t<i.getSize()){var n=new _SheetBlock2.default(this.visual,_extends({},this.p,{setTexture:this.setPageTexture.bind(this)}),i.p.first,i.p.first+t,i.angle,i.state);return i.set(i.angle,i.state,i.corner.height,i.p.first+t,i.p.last),this.addSheetBlock(e,n),[n,i]}},Book.prototype.mergeSheetBlocks=function(e,t){if(e<this.sheetBlocks.length){t=Math.min(this.sheetBlocks.length-e,t);var i=this.sheetBlocks[e],n=this.sheetBlocks[e+t-1];i.set(i.angle,i.state,i.corner.height,i.p.first,n.p.last),this.removeSheetBlocks(e+1,t-1)}},Book.prototype.setSheetBlocks=function(e,t){"closed"===t&&(this.closedAngle=e),this.sheetBlocks.forEach(function(i){i.physicId||i.set(e,t)})},Book.prototype.set=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.angle=e;var i=Math.PI;if(e<i/4)this.binder.set(0),this.binder.setLeft(-i/2+2*e),this.leftCover.set(i/2,"opened",t),this.setSheetBlocks(0,"closed"),this.binder.setRight(0),this.rightCover.set(0,"closed",0);else if(e<2*i/4){var n=2*(e-i/4);this.binder.set(n),this.binder.setLeft(-n),this.leftCover.set(i/2+n,"opened",t),this.setSheetBlocks(n,"closed"),this.binder.setRight(-n),this.rightCover.set(n,"closed",0)}else if(e<3*i/4){var o=2*(e-i/2);this.binder.set(i/2),this.binder.setLeft(-i/2),this.leftCover.set(i,"opened",0),this.binder.setRight(-i/2),this.rightCover.set(o,"opened",t)}else if(e<4*i/4){var r=2*(e-3*i/4)+i/2;this.binder.set(r),this.binder.setLeft(-r),this.leftCover.set(r,"closed",0),this.setSheetBlocks(r,"closed"),this.binder.setRight(-i/2),this.rightCover.set(i/2,"opened",t)}else if(e<5*i/4)this.binder.set(i),this.binder.setLeft(-i),this.leftCover.set(i,"closed",0),this.setSheetBlocks(i,"closed"),this.binder.setRight(-i/2-2*(e-i)),this.rightCover.set(i/2,"opened",t);else if(e<6*i/4){var s=2*(e-5*i/4);this.binder.set(i-s),this.binder.setLeft(-i+s),this.leftCover.set(i-s,"closed",0),this.setSheetBlocks(i-s,"closed"),this.binder.setRight(-i+s),this.rightCover.set(i/2-s,"opened",t)}else if(e<7*i/4){var a=2*(e-6*i/4);this.binder.set(i/2),this.binder.setLeft(-i/2),this.leftCover.set(i-a,"opened",t),this.binder.setRight(-i/2),this.rightCover.set(0,"opened",0)}else if(e<8*i/4){var l=2*(e-7*i/4);this.binder.set(i/2-l),this.binder.setLeft(-i/2),this.leftCover.set(i/2,"opened",t),this.setSheetBlocks(i/2-l,"closed"),this.binder.setRight(-i/2+l),this.rightCover.set(i/2-l,"closed",0)}},Book.createSideTexture=function(e,t){var i=_GraphUtils2.default.createCanvas(8,8);if("color"===t){var n=i.getContext("2d");n.beginPath(),n.fillStyle=_GraphUtils2.default.color2Rgba(e,1),n.rect(0,0,8,7),n.fill(),n.beginPath(),n.fillStyle=_GraphUtils2.default.color2Rgba(_GraphUtils2.default.inverseColor(e,.5),1),n.rect(0,7,8,1),n.fill()}return i},Book.prototype.prepareProps=function(e){return this.calcProps(Book.mergeProps((0,_book.props)(),e))},Book.mergeProps=function(e,t){return _extends({},e,t=t||{},{sheet:_extends({},e.sheet,t.sheet),cover:_extends({},e.cover,t.cover),page:_extends({},e.page,t.page),cssLayerProps:_extends({},e.cssLayerProps,t.cssLayerProps)})},Book.prototype.calcProps=function(e){var t=e.maxDepth/(e.sheets+6),i=_extends({},e,{sheet:_extends({},e.sheet),cover:_extends({},e.sheet,e.cover),page:_extends({},e.sheet,e.page),cssLayerProps:_extends({},e.cssLayerProps,{$:_libs.$})});i.cover.depth=Math.min(i.cover.depth,3*t),i.page.depth=Math.min(i.page.depth,t);var n=10*i.height,o=10*i.width,r=Math.min(n,o)/o,s={sideTexture:i.sheet.sideTexture||Book.createSideTexture(i.sheet.color,i.sheet.side)},a=_extends({},s,i.cover,{flexibleCorner:r*i.cover.flexibleCorner,depth:10*i.cover.depth,width:o,height:n,padding:10*i.cover.padding}),l=_extends({},s,i.page,{flexibleCorner:r*i.page.flexibleCorner,depth:10*i.page.depth,width:a.width-a.padding,height:a.height-2*a.padding});return a.color===s.color||i.cover.sideTexture||(a.sideTexture=Book.createSideTexture(a.color,a.side)),l.color===s.color||i.page.sideTexture||(l.sideTexture=Book.createSideTexture(l.color,l.side)),i.cssLayersLoader&&(i.cssLayersLoader=this.cssLayersLoader(i.cssLayersLoader)),_extends({},i,{scale:10,height:n,width:o,flipProgressClb:function(){},cover:a,page:l,marker:{use:!1,color:16711680,size:.01}})},Book.prototype.cssLayersLoader=function(e){var t=this;return function(i,n){return e(i,function(e){var i=[],o=e,r=Array.isArray(o),s=0;for(o=r?o:o[Symbol.iterator]();;){var a;if(r){if(s>=o.length)break;a=o[s++]}else{if((s=o.next()).done)break;a=s.value}var l=a;i.push(_extends({},l,{js:t.cssLayerJsObject(l)}))}return n(i)})}},Book.prototype.cssLayerJsObject=function cssLayerJsObject(l){var _this10=this,clIfEx=function(e){var t=void 0;if(e)try{t=e()}catch(e){console.error(e)}return t};return function(c,p){var o={};try{var init=eval(l.js);o=init&&init(c,p)||{}}catch(e){console.error(e)}for(var no=_this10.cssLayerJsObjectInit(c,p),ro={},_arr=["hide","hidden","show","shown","dispose"],_loop=function(){var e=_arr[_i10];ro[e]=function(){clIfEx(no[e]),clIfEx(o[e])}},_i10=0;_i10<_arr.length;_i10++)_loop();return ro}},Book.prototype.cssLayerJsObjectInit=function(e,t){var i=this;e.find(".go-to-page").on("click",function(e){for(var i=(0,_libs.$)(e.target);i.length&&!i.hasClass("go-to-page");)i=(0,_libs.$)(i[0].parentNode);i=parseInt(i.attr("data-number")),isNaN(i)||(e.preventDefault(),t.scene.ctrl.goToPage(i-1))});var n=e.find(".youtube");if(n.length){n.html('<div style="width:100%;height:100%;"></div>');var o=function(e,t,i){return void 0===e.attr(t)?i:"true"===e.attr(t)?1:0};_YouTubeApi2.default.init().then(function(){for(var e=0;e<n.length;++e){var t=(0,_libs.$)(n[e]),i={loop:o(t,"data-loop",0),controls:o(t,"data-controls",1),mute:o(t,"data-muted",0)};i.loop&&(i.playlist=t.attr("data-id"));var r=new YT.Player(t.find("div")[0],{videoId:t.attr("data-id"),playerVars:i});t[0].player=r}})}var r=e.find(".adsbygoogle");if(r.length&&!this.visual.wnd.adsbygoogle){this.visual.wnd.adsbygoogle=[];var s=this.visual.doc.createElement("script");s.async=!0,s.src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client="+r.attr("data-ad-client"),this.visual.doc.body.appendChild(s)}return{hide:function(){i.pendingPlayers.length&&(i.pendingPlayers=[],i.dispatchEvent({type:"pendingPlayers"})),e.find(".pause-on-hide").each(function(e,t){return i.cssFs.pause(t)})},shown:function(){e.find(".play-on-shown").each(function(e,t){return i.cssFs.play(t)}),setTimeout(function(){var t=!1;if(e.find(".adsbygoogle").each(function(e,i){return t=t||""===(0,_libs.$)(i).html().trim()}),t)try{i.visual.wnd.adsbygoogle.push({})}catch(e){console.error(e)}},100)},dispose:function(){return e.find(".pause-on-hide").each(function(e,t){return i.cssFs.pause(t)})}}},Book}(_libs.THREE.EventDispatcher);Book.lightModes={ambient:{static:{ambient:16777215,directional:0},live:{ambient:16316664,directional:986895}},mixed:{static:{ambient:15790320,directional:1052688},live:{ambient:15790320,directional:1052688}}},exports.default=Book},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},s=i(1),a=n(i(15)),l=i(45),h=n(i(52)),c=n(i(75)),u=n(i(58)),d=n(i(18)),p=function(e){function t(i,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this));r.navigationControls=!0,r.book=i,r.visual=i.visual,r.p=t.prepareProps(o),r.p.rtl=i.p.rtl,r.orbit=i.visual.getOrbit(),i.setFlipProgressClb(r.updateViewIfState.bind(r)),r.view=n,r.bindActions(),r.state={smartPan:!r.actions.cmdSmartPan.active,singlePage:!!r.isSinglePageAvailable()&&(r.actions.cmdSinglePage.active||r.actions.cmdSinglePage.activeForMobile&&r.visual.isMobile()),stats:r.actions.cmdStats.active,activeSide:1,autoPlay:r.actions.cmdAutoPlay.active};var a=new s.THREE.Box3,l=new s.THREE.Box3,h=i.openedBox.max.x-i.openedBox.min.x;return r.bookWatcher=new u.default(r.visual,function(){if(r.state.singlePage)r.state.activeSide?a.setFromObject(i.rightCover.three):a.setFromObject(i.leftCover.three);else{a.setFromObject(i.leftCover.three),l.setFromObject(i.rightCover.three),a.union(l);var e=Math.max(a.min.x-a.min.x,h),t=(a.min.x+a.max.x)/2;a.min.x=t-.5*e,a.max.x=t+.5*e}return a}),r.bookWatcher.scale=r.p.scale.default,r.book.setZoom(r.bookWatcher.scale,r.state.singlePage),r.Stats=new c.default,r.Stats.domElement.style.position="absolute",r.Stats.domElement.style.top="0px",r.binds={onScreenModeChanged:r.onScreenModeChanged.bind(r),stats:r.Stats.update.bind(r.Stats),onUpdateView:r.updateView.bind(r)},d.default.addEventListener(r.view.getParentContainer().ownerDocument,r.binds.onScreenModeChanged),r.cmdSmartPan(),r.book.enableLoadingAnimation(r.p.loadingAnimation.book),r.p.loadingAnimation.skin&&r.initLoadingAnimation(),r.book.enableLoadingAnimation(r.p.loadingAnimation.book),r.book.setAutoResolution(r.p.autoResolution),r.visual.addEventListener("resize",r.updateView.bind(r)),r.book.addEventListener("pendingPlayers",r.updateView.bind(r)),r.state.autoPlay&&r.autoPlay(),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.dispose=function(){d.default.removeEventListener(this.view.getParentContainer().ownerDocument,this.binds.onScreenModeChanged),delete this.book,delete this.view,delete this.visual},t.prototype.ready=function(e){var t=this;this.view.templateObject.appLoaded&&Promise.resolve().then(function(){return t.view.templateObject.appLoaded(e)})},t.prototype.loadingAnimationHandler=function(){var e=this,t=this.book.getTopPages(),i=!1,n=t,o=Array.isArray(n),r=0;for(n=o?n:n[Symbol.iterator]();;){var s;if(o){if(r>=n.length)break;s=n[r++]}else{if((r=n.next()).done)break;s=r.value}var a=s,l=this.book.getPageState(a);if(i="active"!==l)break}(i=i||this.printer&&this.printer.loading)?this.pendingLoadingAnimation||(this.pendingLoadingAnimation=!0,setTimeout(function(){e.pendingLoadingAnimation&&e.view&&e.view.setState("widLoading",{visible:i})},2e3)):(delete this.pendingLoadingAnimation,this.view.setState("widLoading",{visible:i}))},t.prototype.initLoadingAnimation=function(){var e=this.loadingAnimationHandler.bind(this);this.book.addEventListener("beforeAnimation",e),this.book.addEventListener("afterAnimation",e),this.book.addEventListener("startRendering",e),this.book.addEventListener("endRendering",e)},t.prototype.enableNavigation=function(e){this.navigationControls=e},t.prototype.setTocCtrl=function(e){this.tocCtrl=e,this.tocCtrl.onChange=this.updateView.bind(this),this.tocCtrl.setActiveTab(this.actions.cmdToc.defaultTab),this.actions.cmdToc.active&&!e.visible&&e.togle()},t.prototype.setShareCtrl=function(e){this.shareCtrl=e,this.shareCtrl.onChange=this.updateView.bind(this),this.updateView()},t.prototype.setPrinter=function(e){this.printer=e;var t=this.loadingAnimationHandler.bind(this);this.printer.addEventListener("loading",t),this.printer.addEventListener("loaded",t),this.updateView()},t.prototype.setSounds=function(e){this.sounds=e,e.setEnabled(this.actions.cmdSounds.active),this.updateView()},t.prototype.onScreenModeChanged=function(e){this.updateView()},t.prototype.canZoomIn=function(){return!this.state.smartPan||Math.abs(this.bookWatcher.scale-this.p.scale.max)>this.p.eps},t.prototype.canZoomOut=function(){return!this.state.smartPan||Math.abs(this.bookWatcher.scale-this.p.scale.min)>this.p.eps},t.prototype.canDefaultZoom=function(){return this.state.smartPan},t.prototype.setBookZoom=function(e){this.book.setZoom(e,this.state.singlePage)},t.prototype.cmdAutoPlay=function(){this.state.autoPlay=!this.state.autoPlay,this.state.autoPlay&&this.autoPlay(),this.updateView()},t.prototype.autoPlay=function(){var e=this,t=Date.now();this.pendingAutoPlay=t,setTimeout(function(){if(e.pendingAutoPlay===t&&e.state.autoPlay){if(!e.book.isProcessing()){var i=void 0;e.p.rtl?(i=e.canFlipLeft())&&e.cmdBackward():(i=e.canFlipRight())&&e.cmdForward(),i||e.goToPage(0)}e.autoPlay()}},this.book.p.autoPlayDuration)},t.prototype.cmdZoomIn=function(){this.state.smartPan?(this.bookWatcher.scale=Math.min(this.p.scale.max,this.bookWatcher.scale+this.p.scale.delta),this.setBookZoom(this.bookWatcher.scale)):this.orbit.zoomIn(6.6*this.p.scale.delta/.32),this.updateView()},t.prototype.cmdZoomOut=function(){this.state.smartPan?(this.bookWatcher.scale=Math.max(this.p.scale.min,this.bookWatcher.scale-this.p.scale.delta),this.setBookZoom(this.bookWatcher.scale)):this.orbit.zoomOut(6.6*this.p.scale.delta/.32),this.updateView()},t.prototype.setScale=function(e){this.bookWatcher.scale=Math.min(this.p.scale.max,Math.max(this.p.scale.min,e)),this.setBookZoom(this.bookWatcher.scale),this.updateView()},t.prototype.cmdDefaultZoom=function(){this.state.smartPan&&(this.bookWatcher.scale=this.p.scale.default,this.setBookZoom(this.bookWatcher.scale),this.updateView())},t.prototype.cmdToc=function(){this.tocCtrl&&this.tocCtrl.togle()},t.prototype.cmdShare=function(){this.shareCtrl&&this.shareCtrl.togle()},t.prototype.cmdBackward=function(){var e=this;this.canFlipLeft()&&(this.state.singlePage?(this.state.activeSide=(this.getPage()+1)%2,this.state.activeSide?(this.state.activeSide=0,this.updateView()):this.startFlip(this.book.flipLeft(1)).then(function(t){t&&(e.state.activeSide=1)})):this.startFlip(this.book.flipLeft(1)))},t.prototype.cmdBigBackward=function(){this.cmdBackward()},t.prototype.cmdForward=function(){var e=this;this.canFlipRight()&&(this.state.singlePage?(this.state.activeSide=(this.getPage()+1)%2,this.state.activeSide?this.startFlip(this.book.flipRight(1)).then(function(t){t&&(e.state.activeSide=0)}):(this.state.activeSide=1,this.updateView())):this.startFlip(this.book.flipRight(1)))},t.prototype.cmdBigForward=function(){this.cmdForward()},t.prototype.cmdSave=function(){var e=(0,s.$)('<a href="'+this.p.downloadURL+'" download target="_blank"></a>').appendTo(this.view.getContainer());e[0].click(),e.remove()},t.prototype.cmdPrint=function(){this.printer.print()},t.prototype.cmdFullScreen=function(){d.default.activated()?d.default.cancel():d.default.request(this.view.getParentContainer())},t.prototype.cmdSmartPan=function(){this.state.smartPan=!this.state.smartPan,this.state.smartPan?(this.orbit.minAzimuthAngle=0,this.orbit.maxAzimuthAngle=0,this.orbit.minPolarAngle=0,this.orbit.maxPolarAngle=Math.PI/4,this.bookWatcher.enabled=!0):(this.orbit.minAzimuthAngle=-1/0,this.orbit.maxAzimuthAngle=1/0,this.orbit.minPolarAngle=0,this.orbit.maxPolarAngle=Math.PI,this.bookWatcher.enabled=!1),this.updateView()},t.prototype.isSinglePageAvailable=function(){return 2!==this.book.getPages()},t.prototype.cmdSinglePage=function(){this.isSinglePageAvailable()&&(this.state.singlePage=!this.state.singlePage,this.setBookZoom(this.bookWatcher.scale),this.updateView(),this.dispatchAsync({type:"pageMode",value:this.state.singlePage?"single":"double"}))},t.prototype.cmdSounds=function(){this.sounds&&this.sounds.togle(),this.updateView()},t.prototype.cmdStats=function(){this.state.stats=!this.state.stats,this.state.stats?((0,s.$)(this.view.getContainer()).append(this.Stats.domElement),this.visual.addRenderCallback(this.binds.stats)):((0,s.$)(this.view.getContainer()).find(this.Stats.domElement).remove(),this.visual.removeRenderCallback(this.binds.stats)),this.updateView()},t.prototype.cmdPendingPlay=function(){this.book.resolvePendingPlayers()},t.prototype.cmdGotoFirstPage=function(){this.goToPage(0)},t.prototype.cmdGotoLastPage=function(){this.goToPage(this.book.getBookPages()-1)},t.prototype.goToPage=function(e){var t=this;e=Math.max(Math.min(e,this.book.getPages()-1),0),this.p.rtl&&(e=this.book.getBookPages()-1-e);var i=Math.max(Math.min(e,this.book.getBookPages()-1),0);this.state.activeSide=(i+1)%2;var n=Math.max(Math.min(e-1+e%2,this.book.getBookPages()-1),0),o=this.book.getPage(),r=[],s=0;if(n!=o){0===o?(r.push(1),o+=1,++s):o===this.book.getBookPages()-1&&(r.push(-1),o-=2,++s);var a=0;0===n?(a=-1,n+=1,++s):n===this.book.getBookPages()-1&&(a=1,n-=2,++s),n-o&&r.push(Math.ceil((n-o)/2)),a&&r.push(a)}var l=function(e,i,n){return new Promise(function(o){setTimeout(function(){e<0?t.startFlip(t.book.flipLeft(-e,n)):t.startFlip(t.book.flipRight(e,n)),o()},i)})};if(2===s)l(r[0],0,function(e,t,i){"finish"==i&&1==t&&l(r[r.length-1],0)}).then(function(){return l(r[1],400)});else{var h=Promise.resolve(),c=0,u=r,d=Array.isArray(u),p=0;for(u=d?u:u[Symbol.iterator]();;){var f;if("break"===function(){if(d){if(p>=u.length)return"break";f=u[p++]}else{if((p=u.next()).done)return"break";f=p.value}var e=f,t=c;h=h.then(function(){return l(e,t)}),c=400}())break}}},t.prototype.startFlip=function(e){var t=this;return e?e.then(function(e){return e&&t.dispatchAsync({type:"startFlip"}),e}):Promise.resolve(void 0)},t.prototype.endFlip=function(e){return this.dispatchAsync({type:"endFlip"}),e},t.prototype.getPage=function(){return this.book.getPage()?Math.min(this.book.getPage()+this.state.activeSide,this.book.getBookPages()-1):0},t.prototype.getPageForGUI=function(){var e=(this.state.singlePage?this.getPage():this.book.getPage())+1;return this.p.rtl&&(e=this.book.getBookPages()-e+1),e>this.book.getPages()&&(e=this.book.getPages()),e},t.prototype.inpPage=function(e,t){this.goToPage(t-1)},t.prototype.updateViewIfState=function(e,t,i,n){"init"!==i&&"finish"!==i||setTimeout(this.updateView.bind(this),100),"finish"===i&&this.endFlip(e)},t.prototype.isCmdVisible=function(e){return(0,s.$)(this.visual.element).width()<this.p.narrowView.width?void 0===this.actions[e].enabledInNarrow?this.actions[e].enabled:this.actions[e].enabledInNarrow:this.actions[e].enabled},t.prototype.updateViewState=function(){this.viewState={cmdZoomIn:{enable:this.canZoomIn(),visible:this.isCmdVisible("cmdZoomIn"),active:!1},cmdZoomOut:{enable:this.canZoomOut(),visible:this.isCmdVisible("cmdZoomOut"),active:!1},cmdDefaultZoom:{enable:this.canDefaultZoom(),visible:this.isCmdVisible("cmdDefaultZoom"),active:this.canDefaultZoom()&&Math.abs(this.bookWatcher.scale-this.p.scale.default)<this.p.eps},cmdToc:{enable:!!this.tocCtrl,visible:this.isCmdVisible("cmdToc")&&this.tocCtrl,active:this.tocCtrl&&this.tocCtrl.visible},cmdShare:{enable:!!this.shareCtrl,visible:this.isCmdVisible("cmdShare")&&this.shareCtrl,active:this.shareCtrl&&this.shareCtrl.visible},inpPages:{visible:!0,value:this.book.getPages()},inpPage:{visible:!0,enable:!this.book.isProcessing()&&this.navigationControls,value:this.getPageForGUI()},cmdSave:{enable:!0,visible:this.isCmdVisible("cmdSave")&&!!this.p.downloadURL,active:!1},cmdPrint:{enable:!0,visible:this.isCmdVisible("cmdPrint")&&!!this.printer,active:!1},cmdFullScreen:{enable:d.default.available(),visible:this.isCmdVisible("cmdFullScreen"),active:d.default.available()&&d.default.activated()},widControls:{enable:!0,visible:!0,active:!1},widSettings:{enable:!0,visible:this.isCmdVisible("widSettings"),active:!1},widToolbar:{enable:!0,visible:this.isCmdVisible("widToolbar"),active:!1},cmdSmartPan:{enable:!0,visible:this.isCmdVisible("cmdSmartPan"),active:this.state.smartPan},cmdSinglePage:{enable:this.isSinglePageAvailable(),visible:this.isCmdVisible("cmdSinglePage"),active:this.state.singlePage},cmdSounds:{enable:!0,visible:this.isCmdVisible("cmdSounds")&&!!this.sounds,active:!!this.sounds&&this.sounds.enabled},cmdStats:{enable:!0,visible:this.isCmdVisible("cmdStats"),active:this.state.stats},cmdAutoPlay:{enable:!0,visible:this.isCmdVisible("cmdAutoPlay"),active:this.state.autoPlay},cmdPendingPlay:{enable:!0,visible:!0,active:!1},widPendingPlay:{enable:!0,visible:this.book.hasPendingPlayers(),active:!1}};var e=this.canFlipLeft(),t=this.canFlipRight(),i={cmdBackward:e,cmdBigBackward:e,cmdForward:t,cmdBigForward:t,cmdGotoFirstPage:e,cmdGotoLastPage:t},n=Object.keys(i),o=Array.isArray(n),r=0;for(n=o?n:n[Symbol.iterator]();;){var s;if(o){if(r>=n.length)break;s=n[r++]}else{if((r=n.next()).done)break;s=r.value}var a=s;this.viewState[a]={enable:i[a],visible:this.isCmdVisible(a),active:!1}}},t.prototype.canFlipLeft=function(){return this.navigationControls&&(!!this.book.getLeftFlipping()||this.state.singlePage&&this.p.rtl&&2===this.getPage())},t.prototype.canFlipRight=function(){return this.navigationControls&&(!!this.book.getRightFlipping()||this.state.singlePage&&!this.p.rtl&&this.getPage()===this.book.getPages()-2)},t.prototype.updateView=function(){if(this.view){this.updateViewState();var e=Object.keys(this.viewState),t=Array.isArray(e),i=0;for(e=t?e:e[Symbol.iterator]();;){var n;if(t){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}var o=n;this.view.setState(o,this.viewState[o])}}},t.prototype.getActions=function(){var e=this,t=function(t){return e.actions.touchCmdSwipe.enabled&&e.actions.touchCmdSwipe.code===e.actions[t].code&&e.state.smartPan&&e.bookWatcher.scale<=1},i={};for(var n in this)!function(t){0===t.indexOf("cmd")&&(i[t]={activate:function(){e.viewState&&e.viewState[t].enable&&e[t].apply(e,arguments)}})}(n);return r({},i,{cmdPanLeft:{activate:function(t){return e.orbit.actions.pan(t,{state:"move",dx:-e.p.pan.speed,dy:0})}},cmdPanRight:{activate:function(t){return e.orbit.actions.pan(t,{state:"move",dx:e.p.pan.speed,dy:0})}},cmdPanUp:{activate:function(t){return e.orbit.actions.pan(t,{state:"move",dx:0,dy:-e.p.pan.speed})}},cmdPanDown:{activate:function(t){return e.orbit.actions.pan(t,{state:"move",dx:0,dy:e.p.pan.speed})}},mouseCmdRotate:{activate:this.orbit.actions.rotate},mouseCmdDragZoom:{activate:function(t,i){i.dy>0?e.cmdZoomOut():i.dy<0&&e.cmdZoomIn()}},mouseCmdPan:{activate:this.orbit.actions.pan},mouseCmdWheelZoom:{activate:function(t){var i=e.bookWatcher.scale;t.deltaY<0?e.cmdZoomOut():t.deltaY>0&&e.cmdZoomIn(),(!e.state.smartPan||Math.abs(e.bookWatcher.scale-i)>1e-4)&&t.preventDefault()}},touchCmdRotate:{activate:function(i,n){t("touchCmdRotate")||("move"===n.state&&i.preventDefault(),e.orbit.actions.rotate(i,n))}},touchCmdZoom:{activate:function(i,n){if(!t("touchCmdZoom")){var o=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)};"start"===n.state?e.touchZoomData={l:o(n),scale:e.bookWatcher.scale}:"move"===n.state&&(i.preventDefault(),e.setScale(o(n)/e.touchZoomData.l*e.touchZoomData.scale))}}},touchCmdPan:{activate:function(i,n){t("touchCmdPan")||"move"===n.state&&(!e.state.smartPan||e.bookWatcher.scale>1)&&(i.preventDefault(),e.orbit.actions.pan(i,n))}},touchCmdSwipe:{activate:function(i,n){if(t("touchCmdSwipe"))if("start"===n.state){var o=(i.touches||i.originalEvent.touches)[e.actions.touchCmdSwipe.code-1];e.swipeData={handled:!1,x0:o.pageX,y0:o.pageY,x:o.pageX,y:o.pageY}}else"move"===n.state?e.swipeData.handled||(e.swipeData=r({},e.swipeData,{x:e.swipeData.x+n.dx,y:e.swipeData.y+n.dy}),Math.abs(e.swipeData.x0-e.swipeData.x)>100&&(e.swipeData.x0>e.swipeData.x?e.cmdForward():e.cmdBackward(),e.swipeData.handled=!0)):delete e.swipeData}},widSettings:{activate:function(){}},widToolbar:{activate:function(){}}})},t.prototype.bindActions=function(){var e=this;this.eToA=new h.default((0,s.$)(this.visual.element)),this.eToA.addAction(function(e){return e.preventDefault()},"contextmenu",h.default.mouseButtons.Right,0),this.eToA.addAction(function(t){return(0,s.$)(e.view.getParentContainer()).trigger(t)},"keydown",27,0),this.actions=this.getActions();var t=Object.keys(this.actions),i=Array.isArray(t),n=0;for(t=i?t:t[Symbol.iterator]();;){var o;if(i){if(n>=t.length)break;o=t[n++]}else{if((n=t.next()).done)break;o=n.value}var a=o,l=r({},this.actions[a],this.p.actions[a]);if(this.actions[a]=l,0!==a.indexOf("mouseCmd")&&0!==a.indexOf("touchCmd")||l.enabled){var c=l.flags||0;l.type?this.eToA.addAction(l.activate,l.type,l.code,c):void 0!==l.code&&this.eToA.addAction(l.activate,"keydown",l.code,c)}}},t.prepareProps=function(e){return t.calcProps(t.mergeProps((0,l.props)(),e))},t.setActions=function(e,t){var i=Object.keys(t||{}),n=Array.isArray(i),o=0;for(i=n?i:i[Symbol.iterator]();;){var s;if(n){if(o>=i.length)break;s=i[o++]}else{if((o=i.next()).done)break;s=o.value}var a=s;e.actions[a]=r({},e.actions[a],t[a])}},t.mergeProps=function(e,i){var n=function e(t,i){var n=r({},t,i=i||{}),s=Object.keys(t),a=Array.isArray(s),l=0;for(s=a?s:s[Symbol.iterator]();;){var h;if(a){if(l>=s.length)break;h=s[l++]}else{if((l=s.next()).done)break;h=l.value}var c=h;"object"===o(t[c])&&(n[c]=e(t[c],i[c]))}return n}(e,i=i||{});return t.setActions(n,e.actions),t.setActions(n,i.actions),n},t.calcProps=function(e){return e.scale.delta=(e.scale.max-e.scale.min)/e.scale.levels,e},t}(a.default);t.default=p},function(e,t,i){"use strict";t.__esModule=!0;var n=i(1),o=function(e){function t(i,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this));r.book=n,r.styleSheet=o,r.wnd=i.wnd,r.doc=i.doc,r.pageCallback=n.getPageCallback();var s=r.pageCallback(0);return r.type=s.type,"pdf"===r.type&&(r.pdfSrc=s.src.src),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.cancel=function(){this.canceled=!0},t.prototype.dispose=function(){this.frame&&(this.frame.remove(),delete this.frame)},t.prototype.print=function(){var e=this;if(!this.loading)if(delete this.canceled,"pdf"===this.type){var t=void 0,i=!1;this.useIFrame()?(i=!!this.frame,this.frame||(this.frame=(0,n.$)('<iframe src="'+this.pdfSrc+'" style="display: none;"></iframe>').appendTo(document.body)),t=this.frame[0].contentWindow):t=this.wnd.open(this.pdfSrc),i?t.print():(this.loading=!0,this.dispatchEvent({type:"loading"}),(0,n.$)(this.frame).on("load",function(){setTimeout(function(){delete e.loading,e.dispatchEvent({type:"loaded"});try{t.print()}catch(e){console.error(e)}},1e3)}))}else this.renderContent().then(function(t){var i=e.wnd.open().document,n=('\n            <!DOCTYPE html>\n            <html>\n              <head>\n                <meta charset="utf-8">\n                <title>3D FlipBook - Printing</title>\n                '+t.head+'\n                <script type="text/javascript">\n                  function printDocument() {\n                    window.print();\n                    window.close();\n                  }\n                  function init() {\n                    setTimeout(printDocument, 100);\n                  }\n                <\/script>\n              </head>\n              <body onload="init()">\n                '+t.body+"\n              </body>\n            </html>\n          ").fb3dQFilter();i.open(),i.write(n),i.close()}).catch(function(e){return console.warn("3D FlipBook - Printing was canceled")})},t.prototype.progress=function(e){if(this.canceled)throw"Cancel Printing";this.onProgress&&this.onProgress(Math.floor(100*e))},t.prototype.renderContent=function(){for(var e=this,t=this.book.getPages(),i=new Set,n=[],o=Promise.resolve(),r=0;r<t;++r)!function(r){var s=e.pageCallback(r);"image"===s.type?o=o.then(function(){return e.progress(r/t),e.renderImage(i,n,s.src)}):"html"===s.type&&(o=o.then(function(){return e.progress(r/t),e.renderHtml(i,n,s.src)}))}(r);return o.then(function(){return e.progress(1),{head:e.renderHead(i),body:n.join("\n")}})},t.wrap=function(e){return'<div class="fb3d-printer-page">'+e+"</div>"},t.prototype.renderImage=function(e,i,n){i.push(t.wrap('<img src="'+n+'" />'))},t.prototype.renderHtml=function(e,i,o){return new Promise(function(r,s){n.$.get(o,function(n){var o=n.match(/<link.*?>/gi)||[],s=Array.isArray(o),a=0;for(o=s?o:o[Symbol.iterator]();;){var l;if(s){if(a>=o.length)break;l=o[a++]}else{if((a=o.next()).done)break;l=a.value}var h=l;if(h.match(/stylesheet/i)){var c=h.match(/href\s*=\s*['"](.*)['"]/i);c&&e.add(c[1])}}var u=n.match(/<body.*?>([\S\s]*)<\/body>/i);u&&i.push(t.wrap(u[1])),r()}).fail(function(e){console.error(e.responseText),s()})})},t.prototype.renderHead=function(e){var i=[];return e.forEach(function(e){return i.push('<link rel="stylesheet" href="'+e+'">')}),i.push(this.styleSheet?'<link rel="stylesheet" href="'+this.styleSheet+'">':t.defaultStyleSheet()),i.join("\n")},t.prototype.useIFrame=function(){this.wnd.chrome;var e=this.wnd.navigator;return e.vendor,e.userAgent.indexOf("Edge"),e.userAgent.match("CriOS"),!0},t.defaultStyleSheet=function(){return'\n      <style type="text/css">\n        body {\n          margin: 0;\n          padding: 0;\n        }\n        .fb3d-printer-page {\n          page-break-after: always;\n        }\n      </style>\n    '.fb3dQFilter()},t}(n.THREE.EventDispatcher);t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var n,o=function(e){function t(i,n,o,r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,i,n,o,r))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.initView=function(){this.view=this.container.find(".view"),this.bookmarksView=this.container.find(".widBookmarks"),this.thumbnailsView=this.container.find(".widThumbnails"),this.searchView=this.container.find(".widSearch")},t.prototype.getHandlers=function(i){var n=this;return"inpPage"===i?[{inpPage:function(o,r){return n.callLater(e.prototype.getHandlers.call(n,i),i,o,r,t.PAGE_HANDLER_DELAY)}}]:e.prototype.getHandlers.call(this,i)},t.prototype.onItemStateChanged=function(e,t){"cmdFullScreen"===e&&(t.active?this.parentContainer.addClass("fullscreen"):this.parentContainer.removeClass("fullscreen"))},t.prototype.getView=function(){return this.view},t.prototype.getBookmarksView=function(){return this.bookmarksView},t.prototype.getThumbnailsView=function(){return this.thumbnailsView},t.prototype.getSearchView=function(){return this.searchView},t.prototype.getForms=function(){return[]},t.prototype.getLinks=function(){return["cmdZoomIn","cmdZoomOut","cmdDefaultZoom","cmdToc","cmdBackward","cmdBigBackward","cmdForward","cmdBigForward","cmdSave","cmdPrint","cmdFullScreen","cmdSmartPan","cmdSinglePage","cmdSounds","cmdStats","cmdShare","cmdCloseToc","cmdCloseShare","cmdBookmarks","cmdSearch","cmdThumbnails","cmdPendingPlay","cmdFacebook","cmdTwitter","cmdEmail","cmdAutoPlay","cmdGotoFirstPage","cmdGotoLastPage"]},t.prototype.getWidgets=function(){return["widLoadingProgress","widUserMessage","widFloatWnd","widShare","widTocMenu","widBookmarks","widThumbnails","widSearch","widControls","widSettings","widLoading","widPendingPlay","widToolbar"]},t.prototype.getInputs=function(){return["inpPage","inpPages"]},t.prototype.getTexts=function(){return["txtLoadingProgress","txtUserMessage","txtShareLink"]},t.prototype.getTemplate=function(){return{html:"templates/default-book-view.html",styles:["css/black-book-view.css"],links:[{rel:"stylesheet",href:"css/font-awesome.min.css"}],script:"js/default-book-view.js"}},t}(((n=(i(1),i(69)))&&n.__esModule?n:{default:n}).default);o.PAGE_HANDLER_DELAY=1e3,t.default=o},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o=n(i(9)),r=n(i(8)),s=function(e){function t(i,n,o,s,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var l=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,s,a));if(l.calcSheets(o),l.pages=o,l.pageCallback=n,l.binds={pageCallback:n.bind(l)},l.imageFactory=new r.default(i),o>0){var h=l.imageFactory.build(n(0),0,l.defaults.sheet.widthTexels,l.defaults.sheet.heightTexels,l.defaults.sheet.color);h.onLoad=function(){l.calcProps(h.width,h.height),h.dispose(),l.ready()}}else l.props=l.defaults,l.ready();return l}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(o.default);t.default=s},function(e,t,i){"use strict";t.__esModule=!0;var n,o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},r=function(e){function t(i,n,o,r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,i,n,0,1,o,r))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.getProps=function(){return o({},this.p.cover,{sheets:1})},t.prototype.loadPoints=function(){return{interpolationPoints:[{x:[[0,.2877,.6347,.8174,1],[0,.2831,.6256,.8082,.9909],[0,.2603,.5936,.7763,.9589],[0,.137,.3881,.5342,.6758],[0,0,0,0,0]],y:[[0,0,0,0,0],[0,.02,.005,-.001,-.0025],[0,.04,.01,-.002,-.005],[0,.2466,.4795,.5708,.6758],[0,.2877,.6347,.8174,1]]}],openedInterpolationIndeces:[{left:[2,3,4],right:[2,3,4]}],closedInterpolationIndeces:[[0,1,2]]}},t}(((n=i(10))&&n.__esModule?n:{default:n}).default);t.default=r},function(e,t,i){"use strict";t.__esModule=!0;var n,o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},r=(n=i(40))&&n.__esModule?n:{default:n},s=function(){function e(t){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.book=t,this.props=t.p.cssLayerProps,this.visual=t.visual,this.pageManager=t.pageManager,this.wrappers={},this.pendings=[]}return e.prototype.getActives=function(){var e=this.book.getPage(),t=this.book.getBookPages(),i=0===e||e===t-1?[e]:[e,e+1];return this.wrappers[0]||0===e||(i=[0].concat(i)),i},e.prototype.dispose=function(){var e=Object.values(this.wrappers),t=Array.isArray(e),i=0;for(e=t?e:e[Symbol.iterator]();;){var n;if(t){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}n.layers.forEach(function(e){return e.dispose()})}delete this.wrappers},e.prototype.show=function(){var e=this;this.hidden=!1;var t=this.getActives(),i=Array.isArray(t),n=0;for(t=i?t:t[Symbol.iterator]();;){var s;if("break"===function(){if(i){if(n>=t.length)return"break";s=t[n++]}else{if((n=t.next()).done)return"break";s=n.value}var a=s,l=e.wrappers[a];if(l){if("ready"===l.state&&l.layers.length){var h=e.book.getBlockByPage(a);l.layers.forEach(function(e){e.isHidden()&&(e.update(h),e.show())})}}else{var c=e.wrappers[a]={state:"loading",layers:[]};Promise.resolve().then(function(){e.pageManager.getLayers(a,function(t){var i=function(){if(t.length&&e.wrappers){var i=e.book.getBlockByPage(a),n=t,s=Array.isArray(n),l=0;for(n=s?n:n[Symbol.iterator]();;){var h;if(s){if(l>=n.length)break;h=n[l++]}else{if((l=n.next()).done)break;h=l.value}var u=h,d=new r.default(e.visual,i,o({},e.props,{pageNumber:a}));c.layers.push(d),d.set(u.css,u.html,u.js)}setTimeout(function(){!e.hidden&&~e.getActives().indexOf(a)&&c.layers.forEach(function(e){return e.show()})},10)}c.state="ready"};if(!e.wrappers||0!==a&&"loading"===e.wrappers[0].state)e.pendings.push(i);else if(i(),0===a){var n=e.pendings,s=Array.isArray(n),l=0;for(n=s?n:n[Symbol.iterator]();;){var h;if(s){if(l>=n.length)break;h=n[l++]}else{if((l=n.next()).done)break;h=l.value}h()}e.pendings=[]}})})}}())break}},e.prototype.hide=function(){this.hidden=!0;var e=[],t=Object.values(this.wrappers),i=Array.isArray(t),n=0;for(t=i?t:t[Symbol.iterator]();;){var o;if(i){if(n>=t.length)break;o=t[n++]}else{if((n=t.next()).done)break;o=n.value}o.layers.forEach(function(t){return e.push(t.hide())})}return Promise.all(e)},e}();t.default=s},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},r=i(1),s=n(i(14)),a=n(i(55)),l=n(i(8)),h=n(i(63)),c=n(i(4)),u=function(){function e(t,i,n){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.visual=t,this.book=i,this.pageQuery="",this.p=n,this.pageCache=new s.default(n.cachedPages),this.resourcesCache=new s.default,this.canvases=[];for(var a=0;a<5;++a){var h=c.default.createCanvas();this.canvases.push({c:h,ctx:h.getContext("2d",{willReadFrequently:!0,desynchronized:!1})})}this.nextCanvas=0,this.imageFactory=new l.default(o({},t,{dispatchEvent:i.dispatchEvent.bind(i),renderCanvas:this.canvases[0].c,renderCanvasCtx:this.canvases[0].ctx}),this.resourcesCache),this.loadings=[],this.renderQueue=[],this.predictedRequests=[],this.tmpMaterial=new r.THREE.MeshBasicMaterial,t.addObject(new r.THREE.Mesh(new r.THREE.PlaneGeometry(.001,.001),this.tmpMaterial)),this.loadingAnimation=!0,this.loading={},this.loading[n.cover.color]=this.createLoadingTexture(n.cover),n.page.color!==n.cover.color&&(this.loading[n.page.color]=this.createLoadingTexture(n.page)),this.book.addEventListener("afterAnimation",this.loadPredictedPages.bind(this)),this.turnOnEvents(),t.addRenderCallback(this.update.bind(this)),Promise.resolve().then(this.updateRenderQueue.bind(this))}return e.prototype.createLoadingTexture=function(e){var t=e.height/e.width*e.widthTexels,i=Math.sqrt(1262992.5/(e.widthTexels*t)),n=new a.default(i*e.widthTexels,i*t,e.color),o=new h.default(n.createSprite(6),6,1,6,.2);return n.dispose(),o},e.prototype.dispose=function(){this.turnOffEvents();var e=Object.keys(this.loading),t=Array.isArray(e),i=0;for(e=t?e:e[Symbol.iterator]();;){var n;if(t){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}var o=n;this.loading[o].dispose()}delete this.loading,this.resourcesCache.dispose(),this.pageCache.dispose();var r=this.canvases,s=Array.isArray(r),a=0;for(r=s?r:r[Symbol.iterator]();;){var l;if(s){if(a>=r.length)break;l=r[a++]}else{if((a=r.next()).done)break;l=a.value}var h=l;h.c.height=h.c.width=0}delete this.canvases},e.prototype.isCover=function(e){return e<2||e>=2*(this.p.sheets+1)},e.prototype.isMobile=function(){return this.visual.isMobile()},e.prototype.getPageState=function(e){var t=this.pageCache.get(e);return t?t.state:void 0},e.prototype.enableLoadingAnimation=function(e){this.loadingAnimation=e;var t=this.loadings,i=Array.isArray(t),n=0;for(t=i?t:t[Symbol.iterator]();;){var o;if(i){if(n>=t.length)break;o=t[n++]}else{if((n=t.next()).done)break;o=n.value}var r=o;this.setupMaterial(r)}},e.prototype.update=function(e){if(this.loadingAnimation){var t={},i=this.loadings,n=Array.isArray(i),o=0;for(i=n?i:i[Symbol.iterator]();;){var r;if(n){if(o>=i.length)break;r=i[o++]}else{if((o=i.next()).done)break;r=o.value}var s=r;s.isActive()&&(t[s.color]=!0)}var a=Object.keys(t),l=Array.isArray(a),h=0;for(a=l?a:a[Symbol.iterator]();;){var c;if(l){if(h>=a.length)break;c=a[h++]}else{if((h=a.next()).done)break;c=h.value}var u=c;this.loading[u].update(e),this.book.updateThree()}}},e.prototype.removeFromLoadings=function(e){var t=this.loadings.indexOf(e);~t&&this.loadings.splice(t,1)},e.prototype.removeFromRenderQueue=function(e){var t=this.renderQueue.indexOf(e);~t&&this.renderQueue.splice(t,1)},e.prototype.refreshPageQuery=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.pageQuery=t;var i=this.pageCache.get(e);i&&i.wrapper&&i.wrapper.setQuery&&(this.pageCache.remove(e)||(i.wrapper.setQuery(t),this.pushInRenderQueue(i)))},e.prototype.refreshZoom=function(){var e=this;if(this.p.autoResolution.enabled){this.rendering&&this.rendering.wrapper&&this.rendering.wrapper.cancelRender();var t=[];this.pageCache.forEach(function(e){t.push(e)}),t.forEach(function(t){var i=t[1];i&&i.wrapper&&(e.pageCache.remove(t[0])||e.pushInRenderQueue(i))})}},e.prototype.getLayers=function(e,t){var i=this;(this.p.cssLayersLoader?this.p.cssLayersLoader:function(e,t){return t([])})(e,function(n){var o=i.pageCache.get(e);o&&(o.wrapper.getCSSLayer&&i.p.highlightLinks?o.wrapper.getCSSLayer():Promise.resolve()).then(function(e){(e||n[0])&&(e=e||{},n[0]=n[0]||{},n[0]={html:(e.html||"")+(n[0].html||""),css:(e.css||"")+(n[0].css||""),js:n[0].js}),"active"!==o.state?o.pendings.push({clb:t,args:[n]}):t(n)})})},e.prototype.resolvePendings=function(e){var t=e,i=Array.isArray(t),n=0;for(t=i?t:t[Symbol.iterator]();;){var o;if(i){if(n>=t.length)break;o=t[n++]}else{if((n=t.next()).done)break;o=n.value}var r=o;try{r.clb.apply(r,r.args)}catch(e){console.error(e)}}e.splice(0,e.length)},e.prototype.rtlPageN=function(e){return this.p.rtl?this.book.getBookPages()-1-e:e},e.prototype.load=function(e,t){var i=this,n=this.rtlPageN(t)<this.book.getPages()?this.p.pageCallback(this.rtlPageN(t)):{type:"blank"},o=this.isCover(t)?this.p.cover:this.p.page,s={n:t,texture:new r.THREE.Texture,wrapper:null,state:"loading",locked:function(e){return"loading"===s.state||"rendering"===s.state||i.book.isActivePage(e)},color:o.color,isActive:function(){return i.book.isActivePage(t)},isTop:function(){return~i.book.getTopPages().indexOf(t)},dispose:function(){i.removeFromLoadings(s),i.removeFromRenderQueue(s),s.wrapper&&s.wrapper.dispose&&s.wrapper.dispose(),s.texture.dispose(),delete s.texture,delete s.wrapper},pendings:[]};return s.texture.minFilter=r.THREE.LinearFilter,this.loadings.push(s),this.setMaterial(s,e),Promise.resolve().then(function(){if(s.texture){s.widthTexels=n.widthTexels||o.widthTexels,s.heightTexels=o.height/o.width*o.widthTexels;var e=i.calcResolution(s);s.wrapper=i.imageFactory.build(n,void 0===n.number?i.rtlPageN(t):n.number,e.width,e.height,o.color,i.p.injector),s.wrapper.setQuery&&s.wrapper.setQuery(i.pageQuery),s.simulate=n.interactive?(s.wrapper.simulate||function(){}).bind(s.wrapper):void 0,s.wrapper.onLoad=function(){s.state="loaded",i.pushInRenderQueue(s)},s.wrapper.onChange=function(e,t){t?("queuedForRender"!==s.state&&(s.state="loaded",s.wrapper&&i.pushInRenderQueue(i.rendering)),delete i.rendering):s.texture&&(i.removeFromLoadings(s),s.material&&(s.material.map=s.texture,s.material.color=new r.THREE.Color(16777215),s.material.needsUpdate=!0),s.texture.image=e,s.texture.needsUpdate=!0,s.texture.onUpdate=function(){s.texture&&(s.texture.onUpdate=null),i.tmpMaterial.map=null,i.tmpMaterial.needsUpdate=!0,"queuedForRender"!==s.state&&(s.state="active",i.resolvePendings(s.pendings)),delete i.rendering,i.book.dispatchEvent({type:"endRendering",page:s.n})},i.tmpMaterial.map=s.texture,i.tmpMaterial.needsUpdate=!0)}}}),this.pageCache.put(t,s)},e.prototype.isSinglePage=function(e){return this.p.singlePage},e.prototype.calcResolution=function(e){var t=void 0;if(this.p.autoResolution.enabled){var i=this.p.autoResolution.coefficient*this.p.zoom*Math.sqrt(this.visual.wnd.devicePixelRatio||1)*Math.min((this.isSinglePage(e)?1:.5)*this.visual.width()/e.widthTexels,this.visual.height()/e.heightTexels);t={width:i*e.widthTexels,height:i*e.heightTexels};var n=this.p.autoResolution.min,o=this.p.autoResolution.max;t.width<n&&(t={width:n,height:n*e.heightTexels/e.widthTexels}),t.height<n&&(t={width:n*e.widthTexels/e.heightTexels,height:n}),t.width>o&&(t={width:o,height:o*e.heightTexels/e.widthTexels}),t.height>o&&(t={width:o*e.widthTexels/e.heightTexels,height:o})}else t={width:e.widthTexels,height:e.heightTexels};return t},e.prototype.pushInRenderQueue=function(e){"queuedForRender"!==e.state&&"loading"!==e.state&&(e.state="queuedForRender",this.renderQueue.push(e))},e.prototype.updateRenderQueue=function(){if(this.canvases){var e=this.p;if(this.rendering)this.rendering.wrapper&&this.rendering.wrapper.setRenderPause(!e.renderWhileFlipping&&(this.book.isProcessing()||this.visual.getOrbit().isMoving())),this.book.updateThree();else if(e.renderWhileFlipping||!this.book.isProcessing()&&!this.visual.getOrbit().isMoving()){var t=void 0,i=void 0,n=this.renderQueue,o=Array.isArray(n),r=0;for(n=o?n:n[Symbol.iterator]();;){var s;if(o){if(r>=n.length)break;s=n[r++]}else{if((r=n.next()).done)break;s=r.value}var a=s;if(!t&&a.isActive()&&(t=a),a.isTop()){i=a;break}}if(this.rendering=i||t,(this.isMobile()&&e.renderInactivePagesOnMobile||!this.isMobile()&&e.renderInactivePages)&&!this.rendering){var l=this.book.getUserDirection(),h={},c=this.renderQueue,u=Array.isArray(c),d=0;for(c=u?c:c[Symbol.iterator]();;){var p;if(u){if(d>=c.length)break;p=c[d++]}else{if((d=c.next()).done)break;p=d.value}var f=p,v=l.lastTopPage<f.n;(!h[v]||Math.abs(h[v].n-l.lastTopPage)>Math.abs(f.n-l.lastTopPage))&&(h[v]=f),this.rendering=h[1===l.direction]||h[1!==l.direction]}}if(this.rendering)if(this.rendering.wrapper&&this.rendering.wrapper.startRender){this.removeFromRenderQueue(this.rendering),this.rendering.state="rendering";var g=this.canvases[this.nextCanvas];this.nextCanvas=(this.nextCanvas+1)%this.canvases.length,this.rendering.wrapper.setRenderCanvas(g.c,g.ctx),this.rendering.wrapper.setResolution(this.calcResolution(this.rendering)),this.rendering.wrapper.startRender(),this.book.dispatchEvent({type:"startRendering",page:g.n})}else delete this.rendering}setTimeout(this.updateRenderQueue.bind(this),100)}},e.prototype.turnOnEvents=function(){this.transferEvents=!0},e.prototype.turnOffEvents=function(){var e=r.$.Event("mouseup"),t=r.$.Event("mouseout");this.pageCache.forEach(function(i){var n=i[1];n.simulate&&(n.simulate(e,void 0,0,0),n.simulate(t,void 0,0,0))}),this.transferEvents=!1},e.prototype.transferEventToTexture=function(e,t,i){if(this.transferEvents){var n=this.getOrLoadTextureObject(void 0,e);if(n.wrapper){var o=i.uv,r=n.wrapper.getSimulatedDoc();this.pageCache.forEach(function(e){var i=e[1];i.simulate&&i.simulate(t,r,o.x,o.y)})}}},e.prototype.loadPredictedPages=function(){var e=this;Promise.resolve().then(function(){var t=e.book.getUserDirection();e.predictedRequests=[];for(var i=0,n=t.lastTopPage+t.direction;i<e.p.preloadPages;++i,n+=t.direction)e.predictedRequests.push(n);var o=e.predictedRequests,r=Array.isArray(o),s=0;for(o=r?o:o[Symbol.iterator]();;){var a;if(r){if(s>=o.length)break;a=o[s++]}else{if((s=o.next()).done)break;a=s.value}var l=a;l>=0&&l<e.book.getBookPages()&&!e.pageCache.get(l)&&e.load(void 0,l)}})},e.prototype.setMaterial=function(e,t){this.pageCache.forEach(function(i){var n=i[1];e!==n&&n.material===t&&delete n.material}),t&&t!==e.material&&(e.material=t,this.setupMaterial(e))},e.prototype.setupMaterial=function(e){e.material.map=e.texture.image?e.texture:this.loadingAnimation?this.loading[e.color].texture:null,e.material.map||(e.material.color=new r.THREE.Color(e.color)),e.material.needsUpdate=!0},e.prototype.getOrLoadTextureObject=function(e,t){var i=this.pageCache.get(t);return i?this.setMaterial(i,e):i=this.load(e,t),i},e.prototype.setTexture=function(e,t){this.getOrLoadTextureObject(e,t)},e}();t.default=u},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o=n(i(9)),r=n(i(19)),s=function(e){function t(i,n,o,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,n,o));return a.pdf=new r.default(i,void 0,s),a.pageDescription={type:"pdf",src:a.pdf,interactive:!0},a.binds={pageCallback:a.pageCallback.bind(a)},a.pdf.getHandler(a.init.bind(a)),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.dispose=function(){this.pdf.dispose(),e.prototype.dispose.call(this)},t.prototype.init=function(e){var t=this,i=this.pdf.getPagesNum();this.pages=i,this.calcSheets(i),i>0?e.getPage(1).then(function(e){var i=e.getViewport({scale:1}),n={width:i.width,height:i.height};t.calcProps(n.width,n.height),t.ready()}).catch(function(e){console.error(e)}):(this.props=this.defaults,this.ready())},t.prototype.pageCallback=function(e){return this.pageDescription},t}(o.default);t.default=s},function(e,t,i){"use strict";t.__esModule=!0;var n=i(1),o=function(){function e(t,i,o){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.pdf=t,this.ctrl=i,this.element=(0,n.$)(o),this.cursors=[]}return e.prototype.dispose=function(){},e.prototype.setHandler=function(e){this.handler=e},e.prototype.defaultHandler=function(e,t){"internal"===e?this.ctrl.goToPage(t):"external"===e&&-1===t.toLowerCase().search("javascript:")&&window.open(t,"_blank")},e.prototype.callHandlers=function(e,t){this.handler&&this.handler(e,t)||this.defaultHandler(e,t)},e.prototype.handleEvent=function(e){var t=this,i=e.event,n=e.annotation;switch(i.type){case"mouseover":this.cursors.push(this.element.css("cursor")),this.element.css("cursor","pointer");break;case"mouseout":this.element.css("cursor",this.cursors.pop()||"");break;case"touchtap":case"click":n.url?this.callHandlers("external",n.url):n.dest&&this.pdf.getDestination(n.dest).then(function(e){return t.callHandlers("internal",e)})}},e}();t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var n,o=(n=i(17))&&n.__esModule?n:{default:n},r=function(){function e(t,i){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.pageCallback=t,this.pages=i,this.results=[]}return e.prototype.setQuery=function(e){this.query=e,this.update=!0,this.process()},e.prototype.process=function(){var e=this;if(this.update){var t=this.results;if(this.results=[],this.onPageHitsChanged){var i=t,n=Array.isArray(i),o=0;for(i=n?i:i[Symbol.iterator]();;){if(n){if(o>=i.length)break;i[o++]}else{if((o=i.next()).done)break;o.value}this.onPageHitsChanged(void 0,"")}}this.update=!1,this.page=0,this.stamp=Date.now(),this.query.length>1&&this.process()}else if(this.page<this.pages){var r=this.stamp;this.find(this.pageCallback(this.page)).then(function(t){r===e.stamp&&(t.length&&e.results.push({page:e.page,contexts:t}),e.onPageHitsChanged&&e.onPageHitsChanged(e.page,e.query),++e.page,e.process())})}},e.prototype.find=function(e){var t=this;return"pdf"===e.type?new Promise(function(i){e.src.getHandler(function(){var n=void 0===e.number?t.page:e.number;"right"===e.src.getPageType(n)?i([]):e.src.getPage(n).then(function(e){e.getTextContent().then(function(e){i(new o.default(e.items.map(function(e){return e.str}),t.query,{hits:!1}).getContexts())})}).catch(function(){return i([])})})}):Promise.resolve([])},e}();t.default=r},function(e,t,i){"use strict";t.__esModule=!0;var n,o=i(1),r=function(e){function t(i,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,i,"widShare"));return r.bookCtrl=n,r.linkBuilder=o,n.addEventListener("endFlip",r.updateView.bind(r)),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.cmdCloseShare=function(){this.hide()},t.prototype.clickLink=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=(0,o.$)('<a href="'+e+'"'+(t?' target="_blank"':"")+"></a>").appendTo(this.view.getContainer());i[0].click(),i.remove()},t.prototype.cmdFacebook=function(){this.clickLink("https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(this.getLink()))},t.prototype.cmdTwitter=function(){this.clickLink("http://twitter.com/share?url="+encodeURIComponent(this.getLink()))},t.prototype.cmdEmail=function(){this.clickLink("mailto:?subject="+(0,o.tr)("We wanted you to see this book")+"&body="+(0,o.tr)("Check out this site")+" "+encodeURIComponent(this.getLink()),!1)},t.prototype.getLink=function(){return this.linkBuilder(this.bookCtrl.getPageForGUI())},t.prototype.updateView=function(){if(this.view){for(var t=["cmdCloseShare","cmdFacebook","cmdTwitter","cmdEmail"],i=0;i<t.length;i++){var n=t[i];this.view.setState(n,{enable:!0,visible:!0,active:!1})}this.view.setState("txtShareLink",{value:this.getLink(),visible:!0}),e.prototype.updateView.call(this)}},t}(((n=i(22))&&n.__esModule?n:{default:n}).default);t.default=r},function(e,t,i){"use strict";t.__esModule=!0;var n,o=(n=i(13))&&n.__esModule?n:{default:n},r=function(){function e(t,i,n){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.visual=t;var r=i.getTopSize();this.layer=new o.default(r.width,r.height,n),this.update(i),this.visual.addCssObject(this.layer)}return e.prototype.dispose=function(){this.layer.dispose(),this.visual.removeCssObject(this.layer)},e.prototype.isHidden=function(){return this.layer.isHidden()},e.prototype.hide=function(){return this.layer.hide()},e.prototype.show=function(){return this.layer.show()},e.prototype.set=function(e,t,i){this.layer.setData(e,t,i)},e.prototype.update=function(e){this.block=e;var t=e.getTopSize();this.layer.setSize(t.width,t.height),this.block.getTopWorldRotation(this.layer.rotation),this.block.getTopWorldPosition(this.layer.position)},e}();t.default=r},function(e,t,i){"use strict";t.__esModule=!0;var n,o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},r=(n=i(5))&&n.__esModule?n:{default:n},s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.15,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:240;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.p={r:t,cornerDeviation:n,l:Math.PI*t,startDt:1/o,gravity:i,margin:.002*t,infM:1e4,attempts:16,maxIterations:100},this.os=[]}return e.targetForceClb=function(e,t,i,n){var o=t*this.r;return 100*this.m*this.g*(2/(1+Math.exp(10*(o-this.tl)))-1)-40*this.m*i},e.hoverCornerForceClb=function(e,t,i,n){return 5},e.prototype.getTargetForceClb=function(t,i){return e.targetForceClb.bind({g:this.p.gravity,m:t,tl:i*this.p.r,r:this.p.r})},e.dragForceClb=function(e,t,i,n){return e.flbt*e.m*(10*e.g*n-50*i/(1+Math.exp(3.5*Math.abs(n))))},e.dragCornerForceClb=function(e,t,i,n){return 15*(2/(1+Math.exp(10*(t-this.ta)*e.r))-1)},e.getDragCornerForceClb=function(t){return e.dragCornerForceClb.bind({ta:t})},e.prototype.dispose=function(){this.os=[]},e.prototype.getSize=function(){return this.os.length},e.prototype.addObject=function(e,t,i,n,o,s,a){var l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:function(){return 0},h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:function(){return 0},c={id:r.default.getUnique(),m:e,v:i,l:t*this.p.r,f:l,cf:h,ch:o,flbt:n,simulateClb:s,removeClb:a},u=this.os.findIndex(function(e){return c.l<=e.l});return u=~u?u:this.os.length,this.os.splice(u,0,c),c.id},e.prototype.getParametrMap=function(e){return{mass:"m",velocity:"v",flexibility:"flbt",cornerHeight:"ch",simulateClb:"simulateClb",removeClb:"removeClb",forceClb:"f",cornerForceClb:"cf"}[e]},e.prototype.setParametr=function(e,t,i){var n=this.os.find(function(t){return t.id===e});"angle"===t?n.l=i*this.p.r:n[this.getParametrMap(t)]=i},e.prototype.getParametr=function(e,t){var i=this.os.find(function(t){return t.id===e});return"angle"===t?i.l/this.p.r:i[this.getParametrMap(t)]},e.prototype.simulate=function(e){for(var t=0,i=this.p.startDt,n=0,o=0;t<e&&o<this.p.maxIterations;){i>e-t&&(i=e-t);var r=this.integrate(this.os,i),s=this.findCollisions(r);if(s.num>1&&n<this.p.attempts)i/=2,++n;else{if(1===s.num){var a=this.solveCollision(r[s.last-1],r[s.last]);r[s.last-1]=a[0],r[s.last]=a[1]}else if(s.num>1){var l=[],h=-2,c=s.all,u=Array.isArray(c),d=0;for(c=u?c:c[Symbol.iterator]();;){var p;if(u){if(d>=c.length)break;p=c[d++]}else{if((d=c.next()).done)break;p=d.value}var f=p;f-h>1&&l.push([]),l[l.length-1].push(f),h=f}var v=l,g=Array.isArray(v),m=0;for(v=g?v:v[Symbol.iterator]();;){var b;if(g){if(m>=v.length)break;b=v[m++]}else{if((m=v.next()).done)break;b=m.value}var y=b,w=void 0,k=void 0;r[y[0]].l>Math.PI/2*this.p.r?(w=-1,k=y[y.length-1]):(w=1,k=y[0]);for(var x=k;x<r.length&&x>-1;x+=w){var P=r[x+w];if(!(P&&w*(P.l-r[x].l)<=this.p.margin))break;P.l=r[x].l+2*w*this.p.margin,(P.l>this.p.l||P.l<0)&&(P.l=P.l>this.p.l?this.p.l:0,P.ch=0,P.v=0,console.error("Bad collision"))}}}this.os=r,this.findAndSolveCornerCollisions(),t+=i,i=this.p.startDt,n=0}++o}this.removeStatics()},e.prototype.removeStatics=function(){var e=[],t=[[],[]],i=this.os,n=Array.isArray(i),o=0;for(i=n?i:i[Symbol.iterator]();;){var r;if(n){if(o>=i.length)break;r=i[o++]}else{if((o=i.next()).done)break;r=o.value}var s=r;s.simulateClb&&s.simulateClb(s.l/this.p.r,s.ch),s.l!==this.p.l&&0!==s.l||0!==s.v?e.push(s):void 0!==s.removeClb&&t[(s.l!==this.p.l)+0].push(s)}this.os=e;var a=t[0].reverse(),l=Array.isArray(a),h=0;for(a=l?a:a[Symbol.iterator]();;){var c;if(l){if(h>=a.length)break;c=a[h++]}else{if((h=a.next()).done)break;c=h.value}var u=c;u.removeClb(Math.PI,u.ch)}var d=t[1],p=Array.isArray(d),f=0;for(d=p?d:d[Symbol.iterator]();;){var v;if(p){if(f>=d.length)break;v=d[f++]}else{if((f=d.next()).done)break;v=f.value}var g=v;g.removeClb(0,g.ch)}},e.prototype.findAndSolveCornerCollisions=function(){if(this.os.length)for(var e=[o({},this.os[0],{l:0,m:this.p.infM,ch:0})].concat(this.os,[o({},this.os[0],{l:1.05*this.p.l,m:this.p.infM,ch:0})]),t=1;t<e.length;++t){var i=e[t-1],n=e[t];if(1.05*(i.l+this.p.cornerDeviation*i.ch*this.p.r)>n.l+this.p.cornerDeviation*n.ch*this.p.r&&i.ch>n.ch){var r=i.ch-n.ch,s=i.m/i.flbt+n.m/n.flbt,a=i.m/i.flbt/s,l=n.m/n.flbt/s;i.ch=i.ch-l*r,n.ch=n.ch+a*r}}},e.prototype.solveCollision=function(e,t){var i=t.m+e.m,n=(-e.v*t.m+e.m*e.v+2*t.m*t.v)/i,r=(t.m*t.v-t.v*e.m+2*e.m*e.v)/i;return[o({},e,{v:n}),o({},t,{v:r})]},e.prototype.findCollisions=function(e){for(var t={num:0,last:0,all:[]},i=1;i<e.length&&t.num<2;++i)(e[i-1].l>e[i].l||this.isCollision(e[i-1],e[i]))&&(e[i-1].l>e[i].l&&++t.num,++t.num,t.last=i,-1===t.all.indexOf(i-1)&&t.all.push(i-1),-1===t.all.indexOf(i)&&t.all.push(i));return t},e.prototype.isCollision=function(e,t){return Math.abs(e.l-t.l)<this.p.margin&&e.v>t.v},e.prototype.integrate=function(e,t){var i=[],n=e,s=Array.isArray(n),a=0;for(n=s?n:n[Symbol.iterator]();;){var l;if(s){if(a>=n.length)break;l=n[a++]}else{if((a=n.next()).done)break;l=a.value}var h=l,c=r.default.rk4(this.dy.bind({g:this.p.gravity,r:this.p.r,m:h.m,f:h.f,cf:h.cf,ch:h.ch,flbt:h.flbt}),0,t,[h.v,h.l,h.ch]),u=o({},h,{v:c[0],l:c[1],ch:c[2]});(u.l<=0||u.l>=this.p.l)&&(u.l=u.l<=0?0:this.p.l,u.v=0,u.ch=0),i.push(u)}return i},e.prototype.dy=function(e,t){var i=t[0],n=t[1],o=t[2],r=n/this.r,s=this.f(this,r,i,o),a=this.cf(this,r,i,o),l=Math.cos(r),h=6.65*Math.abs((Math.sign(l)-Math.sign(i))*i)*Math.pow(l,5);return[-this.g*l+h+s/this.m,i+.01*(Math.random()-.5),this.flbt*((2/(1+Math.exp(-.2*a))-1)*(1-2/(1+Math.exp(-5*(Math.abs(o)-2))))-o)]},e}();t.default=s},function(e,t,i){"use strict";t.__esModule=!0;var n=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),t="function"==typeof t?t():t,this.sounds=t.sounds||{},this.audio={},this.sounds.startFlip&&(this.audio.startFlip=new Audio(this.sounds.startFlip),this.audio.startFlip.volume=.5),this.sounds.endFlip&&(this.audio.endFlip=new Audio(this.sounds.endFlip),this.audio.endFlip.volume=.5)}return e.prototype.setEnabled=function(e){this.enabled=e},e.prototype.togle=function(){this.enabled=!this.enabled},e.prototype.dispose=function(){delete this.audio.startFlip,delete this.audio.endFlip},e.prototype.play=function(e){e.play().catch(function(){})},e.prototype.startFlip=function(){this.enabled&&this.audio.startFlip&&this.play(this.audio.startFlip)},e.prototype.endFlip=function(){this.enabled&&this.audio.startFlip&&(this.audio.startFlip.pause(),this.audio.startFlip.currentTime=0),this.enabled&&this.audio.endFlip&&this.play(this.audio.endFlip)},e.prototype.subscribeFlips=function(e){e.addEventListener("startFlip",this.startFlip.bind(this)),e.addEventListener("endFlip",this.endFlip.bind(this))},e}();t.default=n},function(e,t,i){"use strict";t.__esModule=!0;var n,o=function(e){function t(i,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,i,"widFloatWnd"));return o.bookCtrl=n,o.tab="none",o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.setThumbnails=function(e){this.thumbnails=e,e.onNavigate=this.navigateThumbnails.bind(this),"none"===this.tab&&(this.tab="thumbnails"),this.fireChange()},t.prototype.setSearch=function(e){this.search=e,e.onNavigate=this.navigateSearch.bind(this),this.fireChange()},t.prototype.setBookmarks=function(e,t){e.getSize()&&(this.bookmarks=e,this.pdf=t,e.onNavigate=this.navigateBookmarks.bind(this),this.isBookmarks=!0,this.fireChange())},t.prototype.cmdBookmarks=function(){this.setActiveTab("bookmarks")},t.prototype.cmdThumbnails=function(){this.setActiveTab("thumbnails")},t.prototype.cmdSearch=function(){this.setActiveTab("search")},t.prototype.setActiveTab=function(e){this[e]&&(this.tab=e,this.fireChange())},t.prototype.cmdCloseToc=function(){this.hide()},t.prototype.navigateThumbnails=function(e){this.goToPage(e)},t.prototype.navigateSearch=function(e){this.goToPage(e)},t.prototype.openUrl=function(e){-1===e.toLowerCase().search("javascript:")&&window.open(e,"_blank")},t.prototype.goToPage=function(e){this.bookCtrl.goToPage(e)},t.prototype.dstDataHandler=function(e){var t;e=(e+"").trim(),(t=parseInt(e))==e?this.goToPage(t):this.openUrl(e)},t.prototype.navigateBookmarks=function(e){var t=this;e.url?this.openUrl(e.url):e.dest?this.pdf.getDestination(e.dest).then(function(e){return t.goToPage(e)}):void 0!==e.dstData&&this.dstDataHandler(e.dstData)},t.prototype.updateView=function(){var t=this;this.view&&(this.view.setState("widTocMenu",{enable:!0,visible:!0,active:!1}),this.view.setState("widThumbnails",{enable:!0,visible:"thumbnails"===this.tab,active:!1}),this.view.setState("widSearch",{enable:!0,visible:"search"===this.tab,active:!1}),this.view.setState("widBookmarks",{enable:!0,visible:"bookmarks"===this.tab,active:!1}),this.view.setState("cmdBookmarks",{enable:!0,visible:!!this.bookmarks,active:"bookmarks"===this.tab}),this.view.setState("cmdCloseToc",{enable:!0,visible:!0,active:!1}),this.view.setState("cmdThumbnails",{enable:!0,visible:!(!this.thumbnails||!this.search&&!this.bookmarks),active:"thumbnails"===this.tab}),this.view.setState("cmdSearch",{enable:!0,visible:!!this.search,active:"search"===this.tab}),Promise.resolve().then(function(){return t.thumbnails.setEnable(t.visible&&"thumbnails"===t.tab)}),e.prototype.updateView.call(this))},t}(((n=i(22))&&n.__esModule?n:{default:n}).default);t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var n,o=i(1),r=(n=i(21))&&n.__esModule?n:{default:n},s=[],a=new o.THREE.PlaneGeometry(1,1,10,1);a.translate(.5,.5,1);var l=new o.THREE.PlaneGeometry(1,1,10,1);l.rotateY(Math.PI),l.translate(.5,.5,0);var h=new o.THREE.PlaneGeometry(1,1,14,1);h.rotateY(-Math.PI/2),h.translate(0,.5,.5);var c=new o.THREE.PlaneGeometry(1,1,14,1);c.rotateY(Math.PI/2),c.translate(1,.5,.5);var u=new o.THREE.PlaneGeometry(1,1,10,14);u.rotateX(-Math.PI/2),u.translate(.5,1,.5);var d=u.clone();d.translate(0,-1,0);var p=d.faces,f=Array.isArray(p),v=0;for(p=f?p:p[Symbol.iterator]();;){var g;if(f){if(v>=p.length)break;g=p[v++]}else{if((v=p.next()).done)break;g=v.value}var m=g,b=[m.b,m.a];m.a=b[0],m.b=b[1]}var y=new o.THREE.Geometry;y.vertices=[].concat(d.vertices,u.vertices);var w=function(e,t){var i=e,n=Array.isArray(i),r=0;for(i=n?i:i[Symbol.iterator]();;){var a;if(n){if(r>=i.length)break;a=i[r++]}else{if((r=i.next()).done)break;a=r.value}var l=a;y.faces.push(new o.THREE.Face3(t(l.a),t(l.b),t(l.c)))}s.push(y.faces.length)},k=function(e,t){for(var i=[],n=0;n<e.length;++n)for(var o=0;o<t.length;++o)if(function(e,t){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)+Math.abs(e.z-t.z)<1e-4}(e[n],t[o])){i[n]=o;break}return i},x=k(a.vertices,y.vertices),P=k(l.vertices,y.vertices),C=k(h.vertices,y.vertices),_=k(c.vertices,y.vertices);w(u.faces,function(e){return e+d.vertices.length}),w(d.faces,function(e){return e}),w(a.faces,function(e){return x[e]}),w(l.faces,function(e){return P[e]}),w(h.faces,function(e){return C[e]}),w(c.faces,function(e){return _[e]}),s.pop(),r.default.computeFaceVertexUvs(y,s),y.computeVertexNormals(),y.computeBoundingSphere(),y.verticesNeedUpdate=!0,t.default={resX:11,resY:2,resZ:15,faces:s,geometry:y}},function(e,t,i){"use strict";t.__esModule=!0,t.props=function(){return{eps:1e-4,scale:{default:.9,min:.9,max:2,levels:5},pan:{speed:50},loadingAnimation:{skin:!0,book:!1},autoResolution:{enabled:!0,coefficient:1.5,min:800,max:1920},narrowView:{width:500},actions:{cmdZoomIn:{enabled:!0,enabledInNarrow:!0},cmdZoomOut:{enabled:!0,enabledInNarrow:!0},cmdDefaultZoom:{enabled:!1,enabledInNarrow:!1,type:"dblclick",code:0},cmdToc:{enabled:!0,enabledInNarrow:!0,active:!1,defaultTab:"bookmarks"},cmdAutoPlay:{enabled:!1,enabledInNarrow:!1,active:!1},cmdBackward:{enabled:!0,enabledInNarrow:!1,code:37},cmdBigBackward:{enabled:!0,enabledInNarrow:!0},cmdForward:{enabled:!0,enabledInNarrow:!1,code:39},cmdBigForward:{enabled:!0,enabledInNarrow:!0},cmdSave:{enabled:!0,enabledInNarrow:!0},cmdPrint:{enabled:!0,enabledInNarrow:!0},cmdFullScreen:{enabled:!0,enabledInNarrow:!0},widSettings:{enabled:!0,enabledInNarrow:!0},widToolbar:{enabled:!0,enabledInNarrow:!0},cmdSmartPan:{enabled:!1,enabledInNarrow:!1,active:!0},cmdSinglePage:{enabled:!0,enabledInNarrow:!0,active:!1,activeForMobile:!0},cmdSounds:{enabled:!0,enabledInNarrow:!0,active:!0},cmdStats:{enabled:!1,enabledInNarrow:!1,active:!1},cmdGotoFirstPage:{enabled:!0,enabledInNarrow:!0},cmdGotoLastPage:{enabled:!0,enabledInNarrow:!0},cmdShare:{enabled:!0,enabledInNarrow:!0},cmdPanLeft:{enabled:!1},cmdPanRight:{enabled:!1},cmdPanUp:{enabled:!1},cmdPanDown:{enabled:!1},mouseCmdRotate:{enabled:!0,type:"mousedrag",code:n.Right},mouseCmdDragZoom:{enabled:!0,type:"mousedrag",code:n.Middle},mouseCmdPan:{enabled:!0,type:"mousedrag",code:n.Left},mouseCmdWheelZoom:{enabled:0,type:"mousewheel",code:0},touchCmdRotate:{enabled:!0,type:"touchdrag",code:3},touchCmdZoom:{enabled:!0,type:"touchdrag",code:2},touchCmdPan:{enabled:!0,type:"touchdrag",code:1},touchCmdSwipe:{enabled:!0,type:"touchdrag",code:1}}}};var n={Left:0,Middle:1,Right:2}},function(e,t,i){"use strict";t.__esModule=!0;var n,o=function(e){function t(i,n,o,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var s=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,i,n,o,r));return Promise.resolve().then(function(){s.startRender=function(){s.renderBlankPage(),s.finishRender()},s.finishLoad()}),s}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(((n=(i(0),i(6)))&&n.__esModule?n:{default:n}).default);t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var n=i(0),o=function(){function e(t,i){var o=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e.title},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){return e.items};(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.container=t,this.map=[],this.getTitle=r,this.getItems=s,this.nodes=this.mapNodes(i,this.map),this.binds={togle:function(e){e.preventDefault();for(var i=(0,n.$)(e.target);i[0]&&i[0]!==t[0]&&!i.hasClass("item");)i=(0,n.$)(i[0].parentNode);if(i.hasClass("item")){for(var r=(0,n.$)(e.target);r[0]&&r[0]!==i[0]&&!r.hasClass("cmd");)r=(0,n.$)(r[0].parentNode);if(r.hasClass("cmd")){var s=o.map[i.attr("data-id")];r.hasClass("togle")?(s.minimized=!s.minimized,s.minimized?(i.find("ul").remove(),i.find(".togle").addClass("minimized")):(i.find(".togle").removeClass("minimized"),i.append((o.renderNode(s).match(/<ul(.|\n)*<\/ul>/g)||[""])[0]))):o.onNavigate&&o.onNavigate(s.item)}}}},t.on("click",this.binds.togle),this.update()}return e.prototype.getSize=function(){return this.map.length},e.prototype.dispose=function(){this.container.off("click",this.binds.togle),this.container.html("")},e.prototype.update=function(){this.container.html(this.renderNodes(this.nodes))},e.prototype.forEach=function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nodes)||[],i=Array.isArray(t),n=0;for(t=i?t:t[Symbol.iterator]();;){var o;if(i){if(n>=t.length)break;o=t[n++]}else{if((n=t.next()).done)break;o=n.value}var r=o;e(r),this.forEach(e,r.children)}},e.prototype.expand=function(){this.forEach(function(e){return e.minimized=!1}),this.update()},e.prototype.minimize=function(){this.forEach(function(e){return e.minimized=!0}),this.update()},e.prototype.renderNode=function(e){var t=(e.title||"").replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;");return['<div class="area">',e.children?'<a class="cmd togle'+(e.minimized?" minimized":"")+'"><i class="fa fa-angle-right"></i></a> ':'<i class="white-space"></i> ','<a class="cmd" title="',t,'">',t,"</a></div>",e.minimized?"":this.renderNodes(e.children)].join("")},e.prototype.renderNodes=function(e){var t=['<div class="bookmarks">'];if(e&&e.length){t.push('<ul class="level-',e[0].level,'">');var i=e,n=Array.isArray(i),o=0;for(i=n?i:i[Symbol.iterator]();;){var r;if(n){if(o>=i.length)break;r=i[o++]}else{if((o=i.next()).done)break;r=o.value}var s=r;t.push(['<li class="item" data-id="',s.id,'">',this.renderNode(s),"</li>"].join(""))}t.push("</ul>")}return t.push("</div>"),t.join("")},e.prototype.mapNodes=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=null;if(e&&e.length){n=[];var o=e,r=Array.isArray(o),s=0;for(o=r?o:o[Symbol.iterator]();;){var a;if(r){if(s>=o.length)break;a=o[s++]}else{if((s=o.next()).done)break;a=s.value}var l=a,h=t.length;t.push(void 0);var c={id:h,title:this.getTitle(l),level:i,item:l,minimized:!0,children:this.mapNodes(this.getItems(l),t,i+1)};n.push(c),t[h]=c}}return n},e}();t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var n=i(0),o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.getWebGLErrorMessage=function(){var t=document.createElement("div");return t.id="webgl-error-message",t.style.fontFamily="monospace",t.style.fontSize="13px",t.style.fontWeight="normal",t.style.textAlign="center",t.style.background="#fff",t.style.color="#000",t.style.padding="1.5em",t.style.width="400px",t.style.margin="5em auto 0",e.webgl||(t.innerHTML=window.WebGLRenderingContext?['Your graphics card does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br />','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join("\n"):['Your browser does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br/>','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join("\n")),t},e.addGetWebGLMessage=function(t){var i,o=void 0;o=(t=t||{}).parent||(0,n.$)(document.body),t.id,i=e.getWebGLErrorMessage(),o.append(i)},e}();o.canvas=!!window.CanvasRenderingContext2D,o.webgl=function(){try{var e=document.createElement("canvas");return!(!window.WebGLRenderingContext||!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch(e){return!1}}(),o.workers=!!window.Worker,o.fileapi=window.File&&window.FileReader&&window.FileList&&window.Blob,t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var n=i(0),o=function(){function e(t,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:document.body;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.jFrame=t,this.wnd=t[0].contentWindow,this.doc=t[0].contentDocument,this.element=i||doc.body,this.bElement=o,this.resendProperties=this.getDefaultResendProperties(),this.undefinedProperties=this.getDefaultUndefinedProperties(),this.cursors=[],this.onDocChangeClbs=[];for(var r=[{find:":hover",replace:"."+e.HOVER},{find:":active",replace:"."+e.ACTIVE}],s=['<style type="text/css">'],a=0;a<this.doc.styleSheets.length;++a)for(var l=this.doc.styleSheets[a],h=0;h<l.cssRules.length;++h){var c=l.cssRules[h],u=void 0,d=r,p=Array.isArray(d),f=0;for(d=p?d:d[Symbol.iterator]();;){var v;if(p){if(f>=d.length)break;v=d[f++]}else{if((f=d.next()).done)break;v=f.value}var g=v;~c.selectorText.indexOf(g.find)&&(u=(u||c.cssText).replace(new RegExp(g.find,"g"),g.replace))}u&&s.push(u)}s.push("</style>"),(0,n.$)(this.doc.head).append((0,n.$)(s.join("")))}return e.prototype.convertCoords=function(e,t){var i=(0,n.$)(this.element),o=i.offset();return{x:o.left+i.width()*e,y:o.top+i.height()*(1-t)}},e.prototype.triggerEvent=function(e,t,i,o,r){var s={},a=this.resendProperties,l=Array.isArray(a),h=0;for(a=l?a:a[Symbol.iterator]();;){var c;if(l){if(h>=a.length)break;c=a[h++]}else{if((h=a.next()).done)break;c=h.value}var u=c;s[u]=t[u]}var d=this.undefinedProperties,p=Array.isArray(d),f=0;for(d=p?d:d[Symbol.iterator]();;){var v;if(p){if(f>=d.length)break;v=d[f++]}else{if((f=d.next()).done)break;v=f.value}s[v]=void 0}for(var g in r)r.hasOwnProperty(g)&&(s[g]=r[g]);s.view=this.wnd,s.pageX=i.x,s.pageY=i.y;var m=n.$.Event(o,s);m.timeStamp=t.timeStamp,(0,n.$)(e).trigger(m)},e.prototype.addClass=function(e,t){(0,n.$)(e).addClass(t);var i=this.wnd.getComputedStyle(e);this.cursors.push((0,n.$)(this.bElement).css("cursor")),(0,n.$)(this.bElement).css("cursor",i.getPropertyValue("cursor"))},e.prototype.removeClass=function(e,t){(0,n.$)(e).removeClass(t),(0,n.$)(this.bElement).css("cursor",this.cursors.pop())},e.prototype.enterElement=function(t){this.addClass(t,e.HOVER)},e.prototype.leaveElement=function(t){this.removeClass(t,e.HOVER)},e.prototype.activateElement=function(t){this.addClass(t,e.ACTIVE)},e.prototype.deactivateElement=function(t){this.removeClass(t,e.ACTIVE)},e.prototype.addDocChangeClb=function(e){this.onDocChangeClbs.push(e)},e.prototype.notify=function(){var e=this.onDocChangeClbs,t=Array.isArray(e),i=0;for(e=t?e:e[Symbol.iterator]();;){var n;if(t){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}n(this.wnd,this.doc)}},e.prototype.elementFromPoint=function(e){for(var t=this.doc.body,i=!0;i;){i=!1;for(var o=0;o<t.childNodes.length;++o){var r=t.childNodes[o];if(r instanceof this.wnd.Element){var s=(0,n.$)(r),a=s.offset(),l=s.height(),h=s.width();if(e.x>a.left&&e.x<a.left+h&&e.y>a.top&&e.y<a.top+l){t=r,i=!0;break}}}}return t},e.prototype.getElement=function(e){var t=this.jFrame.offset();this.jFrame.offset({left:.5*window.innerWidth-e.x,top:.5*window.innerHeight-e.y});var i=this.doc.elementFromPoint(e.x,e.y);return i||(i=this.doc.elementFromPoint(e.x,e.y)),this.jFrame.offset(t),i||this.elementFromPoint(e)},e.prototype.simulate=function(e,t,i,n){var o=this.convertCoords(i,n),r=t===this.doc?this.getElement(o):void 0,s=void 0!==r,a=!1;switch(e.type){case"mousedown":this.capElement&&(this.deactivateElement(this.capElement),a=!0),this.capElement=r,this.capElement&&(this.activateElement(this.capElement),a=!0);break;case"mouseup":this.capElement&&(this.deactivateElement(this.capElement),a=!0),this.timeStamp=e.timeStamp;break;case"click":s=r&&this.capElement===r,this.capElement=void 0;break;case"mouseenter":case"mouseover":case"mousemove":var l=null;this.hovElement!==r&&this.hovElement&&(this.triggerEvent(this.hovElement,e,o,"mouseout",{relatedTarget:r||null}),this.leaveElement(this.hovElement),l=this.hovElement,this.hovElement=void 0,a=!0),!this.hovElement&&r&&(this.triggerEvent(r,e,o,"mouseover",{relatedTarget:l}),this.enterElement(r),this.hovElement=r,a=!0),s=r&&"mousemove"===e.type;break;case"mouseleave":case"mouseout":this.hovElement&&(this.triggerEvent(this.hovElement,e,o,"mouseout",{relatedTarget:e.relatedTarget}),this.leaveElement(this.hovElement),this.hovElement=void 0,a=!0),s=!1}s&&this.triggerEvent(r,e,o,e.type),a&&this.notify()},e.prototype.getDefaultUndefinedProperties=function(){return["clientX","clientY","offsetX","offsetY","screenX","screenY"]},e.prototype.getDefaultResendProperties=function(){return["altKey","bubbles","button","buttons","cancelable","changedTouches","char","charCode","ctrlKey","data","detail","eventPhase","isDefaultPrevented","key","keyCode","metaKey","pointerId","pointerType","shiftKey","targetTouches","touches","which"]},e}();o.HOVER="SIMULATED-HOVER",o.ACTIVE="SIMULATED-ACTIVE",t.default=o},function(e,t,i){"use strict";t.__esModule=!0,t.default=function e(t,i,n){function o(e,t){return t=t||{},Promise.resolve(e).then(function(e){return s(e,t.filter,!0)}).then(a).then(l).then(function(e){return t.bgcolor&&(e.style.backgroundColor=t.bgcolor),t.width&&(e.style.width=t.width+"px"),t.height&&(e.style.height=t.height+"px"),t.style&&h.window.Object.keys(t.style).forEach(function(i){e.style[i]=t.style[i]}),e}).then(function(i){return function(e,t,i){return Promise.resolve(e).then(function(e){return e.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),(new h.window.XMLSerializer).serializeToString(e)}).then(c.escapeXhtml).then(function(e){return["data:image/svg+xml;charset=utf-8,",'<svg xmlns="http://www.w3.org/2000/svg" width="',t,'" height="',i,'">','<foreignObject x="0" y="0" width="100%" height="100%">',e,"</foreignObject>","</svg>"].join("")})}(i,t.width||c.width(e),t.height||c.height(e))})}function r(e,t){return o(e,t).then(c.makeImage).then(c.delay(100)).then(function(i){var n=function(e){var i=h.document.createElement("canvas");if(i.width=t.width||c.width(e),i.height=t.height||c.height(e),t.bgcolor){var n=i.getContext("2d");n.fillStyle=t.bgcolor,n.fillRect(0,0,i.width,i.height)}return i}(e);return n.getContext("2d").drawImage(i,0,0),n})}function s(e,t,i){return i||!t||t(e)?Promise.resolve(e).then(function(e){return c.isCanvas(e)?c.makeImage(e.toDataURL()):e.cloneNode(!1)}).then(function(i){return function(e,t,i){var n=e.childNodes;return 0===n.length?Promise.resolve(t):function(e,t,i){var n=Promise.resolve();return t.forEach(function(t){n=n.then(function(){return s(t,i)}).then(function(t){t&&e.appendChild(t)})}),n}(t,c.asArray(n),i).then(function(){return t})}(e,i,t)}).then(function(t){return function(e,t){return c.isElement(t)?Promise.resolve().then(function(){var i,n;i=h.window.getComputedStyle(e),n=t.style,i.cssText?n.cssText=i.cssText:function(e,t){c.asArray(e).forEach(function(i){t.setProperty(i,e.getPropertyValue(i),e.getPropertyPriority(i))})}(i,n)}).then(function(){[":before",":after"].forEach(function(i){!function(i){var n=h.window.getComputedStyle(e,i),o=n.getPropertyValue("content");if(""!==o&&"none"!==o){var r=c.uid();t.className=t.className+" "+r;var s=h.document.createElement("style");s.appendChild(function(e,t,i){var n="."+e+":"+t,o=i.cssText?function(e){var t=e.getPropertyValue("content");return e.cssText+" content: "+t+";"}(i):function(e){return c.asArray(e).map(function(t){return t+": "+e.getPropertyValue(t)+(e.getPropertyPriority(t)?" !important":"")}).join("; ")+";"}(i);return h.document.createTextNode(n+"{"+o+"}")}(r,i,n)),t.appendChild(s)}}(i)})}).then(function(){c.isTextArea(e)&&(t.innerHTML=e.value),c.isInput(e)&&t.setAttribute("value",e.value)}).then(function(){c.isSVG(t)&&(t.setAttribute("xmlns","http://www.w3.org/2000/svg"),c.isSVGRect(t)&&["width","height"].forEach(function(e){var i=t.getAttribute(e);i&&t.style.setProperty(e,i)}))}).then(function(){return t}):t}(e,t)}):Promise.resolve()}function a(e){return d.resolveAll().then(function(t){var i=h.document.createElement("style");return e.appendChild(i),i.appendChild(h.document.createTextNode(t)),e})}function l(e){return p.inlineAll(e).then(function(){return e})}!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var h=this;this.window=t,this.document=i,this.cache=n;var c=function(){function e(e){var t=/\.([^\.\/]*?)$/g.exec(e);return t?t[1]:""}function t(e,t){var i=h.window.getComputedStyle(e).getPropertyValue(t);return parseFloat(i.replace("px",""))}return{escape:function(e){return e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")},parseExtension:e,mimeType:function(t){var i;return(i="application/font-woff",{woff:i,woff2:i,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"})[e(t).toLowerCase()]||""},dataAsUrl:function(e,t){return["data:",t,";base64,",e].join("")},isDataUrl:function(e){return-1!==e.search(/^(data:)/)},canvasToBlob:function(e){return e.toBlob?new Promise(function(t){e.toBlob(t)}):function(e){return new Promise(function(t){for(var i=h.window.atob(e.toDataURL().split(",")[1]),n=i.length,o=new h.window.Uint8Array(n),r=0;r<n;r++)o[r]=i.charCodeAt(r);t(new h.window.Blob([o],{type:"image/png"}))})}(e)},resolveUrl:function(e,t){var i=h.document.implementation.createHTMLDocument(),n=i.createElement("base");i.head.appendChild(n);var o=i.createElement("a");return i.body.appendChild(o),n.href=t,o.href=e,o.href},getAndEncode:function(e){var t=h.cache.get(e);return t?t.content?t.content:new Promise(function(e){t.content?e(t.content):t.pendings.push(e)}):(t=h.cache.put(e,{pendings:[]}),new Promise(function(i){function n(e){console.error(e),i("")}var o=new h.window.XMLHttpRequest;o.onreadystatechange=function(){if(4===o.readyState){if(200!==o.status)return void n("cannot fetch resource: "+e+", status: "+o.status);var r=new h.window.FileReader;r.onloadend=function(){t.content=r.result.split(/,/)[1];var e=t.pendings,n=Array.isArray(e),o=0;for(e=n?e:e[Symbol.iterator]();;){var s;if(n){if(o>=e.length)break;s=e[o++]}else{if((o=e.next()).done)break;s=o.value}s(t.content)}t.pendings=[],i(t.content)},r.readAsDataURL(o.response)}},o.ontimeout=function(){n("timeout of 30000ms occured while fetching resource: "+e)},o.responseType="blob",o.timeout=3e4,o.open("GET",e,!0),o.send()}))},uid:(i=0,function(){return"u"+("0000"+(h.window.Math.random()*h.window.Math.pow(36,4)|0).toString(36)).slice(-4)+i++}),delay:function(e){return function(t){return new Promise(function(i){setTimeout(function(){i(t)},e)})}},asArray:function(e){for(var t=[],i=e.length,n=0;n<i;n++)t.push(e[n]);return t},escapeXhtml:function(e){return e.replace(/(#|\n)/g,function(e){return"#"===e?"%23":"%0A"})},makeImage:function(e){return new Promise(function(t,i){var n=new h.window.Image;n.onload=function(){t(n)},n.onerror=i,n.src=e})},width:function(e){var i=t(e,"border-left-width"),n=t(e,"border-right-width");return e.scrollWidth+i+n},height:function(e){var i=t(e,"border-top-width"),n=t(e,"border-bottom-width");return e.scrollHeight+i+n},isElement:function(e){return e instanceof h.window.Element},isCanvas:function(e){return e instanceof h.window.HTMLCanvasElement},isTextArea:function(e){return e instanceof h.window.HTMLTextAreaElement},isInput:function(e){return e instanceof h.window.HTMLInputElement},isSVG:function(e){return e instanceof h.window.SVGElement},isSVGRect:function(e){return e instanceof h.window.SVGRectElement},isImage:function(e){return e instanceof h.window.HTMLImageElement}};var i}(),u=function(){function e(e){return-1!==e.search(n)}function t(e){for(var t=[],i=void 0;null!==(i=n.exec(e));)t.push(i[1]);return t.filter(function(e){return!c.isDataUrl(e)})}function i(e,t,i,n){return Promise.resolve(t).then(function(e){return i?c.resolveUrl(e,i):e}).then(n||c.getAndEncode).then(function(e){return c.dataAsUrl(e,c.mimeType(t))}).then(function(i){return e.replace(function(e){return new h.window.RegExp(["(url\\(['\"]?)(",c.escape(e),")(['\"]?\\))"].join(""),"g")}(t),["$1",i,"$3"].join(""))})}var n=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:function(n,o,r){return e(n)?Promise.resolve(n).then(t).then(function(e){var t=Promise.resolve(n);return e.forEach(function(e){t=t.then(function(t){return i(t,e,o,r)})}),t}):Promise.resolve(n)},shouldProcess:e,impl:{readUrls:t,inline:i}}}(),d=function(){function e(){function e(e){return{resolve:function(){var t=(e.parentStyleSheet||{}).href;return u.inlineAll(e.cssText,t)},src:function(){return e.style.getPropertyValue("src")}}}return Promise.resolve(c.asArray(h.document.styleSheets)).then(function(e){var t=[];return e.forEach(function(e){try{c.asArray(e.cssRules||[]).forEach(t.push.bind(t))}catch(t){console.log("Error while reading CSS rules from "+e.href,t.toString())}}),t}).then(function(e){return e.filter(function(e){return e.type===CSSRule.FONT_FACE_RULE}).filter(function(e){return u.shouldProcess(e.style.getPropertyValue("src"))})}).then(function(t){return t.map(e)})}return{resolveAll:function(){return e(h.document).then(function(e){return Promise.all(e.map(function(e){return e.resolve()}))}).then(function(e){return e.join("\n")})},impl:{readAll:e}}}(),p=function(){function e(e){return{inline:function(t){return c.isDataUrl(e.src)?Promise.resolve():Promise.resolve(e.src).then(t||c.getAndEncode).then(function(t){return c.dataAsUrl(t,c.mimeType(e.src))}).then(function(t){return new Promise(function(i,n){e.onload=i,e.onerror=n,e.src=t})})}}}return{inlineAll:function t(i){return c.isElement(i)?function(e){var t=e.style.getPropertyValue("background");return t?u.inlineAll(t).then(function(t){e.style.setProperty("background",t,e.style.getPropertyPriority("background"))}).then(function(){return e}):Promise.resolve(e)}(i).then(function(){return c.isImage(i)?e(i).inline():Promise.all(c.asArray(i.childNodes).map(function(e){return t(e)}))}):Promise.resolve(i)},impl:{newImage:e}}}();this.toSvg=o,this.toPng=function(e,t){return r(e,t||{}).then(function(e){return e.toDataURL()})},this.toJpeg=function(e,t){return r(e,t=t||{}).then(function(e){return e.toDataURL("image/jpeg",t.quality||1)})},this.toBlob=function(e,t){return r(e,t||{}).then(c.canvasToBlob)},this.toPixelData=function(e,t){return r(e,t||{}).then(function(t){return t.getContext("2d").getImageData(0,0,c.width(e),c.height(e)).data})},this.impl={fontFaces:d,images:p,util:c,inliner:u}}},function(e,t,i){"use strict";t.__esModule=!0;var n=i(0),o=function(){function e(t,i,o){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.wnd=t,this.doc=i,this.visual=o,this.coords=new n.THREE.Vector2,this.intersection=new n.THREE.Vector3,this.raycaster=this.visual.raycaster,this.camera=this.visual.camera,this.plane=new n.THREE.Plane,this.threes=[],this.selected=null,this.enabled=!0,this.controlsState=this.visual.getControlsState(),this.element=this.visual.element,this.binds={onMouseMove:this.onMouseMove.bind(this),onMouseDown:this.onMouseDown.bind(this),onMouseUp:this.onMouseUp.bind(this)},(0,n.$)(this.element).on("mousemove",this.binds.onMouseMove),(0,n.$)(this.element).on("mousedown",this.binds.onMouseDown),(0,n.$)(this.doc).on("mouseup",this.binds.onMouseUp)}return e.prototype.addThree=function(e){this.threes.push(e)},e.prototype.removeThree=function(e){var t=this.threes.indexOf(e);~t&&this.threes.splice(t,1)},e.prototype.onPickCallback=function(){return!0},e.prototype.onDragCallback=function(){return!0},e.prototype.onReleaseCallback=function(){},e.prototype.dispose=function(){(0,n.$)(this.element).off("mousemove",this.binds.onMouseMove),(0,n.$)(this.element).off("mousedown",this.binds.onMouseDown),(0,n.$)(this.doc).off("mouseup",this.binds.onMouseUp)},e.prototype.setCoordsFromEvent=function(e){var t=(0,n.$)(this.element),i=t.offset();return this.coords.x=(e.pageX-i.left)/t.width()*2-1,this.coords.y=-(e.pageY-i.top)/t.height()*2+1,this.coords},e.prototype.onMouseDown=function(e){if(this.enabled){this.selected&&this.onMouseUp(e),this.setCoordsFromEvent(e),this.raycaster.setFromCamera(this.coords,this.camera);var t=this.raycaster.intersectObjects(this.threes);if(t.length>0){var i=t[0].object;if(!this.onPickCallback(t[0]))return;var n=t[0].point.clone();this.distance=n.sub(this.raycaster.ray.origin).length(),this.controlsState=this.visual.getControlsState(),this.visual.setControlsState(!1),this.plane.setFromNormalAndCoplanarPoint(this.visual.camera.getWorldDirection(this.plane.normal),t[0].point),this.selected=i}}},e.prototype.onMouseMove=function(e){this.enabled&&(e.preventDefault(),this.selected&&(this.setCoordsFromEvent(e),this.raycaster.setFromCamera(this.coords,this.camera),this.raycaster.ray.intersectPlane(this.plane,this.intersection)&&(this.onDragCallback(this.intersection)||this.onMouseUp(e))))},e.prototype.onMouseUp=function(e){this.selected&&(this.onReleaseCallback(),this.selected=null,this.visual.setControlsState(this.controlsState)),this.enabled&&e.preventDefault()},e}();t.default=o},function(e,t,i){"use strict";t.__esModule=!0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},o=i(0);i(74)(o.$);var r=function(){function e(t,i){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.actions=i||{},this.element=t,this.doc=t[0].ownerDocument,this.wnd=this.doc.defaultView,this.enabled=!0,this.binds={contextMenu:this.contextMenu.bind(this),mouseDown:this.mouseDown.bind(this),mouseMove:this.mouseMove.bind(this),mouseUp:this.mouseUp.bind(this),mouseWheel:this.mouseWheel.bind(this),mouseMoveDoc:this.mouseMoveDoc.bind(this),mouseUpDoc:this.mouseUpDoc.bind(this),click:this.click.bind(this),dblclick:this.dblclick.bind(this),touchStart:this.touchStart.bind(this),touchMove:this.touchMove.bind(this),touchEnd:this.touchEnd.bind(this),keyDown:this.keyDown.bind(this),keyPress:this.keyPress.bind(this),keyUp:this.keyUp.bind(this)},this.element.on("contextmenu",this.binds.contextMenu),this.element.on("mousedown",this.binds.mouseDown),this.element.on("mousemove",this.binds.mouseMove),this.element.on("mouseup",this.binds.mouseUp),this.element.on("mousewheel",this.binds.mouseWheel),(0,o.$)(this.doc).on("mousemove",this.binds.mouseMoveDoc),(0,o.$)(this.doc).on("mouseup",this.binds.mouseUpDoc),this.element.on("click",this.binds.click),this.element.on("dblclick",this.binds.dblclick),this.element.on("touchstart",this.binds.touchStart),this.element.on("touchmove",this.binds.touchMove),this.element.on("touchend",this.binds.touchEnd),(0,o.$)(this.wnd).on("keydown",this.binds.keyDown),(0,o.$)(this.wnd).on("keypress",this.binds.keyPress),(0,o.$)(this.wnd).on("keyup",this.binds.keyUp)}return e.getEventFlags=function(e){return e.ctrlKey|e.shiftKey<<1|e.altKey<<2},e.getPosition=function(e){var t=void 0,i=void 0;return 2===e.length?(t=e[1].pageX-e[0].pageX,i=e[1].pageY-e[0].pageY):(t=e[0].pageX,i=e[0].pageY),{x:t,y:i}},e.prototype.addAction=function(e,t,i,n){t=t.toLowerCase(),this.actions[t]||(this.actions[t]={}),this.actions[t][i]||(this.actions[t][i]={}),this.actions[t][i][n]||(this.actions[t][i][n]=[]),this.actions[t][i][n].push(e)},e.prototype.getActions=function(e,t,i){return((this.actions[e]||{})[t]||{})[i]||[]},e.prototype.fireActions=function(e,t,i){var n=e,o=Array.isArray(n),r=0;for(n=o?n:n[Symbol.iterator]();;){var s;if(o){if(r>=n.length)break;s=n[r++]}else{if((r=n.next()).done)break;s=r.value}s(t,i)}},e.prototype.contextMenu=function(t){if(this.enabled){var i=e.getEventFlags(t);this.fireActions(this.getActions("contextmenu",t.button,i),t)}},e.prototype.mouseDown=function(t){if(this.picked&&this.mouseUpDoc(),this.enabled){var i=e.getEventFlags(t);this.fireActions(this.getActions("mousedown",t.button,i),t),this.picked={x:t.pageX,y:t.pageY,actions:this.getActions("mousedrag",t.button,i)},this.fireActions(this.picked.actions,t,{state:"start"})}},e.prototype.mouseMove=function(t){if(this.enabled){var i=e.getEventFlags(t);this.fireActions(this.getActions("mousemove",t.button,i),t)}},e.prototype.mouseMoveDoc=function(e){this.enabled&&this.picked&&(this.fireActions(this.picked.actions,e,{state:"move",dx:e.pageX-this.picked.x,dy:e.pageY-this.picked.y}),this.picked={x:e.pageX,y:e.pageY,actions:this.picked.actions})},e.prototype.mouseUp=function(t){if(this.enabled){var i=e.getEventFlags(t);this.fireActions(this.getActions("mouseup",t.button,i),t)}},e.prototype.mouseUpDoc=function(e){this.picked&&(this.fireActions(this.picked.actions,e,{state:"end"}),delete this.picked)},e.prototype.mouseWheel=function(t){if(this.enabled){var i=e.getEventFlags(t);this.fireActions(this.getActions("mousewheel",0,i),t)}},e.prototype.clicks=function(t,i){if(this.enabled){var n=e.getEventFlags(t);this.fireActions(this.getActions(i,t.button,n),t)}},e.prototype.click=function(e){this.clicks(e,"click")},e.prototype.dblclick=function(e){this.clicks(e,"dblclick")},e.prototype.touchPick=function(t,i,o){var r=e.getPosition(o);this.touchPicked=n({},r,{actions:this.getActions("touchdrag",o.length,i),code:o.length,flags:i}),this.fireActions(this.touchPicked.actions,t,n({state:"start"},r))},e.prototype.touchStart=function(t){if(this.touchPicked&&this.touchEnd(t),this.enabled){var i=e.getEventFlags(t),n=t.touches||t.originalEvent.touches;this.fireActions(this.getActions("touchstart",n.length,i),t),this.touchPick(t,i,n)}},e.prototype.touchMove=function(t){if(this.enabled){var i=e.getEventFlags(t),o=t.touches||t.originalEvent.touches;if(this.fireActions(this.getActions("touchmove",o.length,i),t),this.touchPicked)if(this.touchPicked.code===o.length&&this.touchPicked.flags===i){var r=e.getPosition(o);this.fireActions(this.touchPicked.actions,t,n({state:"move",dx:r.x-this.touchPicked.x,dy:r.y-this.touchPicked.y},r)),this.touchPicked=n({},this.touchPicked,r)}else this.touchEnd(t),this.touchPick(t,i,o)}},e.prototype.touchEnd=function(e){this.touchPicked&&(this.fireActions(this.touchPicked.actions,e,{state:"end"}),delete this.touchPicked)},e.prototype.key=function(t,i){if(this.enabled){var n=e.getEventFlags(t);this.fireActions(this.getActions(i,t.keyCode,n),t)}},e.prototype.keyDown=function(e){this.key(e,"keydown")},e.prototype.keyPress=function(e){this.key(e,"keypress")},e.prototype.keyUp=function(e){this.key(e,"keyup")},e.prototype.dispose=function(){this.element.off("contextmenu",this.binds.contextMenu),this.element.off("mousedown",this.binds.mouseDown),this.element.off("mousemove",this.binds.mouseMove),this.element.off("mouseup",this.binds.mouseUp),this.element.off("mousewheel",this.binds.mouseWheel),(0,o.$)(this.doc).off("mousemove",this.binds.mouseMoveDoc),(0,o.$)(this.doc).off("mouseup",this.binds.mouseUpDoc),this.element.off("click",this.binds.click),this.element.off("dblclick",this.binds.dblclick),this.element.off("touchstart",this.binds.touchStart),this.element.off("touchmove",this.binds.touchMove),this.element.off("touchend",this.binds.touchEnd),(0,o.$)(this.wnd).off("keydown",this.binds.keyDown),(0,o.$)(this.wnd).off("keypress",this.binds.keyPress),(0,o.$)(this.wnd).off("keyup",this.binds.keyUp)},e}();r.modKeys={Ctrl:1,Shift:2,Alt:4},r.mouseButtons={Left:0,Middle:1,Right:2},t.default=r},function(e,t,i){"use strict";t.__esModule=!0;var n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.available=function(){return e._hasWebkitFullScreen||e._hasMozFullScreen||e._hasMsFullscreen},e.activated=function(){return e._hasWebkitFullScreen?document.webkitIsFullScreen:e._hasMozFullScreen?document.mozFullScreen:e._hasMsFullscreen?!!document.msFullscreenElement:void console.assert(!1)},e.addEventListener=function(e,t){e.addEventListener&&(e.addEventListener("webkitfullscreenchange",t,!1),e.addEventListener("mozfullscreenchange",t,!1),e.addEventListener("fullscreenchange",t,!1),e.addEventListener("MSFullscreenChange",t,!1))},e.removeEventListener=function(e,t){e.removeEventListener&&(e.removeEventListener("webkitfullscreenchange",t,!1),e.removeEventListener("mozfullscreenchange",t,!1),e.removeEventListener("fullscreenchange",t,!1),e.removeEventListener("MSFullscreenChange",t,!1))},e.request=function(t){t=t||document.body,e._hasWebkitFullScreen?t.webkitRequestFullScreen():e._hasMozFullScreen?t.mozRequestFullScreen():e._hasMsFullscreen?t.msRequestFullscreen():console.assert(!1)},e.cancel=function(){e._hasWebkitFullScreen?document.webkitCancelFullScreen():e._hasMozFullScreen?document.mozCancelFullScreen():e._hasMsFullscreen?document.msExitFullscreen():console.assert(!1)},e}();n._hasWebkitFullScreen=!!document.webkitCancelFullScreen,n._hasMozFullScreen=!!document.mozCancelFullScreen,n._hasMsFullscreen=!!document.documentElement.msRequestFullscreen,t.default=n},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o=i(0),r=n(i(6)),s=n(i(2)),a=n(i(50)),l=n(i(49)),h=function(e){function t(i,n,r,h,c,u,d){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var p=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,i,n,r,h));p.iId="i"+s.default.getUnique();var f=(0,o.$)('<iframe id="'+p.iId+'" src="'+c+'" style="position: fixed; left: -1000px;"></iframe>');return(0,o.$)(p.doc.body).append(f),p.frame=f[0],p.binds={},d&&d(p.frame.contentWindow),p.doc.implementation.hasFeature("www.http://w3.org/TR/SVG11/feature#Extensibility","1.1")&&(p.image=new Image,p.binds.imageLoad=function(){p.renderImage(p.image),p.finishRender()},(0,o.$)(p.image).on("load",p.binds.imageLoad),p.svgRender=new a.default(p.frame.contentWindow,p.frame.contentDocument,u)),p.binds.frameLoad=function(){~p.frame.contentDocument.title.indexOf("404")?(p.startRender=function(){p.renderNotFoundPage(),p.finishRender()},p.finishLoad()):setTimeout(function(){p.frame&&(p.width=(0,o.$)(p.frame.contentDocument.body).width(),p.height=(0,o.$)(p.frame.contentDocument.body).height(),p.resH=p.height/p.width*p.resW,f.css("width",p.width+"px").css("height",p.height+"px"),f.offset({left:-p.width-100,top:0}),p.svgRender&&(p.simulator=new l.default(f,p.frame.contentDocument.body,p.element),p.simulator.addDocChangeClb(p.finishLoad.bind(p))),p.startRender=function(){p.render()},p.finishLoad())},500)},(0,o.$)(p.frame.contentWindow).on("load",p.binds.frameLoad),p}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.getSimulatedDoc=function(){return this.frame.contentDocument},t.prototype.render=function(){var e=this;this.svgRender?this.svgRender.toSvg(this.simulator.element,{height:this.height+"px",width:this.width+"px"}).then(function(t){e.image.src=t}).catch(function(t){console.error("Dom2Image: ",t),e.renderBlankPage(),e.finishRender()}):(0,o.html2canvas)(this.frame.contentDocument.body,{timeout:3e4}).then(function(t){e.renderImage(t),e.finishRender()})},t.prototype.dispose=function(){(0,o.$)(this.image).off("load",this.binds.imageLoad),(0,o.$)(this.frame.contentWindow).off("load",this.binds.frameLoad),(0,o.$)(this.doc.body).find("#"+this.iId).remove(),this.image&&(this.image.src="",delete this.image),this.frame.src="",delete this.frame,e.prototype.dispose.call(this)},t.prototype.simulate=function(e,t,i,n){this.simulator&&this.simulator.simulate(e,t,i,n)},t}(r.default);t.default=h},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o=i(0),r=n(i(4)),s=n(i(5)),a=function(){function e(t,i,n){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.c=r.default.createCanvas(t,i),this.p={g:9.8,dt:1/60,color:n,updateInterval:.25},this.ctx=this.c.getContext("2d"),this.os=[-2,Math.PI/2],this.t=this.p.updateInterval}return e.prototype.dy=function(e,t){var i=t[0],n=t[1];return[-this.g*Math.cos(n),i]},e.prototype.integrate=function(e){for(var t=0,i=this.p.dt,n=this.os;t<e;)t+i>e&&(i=e-t),n=s.default.rk4(this.dy.bind({g:this.p.g}),0,i,n),t+=i;return n},e.prototype.calcTimeTo=function(e){for(var t=0,i=this.p.dt,n=this.os;Math.abs(n[1]-e)>1e-4;){var o=s.default.rk4(this.dy.bind({g:this.p.g}),0,i,n);o[0]<0&&o[1]<e||o[0]>0&&o[1]>e?i/=2:(n=o,t+=i)}return t},e.prototype.update=function(e){if(this.os=this.integrate(e),this.t+=e,this.t>=this.p.updateInterval){this.t=0;var t=.04*Math.min(this.c.width,this.c.height),i=this.os[1],n=.5*this.c.width,s=.5*this.c.height,a=this.ctx;a.clearRect(0,0,this.c.width,this.c.height),a.beginPath(),a.fillStyle=r.default.color2Rgba(this.p.color,1),a.rect(0,0,this.c.width,this.c.height),a.fill(),a.beginPath(),a.shadowBlur=50,a.fillStyle=r.default.color2Rgba(r.default.inverseColor(this.p.color,.9),Math.abs(this.os[0]/6.36)),a.shadowColor=r.default.color2Rgba(r.default.inverseColor(this.p.color,1),.9),a.shadowOffsetX=0,a.shadowOffsetY=0,a.font="bold "+Math.round(.25*t)+"px Arial",a.textAlign="center",a.textBaseline="middle",a.fillText((0,o.tr)("Loading..."),n,s);var l=2*Math.PI/10;a.shadowColor=r.default.color2Rgba(r.default.inverseColor(this.p.color,1),.7);for(var h=0,c=i,u=.2*t;h<10;++h,u*=.9,c+=l){a.beginPath(),a.fillStyle=r.default.color2Rgba(r.default.inverseColor(this.p.color,(10-h)/10),.7*(10-h)/10);var d=n+t*Math.cos(c),p=s-t*Math.sin(c),f=n+t*Math.cos(c+l),v=s-t*Math.sin(c+l);a.shadowOffsetX=.2*(f-d),a.shadowOffsetY=.2*(v-p),a.arc(d,p,u,0,2*Math.PI,1),a.fill()}this.onChange&&this.onChange(this.c,this.p.color)}},e.prototype.getImage=function(){return this.c},e.prototype.dispose=function(){this.c.width=0,this.c.height=0,delete this.ctx,delete this.c},e.prototype.createSprite=function(e){var t=r.default.createCanvas(this.c.width*e,this.c.height),i=t.getContext("2d"),n=this.calcTimeTo(this.os[1]+2*Math.sign(this.os[0])*Math.PI)/(e+1),o=this.p.updateInterval;this.p.updateInterval=0;for(var s=0;s<e;++s)this.update(n),i.drawImage(this.c,s*this.c.width,0);return this.p.updateInterval=o,t},e}();t.default=a},function(e,t,i){"use strict";t.__esModule=!0;var n=(i(0),function(){function e(t){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.view=t,this.progress=0,this.showProgress=i,this.getLoadingMsg=n||e.defaultLoadingMsg,this.updateView()}return e.defaultLoadingMsg=function(e){return["Please wait... the Application is Loading: ",e,"%"].join("")},e.prototype.dispose=function(){this.showProgress=!1,this.updateView(),delete this.view},e.prototype.setProgress=function(e){this.progress=e,this.updateView()},e.prototype.updateView=function(){if(this.view){this.view.setState("widLoadingProgress",{enable:!0,visible:this.showProgress,active:!1}),this.view.setState("txtLoadingProgress",{value:this.getLoadingMsg(this.progress),visible:!0});var e=this.view.getLinks(),t=Array.isArray(e),i=0;for(e=t?e:e[Symbol.iterator]();;){var n;if(t){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}var o=n;this.view.setState(o,{enable:!1,visible:!0,active:!1})}this.view.setState("inpPages",{visible:!0,value:""}),this.view.setState("inpPage",{visible:!0,enable:!1,value:""})}},e}());t.default=n},function(e,t,i){"use strict";t.__esModule=!0;var n,o=i(0),r=function(e){function t(i,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var s=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,i,n));return s.element=r,s.binds={convert:s.convert.bind(s)},(0,o.$)(s.element).on("mousemove mousedown mouseover mouseout click",s.binds.convert),(0,o.$)(s.doc).on("mouseup",s.binds.convert),s}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.dispose=function(){(0,o.$)(this.element).off("mousemove mousedown mouseover mouseout click",this.binds.convert),(0,o.$)(this.doc).off("mouseup",this.binds.convert)},t}(((n=i(7))&&n.__esModule?n:{default:n}).default);t.default=r},function(e,t,i){"use strict";t.__esModule=!0;var n,o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},r=i(0),s=(n=i(5))&&n.__esModule?n:{default:n},a=function(){function e(t,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.testScale;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.visual=t,this.boundBoxClb=i,this.testScale=n,this.camera=t.camera,this.element=this.visual.element,this.elementSize={w:1,h:1},this.orbit=t.getOrbit(),this.scale=1,this.padding=0,this.eps=1e-4,this.v=new r.THREE.Vector3,this.dv=new r.THREE.Vector2,this.enabled=!1,t.addRenderCallback(this.update.bind(this)),this.os={vx:0,vy:0,x:0,y:0},this.orbit.update(),this.camera.updateMatrixWorld();var o=this.computeClientBoundBox();this.movePan({x:-1.11*o.mid.x,y:-1.11*o.mid.y})}return e.prototype.setPadding=function(e){this.padding=e},e.prototype.movePan=function(e){this.orbit.pan(e.x*this.visual.width(),-e.y*this.visual.height())},e.prototype.vToCamera=function(e){return e.project(this.camera),{x:.5*e.x,y:.5*e.y}},e.prototype.computeClientBoundBox=function(){var e=this.boundBoxClb(),t=[e.min.x,e.max.x],i=[0,0],n=[e.min.z,e.max.z],o=[],r={max:{},min:{}},s=t,a=Array.isArray(s),l=0;for(s=a?s:s[Symbol.iterator]();;){var h;if(a){if(l>=s.length)break;h=s[l++]}else{if((l=s.next()).done)break;h=l.value}var c=h,u=i,d=Array.isArray(u),p=0;for(u=d?u:u[Symbol.iterator]();;){var f;if(d){if(p>=u.length)break;f=u[p++]}else{if((p=u.next()).done)break;f=p.value}var v=f,g=n,m=Array.isArray(g),b=0;for(g=m?g:g[Symbol.iterator]();;){var y;if(m){if(b>=g.length)break;y=g[b++]}else{if((b=g.next()).done)break;y=b.value}var w=y;o.push(this.vToCamera(this.v.set(c,v,w)))}}}return o.sort(function(e,t){return e.x-t.x}),r.min.x=o[0].x,r.max.x=o[o.length-1].x,o.sort(function(e,t){return e.y-t.y}),r.min.y=o[0].y,r.max.y=o[o.length-1].y,r.width=r.max.x-r.min.x,r.height=r.max.y-r.min.y,r.mid={x:.5*(r.max.x+r.min.x),y:.5*(r.max.y+r.min.y)},r},e.prototype.setObject=function(e){this.boundBoxClb=e},e.prototype.testScale=function(){return!0},e.prototype.computeCorr=function(e,t,i){var n=0;return e<1?t>-.5?n=-.5-t:i<.5&&(n=.5-i):t<-.5?n=-.5-t:i>.5&&(n=.5-i),n},e.prototype.centerView=function(e){var t=this.computeClientBoundBox(),i=this.elementSize.w/t.width,n=this.elementSize.h/t.height,r=Math.min(i,n),s=!1;if(this.testScale()&&Math.abs(1/r-this.scale)>this.eps){var a=1/r+.2*(this.scale-1/r);this.orbit.setScale(this.orbit.getScale()/(r*a)),this.orbit.update(),this.camera.updateMatrixWorld(),t=this.computeClientBoundBox(),i=this.elementSize.w/t.width,n=this.elementSize.h/t.height,r=Math.min(i,n),s=!0}var l=this.dv;if(r>1-this.eps)if(this.padding){var h=this.visual.height(),c=.5*(n-1)/n,u=this.padding/h,d=Math.max(0,Math.abs(u)-c);l.set(-t.mid.x,-Math.sign(u)*Math.min(Math.max(0,c-20/h),d)-t.mid.y)}else l.set(-t.mid.x,-t.mid.y);else{var p=70/this.visual.width(),f=70/this.visual.height();l.set(this.computeCorr(i,t.min.x-p,t.max.x+p),this.computeCorr(n,t.min.y-f,t.max.y+f))}if(Math.sqrt(this.os.vx*this.os.vx+this.os.vy*this.os.vy)>.003||l.length()>.003){var v=1/60,g=0,m=o({},this.os,{x:0,y:0});for(m.tf=function(e,t,i,n){return{x:75*(l.x-i),y:75*(l.y-n)}};g<e;)g+v>e&&(v=e-g),m=this.integrate(m,v),g+=v;this.movePan(m),this.os=m,s=!0}this.orbit.setMoving(s)},e.prototype.integrate=function(e,t){var i=s.default.rk4(this.dy.bind(e),0,t,[e.vx,e.vy,e.x,e.y]),n=i[0],r=i[1],a=i[2],l=i[3];return o({},e,{vx:n,vy:r,x:a,y:l})},e.prototype.dy=function(e,t){var i=t[0],n=t[1],o=t[2],r=t[3],s=this.tf(i,n,o,r);return[s.x-15*i,s.y-15*n,i,n]},e.prototype.update=function(e){this.enabled&&this.boundBoxClb&&this.centerView(e)},e}();t.default=a},function(e,t,i){"use strict";t.__esModule=!0;var n=i(0),o=function(e){function t(i,o){function r(){return Math.pow(.95,g.zoomSpeed)}function s(e){w.theta-=e}function a(e){g.object instanceof n.THREE.PerspectiveCamera?k/=e:g.object instanceof n.THREE.OrthographicCamera?(g.object.zoom=Math.max(g.minZoom,Math.min(g.maxZoom,g.object.zoom*e)),g.object.updateProjectionMatrix(),P=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type-dolly/zoom disabled."),g.enableZoom=!1)}function l(e){g.object instanceof n.THREE.PerspectiveCamera?k*=e:g.object instanceof n.THREE.OrthographicCamera?(g.object.zoom=Math.max(g.minZoom,Math.min(g.maxZoom,g.object.zoom/e)),g.object.updateProjectionMatrix(),P=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type-dolly/zoom disabled."),g.enableZoom=!1)}!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var h,c,u,d,p,f=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this));f.moving=!1,f.object=i,f.world=o,f.enabled=!0,f.target=new n.THREE.Vector3,f.minDistance=0,f.maxDistance=1/0,f.minZoom=0,f.maxZoom=1/0,f.minPolarAngle=0,f.maxPolarAngle=Math.PI,f.minAzimuthAngle=-1/0,f.maxAzimuthAngle=1/0,f.enableDamping=!1,f.dampingFactor=.25,f.enableZoom=!0,f.zoomSpeed=1,f.enableRotate=!0,f.rotateSpeed=1,f.enablePan=!0,f.autoRotate=!1,f.autoRotateSpeed=2,f.target0=f.target.clone(),f.position0=f.object.position.clone(),f.zoom0=f.object.zoom,f.getPolarAngle=function(){return y.phi},f.getAzimuthalAngle=function(){return y.theta},f.reset=function(){g.target.copy(g.target0),g.object.position.copy(g.position0),g.object.zoom=g.zoom0,g.object.updateProjectionMatrix(),g.dispatchEvent(m),g.update()},f.zoomOut=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.zoomSpeed,t=this.zoomSpeed;this.zoomSpeed=e,a(r()),this.zoomSpeed=t},f.zoomIn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.zoomSpeed,t=this.zoomSpeed;this.zoomSpeed=e,l(r()),this.zoomSpeed=t},f.getScale=function(){return k},f.setScale=function(e){k=e},f.update=(h=new n.THREE.Vector3,c=(new n.THREE.Quaternion).setFromUnitVectors(i.up,new n.THREE.Vector3(0,1,0)),u=c.clone().inverse(),d=new n.THREE.Vector3,p=new n.THREE.Quaternion,function(){var e=g.object.position;return h.copy(e).sub(g.target),h.applyQuaternion(c),y.setFromVector3(h),g.autoRotate&&s(2*Math.PI/60/60*g.autoRotateSpeed),y.theta+=w.theta,y.phi+=w.phi,y.theta=Math.max(g.minAzimuthAngle,Math.min(g.maxAzimuthAngle,y.theta)),y.phi=Math.max(g.minPolarAngle,Math.min(g.maxPolarAngle,y.phi)),y.makeSafe(),y.radius*=k,y.radius=Math.max(g.minDistance,Math.min(g.maxDistance,y.radius)),g.target.add(x),h.setFromSpherical(y),h.applyQuaternion(u),e.copy(g.target).add(h),g.object.lookAt(g.target),!0===g.enableDamping?(w.theta*=1-g.dampingFactor,w.phi*=1-g.dampingFactor):w.set(0,0,0),k=1,x.set(0,0,0),!!(P||d.distanceToSquared(g.object.position)>b||8*(1-p.dot(g.object.quaternion))>b)&&(g.dispatchEvent(m),d.copy(g.object.position),p.copy(g.object.quaternion),P=!1,!0)}),f.dispose=function(){};var v,g=f,m={type:"change"},b=1e-6,y=new n.THREE.Spherical,w=new n.THREE.Spherical,k=1,x=new n.THREE.Vector3,P=!1,C=(v=new n.THREE.Vector3,function(e,t){v.setFromMatrixColumn(t,0),v.multiplyScalar(-e),x.add(v)}),_=function(){var e=new n.THREE.Vector3;return function(t,i){e.setFromMatrixColumn(i,1),e.multiplyScalar(t),x.add(e)}}();return g.pan=function(){var e=new n.THREE.Vector3;return function(t,i){var o=g.world.width(),r=g.world.height();if(g.object instanceof n.THREE.PerspectiveCamera){var s=g.object.position;e.copy(s).sub(g.target);var a=e.length();a*=Math.tan(g.object.fov/2*Math.PI/180),C(2*t*a/r,g.object.matrix),_(2*i*a/r,g.object.matrix)}else g.object instanceof n.THREE.OrthographicCamera?(C(t*(g.object.right-g.object.left)/g.object.zoom/o,g.object.matrix),_(i*(g.object.top-g.object.bottom)/g.object.zoom/r,g.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type-pan disabled."),g.enablePan=!1)}}(),f.actions={rotate:function(e,t){if(g.enabled&&g.enableRotate&&"move"===t.state){var i=g.world.width(),n=g.world.height();s(2*Math.PI*t.dx/i*g.rotateSpeed),o=2*Math.PI*t.dy/n*g.rotateSpeed,w.phi-=o,g.update()}var o},pan:function(e,t){g.enabled&&g.enablePan&&"move"===t.state&&(g.pan(t.dx,t.dy),g.update())},offsetDolly:function(e,t){g.enabled&&g.enableZoom&&"move"===t.state&&(t.dy>0?a(r()):t.dy<0&&l(r()),g.update())},wheelDolly:function(e){g.enabled&&g.enableZoom&&(e.deltaY>0?l(r()):e.deltaY<0&&a(r()),g.update())}},f.update(),f}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.setMoving=function(e){this.moving=e},t.prototype.isMoving=function(){return this.moving},t}(n.THREE.EventDispatcher);t.default=o},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o=i(0),r=n(i(6)),s=n(i(19)),a=n(i(2)),l=n(i(16)),h=n(i(73)),c=n(i(17)),u=function(e){function t(i,n,o,r,s,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var l=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,i,n,o,r));return l.query="",l.n=a,l.pdf=s,l.v={x:0,y:0,z:0,set:function(e,t,i){return this.x=e,this.y=t,this.z=i,this},transform:function(e){var t=e.m[0][0]*this.x+e.m[1][0]*this.y+e.m[2][0]*this.z,i=e.m[0][1]*this.x+e.m[1][1]*this.y+e.m[2][1]*this.z,n=e.m[0][2]*this.x+e.m[0][2]*this.y+e.m[2][0]*this.z;return this.x=t,this.y=i,this.z=n,this}},l.m={m:[[1,0,0],[0,1,0],[0,0,1]],set:function(e,t,i,n,o,r,s,a,l){return this.m=[[e,t,i],[n,o,r],[s,a,l]],this}},l.startRender=function(){l.pdf.getHandler(l.render.bind(l))},Promise.resolve().then(function(){return l.pdf.getHandler(l.init.bind(l))}),l.cssLayerRequests=[],l}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.setQuery=function(e){this.query=e.trim(),this.textContent&&this.setHits(this.textContent)},t.prototype.rectSize=function(e){return{width:e[2]-e[0],height:e[3]-e[1]}},t.prototype.createPoly=function(e,t,i){var n=[],o=this.v;return o.set(t.x,t.y,1).transform(e),n.push({x:o.x,y:o.y}),o.set(t.x,t.y+i.height,1).transform(e),n.push({x:o.x,y:o.y}),o.set(t.x+i.width,t.y+i.height,1).transform(e),n.push({x:o.x,y:o.y}),o.set(t.x+i.width,t.y,1).transform(e),n.push({x:o.x,y:o.y}),n},t.prototype.getSimulatedDoc=function(){return this},t.prototype.simulate=function(e,t,i,n){this.eventConverter&&this.eventConverter.convert(e,{doc:t,x:i,y:n})},t.prototype.setAnnotations=function(e){var t=this,i=this.viewport.transform,n=[],o=function(e){return(100*e+"").substr(0,5)},r=[];this.m.set(i[0],i[1],0,i[2],i[3],0,i[4],i[5],1);var s=e,a=Array.isArray(s),c=0;for(s=a?s:s[Symbol.iterator]();;){var u;if(a){if(c>=s.length)break;u=s[c++]}else{if((c=s.next()).done)break;u=c.value}var d=u;if("Link"===d.subtype||"Widget"===d.subtype){var p=d.rect,f={x:p[0],y:p[1]},v=this.rectSize(p),g=new h.default(this.createPoly(this.m,f,v).map(function(e){return{x:e.x/t.viewport.width,y:1-e.y/t.viewport.height}}));g.anno=d,g.callback=this.annoClb.bind(this),r.push(g);var m=g.poly;n.push('<div class="fb3d-block fb3d-link" style="top: '+o(1-m[2].y)+"%; left: "+o(m[0].x)+"%; width: "+o(m[2].x-m[0].x)+"%; height: "+o(m[2].y-m[0].y)+'%;"><a></a></div>')}}if(r.length){this.eventConverter=new l.default(this.wnd,this.doc,h.default.test,this.getSimulatedDoc());var b=r,y=Array.isArray(b),w=0;for(b=y?b:b[Symbol.iterator]();;){var k;if(y){if(w>=b.length)break;k=b[w++]}else{if((w=b.next()).done)break;k=w.value}var x=k;this.eventConverter.addCustom(x)}}this.cssLayer={html:n.length?"<pdf-layer>"+n.join("")+"</pdf-layer>":void 0},this.resolveCssLayerRequests()},t.prototype.resolveCssLayerRequests=function(){if(this.cssLayer){var e=this.cssLayerRequests,t=Array.isArray(e),i=0;for(e=t?e:e[Symbol.iterator]();;){var n;if(t){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}n(this.cssLayer.html?this.cssLayer:void 0)}}},t.prototype.getCSSLayer=function(){var e=this;return new Promise(function(t){e.cssLayerRequests.push(t),e.resolveCssLayerRequests()})},t.prototype.setHits=function(e){this.textContent=e,""!==this.query&&(this.finder=new c.default(e.items.map(function(e){return e.str}),this.query,{contexts:!1}))},t.prototype.renderHits=function(){var e=this;if(this.finder){var t=(this.page.view,(0,o.$)('<div style="position: absolute; visibility: hidden;"></div>').appendTo("body")),i=t[0],n=t.offset().left,r=this.finder.getHits(),s=Array.isArray(r),a=0;for(r=s?r:r[Symbol.iterator]();;){var l;if(s){if(a>=r.length)break;l=r[a++]}else{if((a=r.next()).done)break;l=a.value}var h=l,c=this.textContent.items[h.index],u=o.PDFJS.Util.transform(this.viewport.transform,c.transform),d=this.textContent.styles[c.fontName],p=Math.atan2(u[1],u[0])+(d.vertical?Math.PI/2:0),f=Math.sqrt(u[2]*u[2]+u[3]*u[3]),v=d.ascent?d.ascent*f:d.descent?(1+d.descent)*f:f;t.html(c.str.substr(0,h.offset)+"<span>"+c.str.substr(h.offset,h.length)+"</span>"+c.str.substr(h.offset+h.length)),i.style.fontSize=f+"px",i.style.fontFamily=d.fontFamily;var g=t.find("span"),m=d.vertical?c.height*this.viewport.scale:c.width*this.viewport.scale,b=t.width(),y=(g.offset().left-n)/b;this.m.set(1,0,0,0,1,0,u[4]+v*Math.sin(p),u[5]-v*Math.cos(p),1);var w=this.createPoly(this.m,{x:y*m,y:0},{width:m*g.width()/b,height:g.height()});w=w.map(function(t){return{x:t.x/e.viewport.width,y:1-t.y/e.viewport.height}}),this.renderHit(w)}t.remove()}},t.prototype.annoClb=function(e,t){this.context.dispatchEvent&&this.context.dispatchEvent({type:"pdfAnnotation",event:e,annotation:t.target.anno})},t.prototype.calcViewport=function(){var e=a.default.calcScale(this.size.width,this.size.height,this.resW,this.resH);(!this.viewport||Math.abs(this.viewport.scale-e)>1e-4)&&(this.viewport=this.page.getViewport({scale:e}),"full"!==this.type&&("right"===this.type?(this.viewport.offsetX+=.5*this.viewport.width*1.0005,this.viewport.transform[4]-=.5*this.viewport.width*1.0005,this.viewport.width*=.5/1.0005):this.viewport.width/=2),this.resW=this.width=this.viewport.width,this.resH=this.height=this.viewport.height)},t.prototype.init=function(){var e=this;this.type=this.pdf.getPageType(this.n),this.pdf.getPage(this.n).then(function(t){e.page=t,e.size=s.default.getPageSize(t),"full"!==e.type&&(e.size.width/=2),t.getAnnotations().then(e.setAnnotations.bind(e)),t.getTextContent().then(e.setHits.bind(e)),e.calcViewport(),e.finishLoad()}).catch(function(t){console.error("Cannot load PDF page: "+(e.n+1)),console.error(t),e.finishLoad()})},t.prototype.setResolution=function(t){e.prototype.setResolution.call(this,t),this.page&&this.calcViewport()},t.prototype.render=function(e){var t=this;this.page?(this.pushCtx(),this.ctx.clearRect(0,0,this.c.width,this.c.height),this.renderTask=this.page.render({canvasContext:this.ctx,viewport:this.viewport}),this.renderTask.onContinue=function(e){t.renderPause?t.continueRender=e:e()},this.renderTask.promise.then(function(){t.renderHits(),t.popCtx(),t.finishRender()}).catch(function(e){t.popCtx(),t.finishRender(!0)})):(this.renderBlankPage(),this.finishRender())},t}(r.default);t.default=u},function(e,t,i){"use strict";t.__esModule=!0;var n=i(0),o=function(){function e(t,i){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.container=t,this.pages=i,this.prevResults=[],t.html('\n      <div class="search">\n        <div class="query">\n          <input class="inpQuery" type="text" maxlength="30" value="" />\n        </div>\n        <div class="results">\n        </div>\n        <div class="status">\n\n        </div>\n      </div>\n    '.fb3dQFilter()),this.query=t.find(".query input"),this.results=t.find(".results"),this.status=t.find(".status"),this.binds={navigate:this.navigate.bind(this),doQuery:this.doQuery.bind(this)},this.query.on("keydown",this.binds.doQuery),this.results.on("click",this.binds.navigate)}return e.prototype.dispose=function(){this.results.off("click",this.binds.navigate),this.query.off("keydown",this.binds.doQuery)},e.prototype.navigate=function(e){if(e.preventDefault(),void 0!==this.onNavigate){var t=(0,n.$)(e.target);if(!t.hasClass("result")){var i=t.find(".result");if(i.length)t=i;else for(;t.length&&!t.hasClass("result");)t=(0,n.$)(t[0].parentNode)}var o=t.attr("data");void 0!==o&&this.onNavigate(parseInt(o))}},e.prototype.doQuery=function(){var e=this;if(this.onQuery){var t=this.queryStamp=Date.now();setTimeout(function(){t===e.queryStamp&&e.onQuery(e.query[0].value.trim())},1e3)}},e.prototype.setResults=function(e,t){this.prevResults.length&&e[0]!==this.prevResults[0]&&(this.prevResults=[],this.results.html(""));for(var i=[],o=this.prevResults.length;o<e.length;++o){var r=e[o];i.push('<div class="result" data="'+r.page+'">'),i.push("<a>"),i.push("<div>"+r.contexts.join("</div><div>")+"</div>"),i.push("</a>"),i.push("</div>")}(0,n.$)(i.join("")).appendTo(this.results),this.prevResults=[].concat(e),void 0===t?this.status.html(""):this.status.html(t+1+" of "+this.pages)},e}();t.default=o},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o=i(0),r=n(i(6)),s=n(i(3)),a=function(e){function t(i,n,r,a,l){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var h=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,i,n,r,a));return h.binds={},h.image=new Image,h.image.crossOrigin="Anonymous",h.binds.imageLoad=function(){h.width=h.image.width,h.height=h.image.height,h.resH=h.height/h.width*h.resW,h.startRender=function(){h.renderImage(h.image),h.finishRender()},h.finishLoad()},h.binds.imageError=function(){h.startRender=function(){h.renderNotFoundPage(),h.finishRender()},h.finishLoad()},(0,o.$)(h.image).on("load",h.binds.imageLoad).on("error",h.binds.imageError),h.image.src=s.default.normalizeUrl(l),h}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.dispose=function(){(0,o.$)(this.image).off("load",this.binds.imageLoad).off("error",this.binds.imageError),this.image.src="",delete this.image,e.prototype.dispose.call(this)},t}(r.default);t.default=a},function(e,t,i){"use strict";t.__esModule=!0;var n=i(0),o=function(){function e(t,i,o,r,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var a=new n.THREE.Texture;a.minFilter=n.THREE.LinearFilter,a.image=t,a.needsUpdate=!0,this.texture=a,this.tilesHorizontal=i,this.tilesVertical=o,this.numberOfTiles=r,a.repeat.set(1/this.tilesHorizontal,1/this.tilesVertical),this.tileDisplayDuration=s,this.currentDisplayTime=0,this.currentTile=0}return e.prototype.update=function(e){for(this.currentDisplayTime+=e;this.currentDisplayTime>this.tileDisplayDuration;){this.currentDisplayTime-=this.tileDisplayDuration,++this.currentTile,this.currentTile==this.numberOfTiles&&(this.currentTile=0);var t=this.currentTile%this.tilesHorizontal;this.texture.offset.x=t/this.tilesHorizontal;var i=Math.floor(this.currentTile/this.tilesHorizontal);this.texture.offset.y=i/this.tilesVertical}},e.prototype.dispose=function(){var e=this.texture.image;e.height=e.width=0,this.texture.dispose()},e}();t.default=o},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o=i(0),r=n(i(3)),s=n(i(57)),a=n(i(20)),l=function(e){function t(i,n,o,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var l=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,i,n,o.element));return r.default.extends(l,new a.default(o,s)),l}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.getCallback=function(e){return e.object.userData.mouseCallback},t.prototype.setCoordsFromEvent=function(e){var t=(0,o.$)(this.element),i=t.offset();return this.coords.x=(e.pageX-i.left)/t.width()*2-1,this.coords.y=-(e.pageY-i.top)/t.height()*2+1,this.coords},t}(s.default);t.default=l},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o=i(0),r=n(i(3)),s=n(i(67)),a=n(i(20)),l=function(e){function t(i,n,o,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var l=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,i,n,o.element));return r.default.extends(l,new a.default(o,s)),l}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.getCallback=function(e){return e.object.userData.touchCallback},t.prototype.setCoordsFromEvent=function(e){var t=(0,o.$)(this.element),i=t.offset(),n=e.touches||e.originalEvent.touches,r=n.length?n[0]:(this.lastTouches||[{pageX:0,pageY:0}])[0],s=r.pageX,a=r.pageY;return this.lastTouches=n.length?n:this.lastTouches,this.coords.x=(s-i.left)/t.width()*2-1,this.coords.y=-(a-i.top)/t.height()*2+1,this.coords},t}(s.default);t.default=l},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},r=i(0),s=n(i(8)),a=n(i(4)),l=function(){function e(t,i,n,r){var l=this,h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{kWtoH:210/297};(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.container=i,this.p=h,this.thumbnailsClb=n,this.size=r,this.queue={first:0,len:0},this.canvas=a.default.createCanvas(),this.imageFactory=new s.default(o({},t,{renderCanvas:this.canvas,renderCanvasCtx:this.canvas.getContext("2d")})),this.thumbnails=[];for(var c=0;c<r;++c){var u=this.thumbnailsClb(c);this.thumbnails.push(o({},u,{index:c,loaded:"thumbnail-image"===u.type,heading:null,thumbnail:null,title:u.title||c}))}this.binds={update:this.update.bind(this),navigate:function(e){if(e.preventDefault(),l.onNavigate){for(var t=e.target;t&&!t.dataThumbnail;)t=t.parentNode;l.onNavigate(t.dataThumbnail.index)}}},this.container.on("scroll",this.binds.update)}return e.prototype.getSize=function(){return this.size},e.prototype.setEnable=function(e){this.enable=e,this.update()},e.prototype.dispose=function(){this.container.find("a").off("click",this.binds.navigate),this.container.off("scroll",this.binds.update),this.container.html(""),this.canvas.height=this.canvas.width=0,delete this.canvas},e.prototype.setLoadQueue=function(e,t){var i=this;e=Math.min(e,this.size-1),t=Math.min(t,this.size-e),this.queue={first:e,len:t},Promise.resolve().then(function(){return i.update()})},e.prototype.load=function(e){var t=this;this.loading=!0;var i=this.imageFactory.build(e,void 0===e.number?e.index:e.number,300*this.p.kWtoH,300);i.onChange=function(n){t.setImage(e,n.toDataURL("image/png")),e.loaded=!0,i.dispose(),t.loading=!1,Promise.resolve().then(function(){return t.update()})}},e.prototype.getActive=function(){var e=this.container.scrollTop(),t=e+this.container.height(),i=[],n=this.thumbnails,o=Array.isArray(n),r=0;for(n=o?n:n[Symbol.iterator]();;){var s;if(o){if(r>=n.length)break;s=n[r++]}else{if((r=n.next()).done)break;s=r.value}var a=s;Math.max(a.first,e)<Math.min(a.last,t)&&i.push(a)}return i},e.prototype.update=function(){if(!this.loading&&this.canvas){if(this.enable){this.built||this.render();var e=this.getActive(),t=Array.isArray(e),i=0;for(e=t?e:e[Symbol.iterator]();;){var n;if(t){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}var o=n;if(!o.loaded){this.load(o);break}}}if(!this.loading)for(var r=this.queue.first;r<this.queue.first+this.queue.len;++r){var s=this.thumbnails[r];if(!s.loaded){this.load(s);break}}}},e.prototype.setImage=function(e,t){var i=e.img!==t;e.img=t,e.thumbnail&&(e.thumbnail.css("background-image",["url('",t,"')"].join("")),e.thumbnail.removeClass("loading")),i&&this.container.trigger("fb3d.thumbnails.thumbnailLoaded",[e])},e.prototype.render=function(){for(var e=['<div class="thumbnails">'],t=0;t<this.size;++t)e.push(['<div class="item"><a><div class="thumbnail loading" style="padding-top:'+Math.round(100/this.p.kWtoH)+'%;"></div></a><div class="heading"><a title="',t+1,'">',t+1,"</a></div></div>"].join(""));e.push("</div>"),this.container.append(e.join(""));for(var i=this.container.find(".item"),n=this.container.find(".thumbnails").offset().top,o=0;o<i.length;++o){var s=(0,r.$)(i[o]);this.thumbnails[o].heading=s.find(".heading"),this.thumbnails[o].thumbnail=s.find(".thumbnail"),this.thumbnails[o].first=s.offset().top-n,this.thumbnails[o].last=this.thumbnails[o].first+s.height(),this.thumbnails[o].loaded&&this.setImage(this.thumbnails[o],this.thumbnails[o].img||this.thumbnails[o].src);for(var a=s.find("a"),l=0;l<a.length;++l)a[l].dataThumbnail=this.thumbnails[o]}this.container.find("a").on("click",this.binds.navigate),this.built=!0},e}();t.default=l},function(e,t,i){"use strict";t.__esModule=!0;var n,o=i(0),r=function(e){function t(i,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var s=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,i,n));return s.element=r,s.binds={convert:s.convert.bind(s)},(0,o.$)(s.element).on("touchstart touchmove",s.binds.convert),(0,o.$)(s.doc).on("touchend",s.binds.convert),s}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.dispose=function(){(0,o.$)(this.element).off("touchstart touchmove",this.binds.convert),(0,o.$)(this.doc).off("touchend",this.binds.convert)},t}(((n=i(7))&&n.__esModule?n:{default:n}).default);t.default=r},function(e,t,i){"use strict";t.__esModule=!0;var n=(i(0),function(){function e(t){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.view=t,this.showMessage=!1,this.message="",this.updateView()}return e.prototype.dispose=function(){this.updateView(),delete this.view},e.prototype.setError=function(e){this.showMessage=!0,this.message=['<div class="text error">',e,"</div>"].join(""),this.updateView()},e.prototype.updateView=function(){this.view&&(this.view.setState("widUserMessage",{enable:!0,visible:this.showMessage,active:!1}),this.view.setState("txtUserMessage",{value:this.message,visible:!0}))},e}());t.default=n},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},_libs=__webpack_require__(0),View=function(){function View(parentContainer,onLoad){var _this3=this,template=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};_classCallCheck(this,View),this.pendings={},this.binds={onResize:this.onResize.bind(this)},this.parentContainer=(0,_libs.$)(parentContainer),this.isIOS=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,this.isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);var initUrl=this.isSafari?View.initUrl:void 0;this.parentContainer.html('<iframe title="View" style="border: 0;'+(this.isIOS?"":" width: 100%; height: 100%")+'" '+(initUrl?' src="'+initUrl+'"':"")+' scrolling="no"></iframe>'),this.frame=this.parentContainer.find("iframe")[0];var build=function build(){_this3.isIOS&&((0,_libs.$)(_this3.parentContainer[0].ownerDocument.defaultView).on("resize",_this3.binds.onResize),_this3.onResize(),setTimeout(_this3.checkIframeSize.bind(_this3),250)),_this3.container=(0,_libs.$)(_this3.frame.contentDocument.body),_this3.container.css("margin","0"),_this3.head=(0,_libs.$)(_this3.frame.contentDocument.head),_this3.onLoad=onLoad,_this3.handlers=[],_this3.styleData={};var script=template.html?template.script:_this3.getTemplate().script,urls=void 0,files=void 0,links=void 0,templateName=void 0;"function"==typeof template?(urls={},files=template(),links=[],templateName=files.name):(links=template.links||_this3.getTemplate().links,urls={styles:template.styles||_this3.getTemplate().styles,html:[template.html||_this3.getTemplate().html],script:script?[script]:[]},templateName=template.name,files={}),templateName&&_this3.container.addClass(templateName),_this3.loadFiles(urls,files).then(function(){for(var _loop4=function(){if(_isArray7){if(_i7>=_iterator7.length)return"break";_ref7=_iterator7[_i7++]}else{if((_i7=_iterator7.next()).done)return"break";_ref7=_i7.value}var e=_ref7,t=e.data,i=e.url;t=t.replace(/url\(['"](.*?)["']\)/g,function(e,t){return["url('",_this3.urlResolver(i,t),"')"].join("")}),(0,_libs.$)('<style type="text/css">'+t+"</style>").appendTo(_this3.head);var n=t.match(/\/\*json-data:(([\n\r]|.)*?)\*\//);if(n)try{_this3.styleData=_extends({},_this3.styleData,JSON.parse(n[1]))}catch(e){console.error(e)}},_iterator7=files.styles,_isArray7=Array.isArray(_iterator7),_i7=0,_iterator7=_isArray7?_iterator7:_iterator7[Symbol.iterator]();;){var _ref7,_ret4=_loop4();if("break"===_ret4)break}_this3.container.html(_this3.translate(files.html[0].data)),_this3.jLinks=[];for(var _iterator8=links,_isArray8=Array.isArray(_iterator8),_i8=0,_iterator8=_isArray8?_iterator8:_iterator8[Symbol.iterator]();;){var _ref8;if(_isArray8){if(_i8>=_iterator8.length)break;_ref8=_iterator8[_i8++]}else{if(_i8=_iterator8.next(),_i8.done)break;_ref8=_i8.value}var _link=_ref8;_this3.jLinks.push((0,_libs.$)(["<link ",_this3.objToAttrsStr(_extends({},_link,{href:_this3.urlResolver(_this3.getCurrentUrl(),_link.href)})),">"].join("")).appendTo(_this3.head))}if(files.script[0]){var init=eval(files.script[0].data);_this3.templateObject=init(_this3.container)}else _this3.templateObject={};_this3.linkControls={};for(var _iterator9=_this3.getLinks(),_isArray9=Array.isArray(_iterator9),_i9=0,_iterator9=_isArray9?_iterator9:_iterator9[Symbol.iterator]();;){var _ref9;if(_isArray9){if(_i9>=_iterator9.length)break;_ref9=_iterator9[_i9++]}else{if(_i9=_iterator9.next(),_i9.done)break;_ref9=_i9.value}var id=_ref9;_this3.linkControls[id]=_this3.container.find("."+id),_this3.binds[id]=View.handleLinkEvent.bind({getHandlers:_this3.getHandlers.bind(_this3),id,ctrl:_this3.linkControls[id]}),_this3.linkControls[id].on("click",_this3.binds[id])}_this3.widgetControls={};for(var _iterator10=_this3.getWidgets(),_isArray10=Array.isArray(_iterator10),_i10=0,_iterator10=_isArray10?_iterator10:_iterator10[Symbol.iterator]();;){var _ref10;if(_isArray10){if(_i10>=_iterator10.length)break;_ref10=_iterator10[_i10++]}else{if(_i10=_iterator10.next(),_i10.done)break;_ref10=_i10.value}var _id=_ref10;_this3.widgetControls[_id]=_this3.container.find("."+_id)}_this3.inputControls={};for(var _iterator11=_this3.getInputs(),_isArray11=Array.isArray(_iterator11),_i11=0,_iterator11=_isArray11?_iterator11:_iterator11[Symbol.iterator]();;){var _ref11;if(_isArray11){if(_i11>=_iterator11.length)break;_ref11=_iterator11[_i11++]}else{if(_i11=_iterator11.next(),_i11.done)break;_ref11=_i11.value}var _id2=_ref11;_this3.inputControls[_id2]=_this3.container.find("."+_id2),_this3.binds[_id2]=View.handleInputEvent.bind({getHandlers:_this3.getHandlers.bind(_this3),id:_id2,ctrl:_this3.inputControls[_id2]}),_this3.inputControls[_id2].on("keyup",_this3.binds[_id2])}_this3.formControls={};for(var _iterator12=_this3.getForms(),_isArray12=Array.isArray(_iterator12),_i12=0,_iterator12=_isArray12?_iterator12:_iterator12[Symbol.iterator]();;){var _ref12;if(_isArray12){if(_i12>=_iterator12.length)break;_ref12=_iterator12[_i12++]}else{if(_i12=_iterator12.next(),_i12.done)break;_ref12=_i12.value}var _id3=_ref12;_this3.formControls[_id3]=_this3.container.find("."+_id3),_this3.binds[_id3]=View.handleFormEvent.bind({getHandlers:_this3.getHandlers.bind(_this3),id:_id3,ctrl:_this3.formControls[_id3]}),_this3.formControls[_id3].on("submit",_this3.binds[_id3])}_this3.textControls={};for(var _iterator13=_this3.getTexts(),_isArray13=Array.isArray(_iterator13),_i13=0,_iterator13=_isArray13?_iterator13:_iterator13[Symbol.iterator]();;){var _ref13;if(_isArray13){if(_i13>=_iterator13.length)break;_ref13=_iterator13[_i13++]}else{if(_i13=_iterator13.next(),_i13.done)break;_ref13=_i13.value}var _id4=_ref13;_this3.textControls[_id4]=_this3.container.find("."+_id4)}_this3.stateSetters=[{map:_this3.linkControls,setter:_this3.setLinkControlState.bind(_this3)},{map:_this3.widgetControls,setter:_this3.setWidgetControlState.bind(_this3)},{map:_this3.inputControls,setter:_this3.setInputControlState.bind(_this3)},{map:_this3.textControls,setter:_this3.setTextControlState.bind(_this3)}],_this3.initView(),_this3.onLoad&&_this3.onLoad(),_this3.fireLinksOnLoadEvent()}).catch(function(e){return console.error(e)})};initUrl?(0,_libs.$)(this.frame.contentWindow).on("load",build):(this.frame.contentWindow.stop&&this.frame.contentWindow.stop(),build())}return View.classProperty=function(e,t,i){i?e.addClass(t):e.removeClass(t)},View.attributeProperty=function(e,t,i){i?e.attr(t,i):e.removeAttr(t)},View.callHandlers=function(e,t,i,n){var o=e,r=Array.isArray(o),s=0;for(o=r?o:o[Symbol.iterator]();;){var a;if(r){if(s>=o.length)break;a=o[s++]}else{if((s=o.next()).done)break;a=s.value}var l=a;l[t]?l[t](i,n):l.handleDefault&&l.handleDefault(t,i,n)}},View.handleEvent=function(e,t,i,n){View.callHandlers(t(e),e,i,n)},View.handleLinkEvent=function(e){e.preventDefault(),this.ctrl.hasClass("disabled")||View.handleEvent(this.id,this.getHandlers,e)},View.handleInputEvent=function(e){View.handleEvent(this.id,this.getHandlers,e,e.target.value)},View.handleFormEvent=function(e){e.preventDefault(),View.handleEvent(this.id,this.getHandlers,e)},View.prototype.getLinks=function(){return null},View.prototype.getWidgets=function(){return null},View.prototype.getInputs=function(){return null},View.prototype.getTexts=function(){return null},View.prototype.getTemplate=function(){return{}},View.prototype.getHandlers=function(e){return this.handlers},View.prototype.callLater=function(e,t,i,n,o){var r=this;this.pendings[t]={timestamp:(new Date).getTime()},setTimeout(function(){var s=(new Date).getTime(),a=r.pendings[t];a&&s-a.timestamp>=o&&(View.callHandlers(e,t,i,n),delete r.pendings[t])},o)},View.prototype.loadFiles=function(e,t){var i=[],n=Object.keys(e),o=Array.isArray(n),r=0;for(n=o?n:n[Symbol.iterator]();;){var s;if("break"===function(){if(o){if(r>=n.length)return"break";s=n[r++]}else{if((r=n.next()).done)return"break";s=r.value}var a=s;t[a]=[];var l=e[a],h=Array.isArray(l),c=0;for(l=h?l:l[Symbol.iterator]();;){var u;if("break"===function(){if(h){if(c>=l.length)return"break";u=l[c++]}else{if((c=l.next()).done)return"break";u=c.value}var e=u;i.push(new Promise(function(i,n){_libs.$.get(e,function(n){t[a].push({url:e,data:n}),i()}).fail(function(e){n(e)})}))}())break}}())break}return Promise.all(i)},View.prototype.getRootUrl=function(){return location.origin+"/"},View.prototype.getCurrentUrl=function(){return location.href.substr(0,location.href.lastIndexOf("/")+1)},View.prototype.urlResolver=function(e,t){if("/"===(t=t.replace(/\\/g,"/")).charAt(0)&&(e=this.getRootUrl(),t=t.substr(1)),e.match(/^https{0,1}:/i)||(e=this.urlResolver(this.getCurrentUrl(),e)),!t.match(/^(data|blob|http|https):/i)){var i=(e=e.replace(/\\/g,"/")).lastIndexOf("/"),n=(t=(~i?e.substr(0,i+1):"")+t).split("/");t=[];var o=n,r=Array.isArray(o),s=0;for(o=r?o:o[Symbol.iterator]();;){var a;if(r){if(s>=o.length)break;a=o[s++]}else{if((s=o.next()).done)break;a=s.value}var l=a;"."===l||(".."===l?t.length>3&&t.pop():t.push(l))}t=t.join("/")}return t},View.prototype.objToAttrsStr=function(e){var t=[],i=Object.keys(e),n=Array.isArray(i),o=0;for(i=n?i:i[Symbol.iterator]();;){var r;if(n){if(o>=i.length)break;r=i[o++]}else{if((o=i.next()).done)break;r=o.value}var s=r;t.push([s,'="',e[s],'"'].join(""))}return t.join(" ")},View.prototype.checkIframeSize=function(){this.frame&&((Math.abs(this.frame.width-this.parentContainer.width())>1||Math.abs(this.frame.height-this.parentContainer.height())>1)&&this.onResize(),setTimeout(this.checkIframeSize.bind(this),250))},View.prototype.onResize=function(){this.frame.width=this.parentContainer.width(),this.frame.height=this.parentContainer.height()},View.prototype.translate=function(e){return e.replace(/<\$tr>(.*)<\/\$tr>/gi,function(e,t){return(0,_libs.tr)(t)})},View.prototype.fireLinksOnLoadEvent=function(){var e=this;if(this.templateObject&&this.templateObject.linkLoaded){var t=this.jLinks,i=Array.isArray(t),n=0;for(t=i?t:t[Symbol.iterator]();;){var o;if("break"===function(){if(i){if(n>=t.length)return"break";o=t[n++]}else{if((n=t.next()).done)return"break";o=n.value}var r=o[0],s=new Image;s.onerror=function(){return e.templateObject.linkLoaded(r)},s.src=r.href}())break}}},View.prototype.dispose=function(){delete this.textControls;var e=this.getLinks(),t=Array.isArray(e),i=0;for(e=t?e:e[Symbol.iterator]();;){var n;if(t){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}var o=n;this.linkControls[o].off("click",this.binds[o])}delete this.linkControls,delete this.widgetControls;var r=this.getInputs(),s=Array.isArray(r),a=0;for(r=s?r:r[Symbol.iterator]();;){var l;if(s){if(a>=r.length)break;l=r[a++]}else{if((a=r.next()).done)break;l=a.value}var h=l;this.inputControls[h].off("keyup",this.binds[h])}delete this.inputControls;var c=this.getForms(),u=Array.isArray(c),d=0;for(c=u?c:c[Symbol.iterator]();;){var p;if(u){if(d>=c.length)break;p=c[d++]}else{if((d=c.next()).done)break;p=d.value}var f=p;this.formControls[f].off("submit",this.binds[f])}delete this.formControls,!this.templateObject.dispose||this.templateObject.dispose(),delete this.templateObject,this.isIOS&&(0,_libs.$)(this.parentContainer[0].ownerDocument.defaultView).off("resize",this.binds.onResize),this.parentContainer.html(""),delete this.frame},View.prototype.getStyleData=function(){return this.styleData},View.prototype.getContainer=function(){return this.container[0]},View.prototype.getParentContainer=function(){return this.parentContainer[0]},View.prototype.addHandler=function(e){this.handlers.push(e)},View.prototype.initView=function(){},View.setControlState=function(e,t,i,n){if(e&&e[0]){var o=_extends({},t,i);for(var r in o)o.hasOwnProperty(r)&&n[r]&&n[r](e,o[r])}},View.prototype.setLinkControlState=function(e,t){View.setControlState(this.linkControls[e],{visible:!0,active:!1,enable:!0},t,View.linkStateHandlers)},View.prototype.setWidgetControlState=function(e,t){View.setControlState(this.widgetControls[e],{visible:!0,active:!1,enable:!0},t,View.widgetStateHandlers)},View.prototype.setInputControlState=function(e,t){View.setControlState(this.inputControls[e],{visible:!0,enable:!0,value:""},t,View.inputStateHandlers)},View.prototype.setTextControlState=function(e,t){View.setControlState(this.textControls[e],{visible:!0,value:""},t,View.textStateHandlers)},View.prototype.onItemStateChanged=function(){},View.prototype.setState=function(e,t){var i=this.stateSetters,n=Array.isArray(i),o=0;for(i=n?i:i[Symbol.iterator]();;){var r;if(n){if(o>=i.length)break;r=i[o++]}else{if((o=i.next()).done)break;r=o.value}var s=r;if(s.map[e]){s.setter(e,t),this.onItemStateChanged(e,t);break}}},View}();View.initUrl=URL.createObjectURL(new Blob(['\n    <!DOCTYPE html>\n    <html lang="en">\n      <head>\n        <meta charset="utf-8">\n      </head>\n      <body style="height: 100vh">\n      </body>\n    </html>\n  '],{type:"text/html"})),View.linkStateHandlers={visible:function(e,t){return View.classProperty(e,"hidden",!t)},active:function(e,t){return View.classProperty(e,"active",t)},enable:function(e,t){return View.classProperty(e,"disabled",!t)}},View.widgetStateHandlers={visible:function(e,t){return View.classProperty(e,"hidden",!t)},active:function(e,t){return View.classProperty(e,"active",t)},enable:function(e,t){return View.classProperty(e,"disabled",!t)}},View.inputStateHandlers={visible:function(e,t){return View.classProperty(e,"hidden",!t)},value:function(e,t){return e[0].value=t},enable:function(e,t){return View.attributeProperty(e,"disabled",!t)}},View.textStateHandlers={visible:function(e,t){return View.classProperty(e,"hidden",!t)},value:function(e,t){return e.html(t)}},exports.default=View},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},r=i(0),s=n(i(3)),a=n(i(59)),l=n(i(64)),h=n(i(65)),c=n(i(51)),u=n(i(12)),d=function(e){function t(i,n,s){var d=arguments.length>3&&void 0!==arguments[3]&&arguments[3];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var p=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this));p.checkUpdateFlag=!0,p.wnd=i,p.doc=n,p.jContainer=s,p.renderCallbacks=[],p.diag=p.getDiag(),p.clock=new r.THREE.Clock,p.raycaster=new r.THREE.Raycaster,p.scene=new r.THREE.Scene,p.cssScene=new r.THREE.Scene,p.camera=new r.THREE.PerspectiveCamera(30,p.width()/p.height(),.2,2e3),p.camera.position.x=0,p.camera.position.y=5.5,p.camera.position.z=0,p.renderer=new r.THREE.WebGLRenderer({alpha:!0,precision:t.getPrecision(),antialias:!0}),p.renderer.shadowMap.enabled=!0,p.renderer.shadowMap.type=r.THREE.PCFSoftShadowMap,p.renderer.setClearColor(0,0),p.renderer.setPixelRatio(Math.sqrt(p.wnd.devicePixelRatio||1)),p.renderer.setSize(p.width(),p.height()),p.jContainer.append(p.renderer.domElement),p.cssRenderer=new u.default,p.cssRenderer.setSize(p.width(),p.height()),(0,r.$)(p.cssRenderer.domElement).css({position:"absolute",top:0,margin:0,padding:0}),p.jContainer.append(p.cssRenderer.domElement),p.element=p.cssRenderer.domElement,p.textureLoader=new r.THREE.TextureLoader,p.ambientLight=new r.THREE.AmbientLight(16777215),p.scene.add(p.ambientLight),p.light=new r.THREE.DirectionalLight(0,1),p.light.position.set(-6,6,-3),p.light.castShadow=!0,p.light.shadow.camera.left=-3,p.light.shadow.camera.right=3,p.light.shadow.camera.top=3,p.light.shadow.camera.bottom=-3,p.light.shadow.camera.near=.5,p.light.shadow.camera.far=20,p.light.shadow.mapSize.x=512,p.light.shadow.mapSize.y=512,p.scene.add(p.light),p.shadowPlace=new r.THREE.Mesh(new r.THREE.PlaneGeometry(10,10).rotateX(-Math.PI/2),new r.THREE.ShadowMaterial({color:0,transparent:!0,opacity:.2})),p.shadowPlace.position.set(0,0,0),p.shadowPlace.receiveShadow=!0,p.shadowPlace.castShadow=!1,p.scene.add(p.shadowPlace),p.controls=new a.default(p.camera,p),p.controls.target.y=.5;var f=(0,r.$)(p.cssRenderer.domElement).find("div"),v=new r.THREE.Vector3;p.controls.addEventListener("change",function(){p.camera.getWorldDirection(v),f.css("display",v.y-p.camera.position.y>0?"none":"block"),p.updateThree()}),d&&p.scene.add(new r.THREE.AxisHelper(5)),p.binds={onWindowResize:p.onWindowResize.bind(p),animate:p.animate.bind(p)},(0,r.$)(p.wnd).on("resize",p.binds.onWindowResize),p.mouseEvents=new l.default(p.wnd,p.doc,p),p.touchEvents=new h.default(p.wnd,p.doc,p);var g={type:"mousemove"};return p.mouseEvents.filter=function(e,t){var i=function(e,t){return e===t||r.$.contains(e,t)};return"mousemove"===t.type&&(g.pageX=t.pageX,g.pageY=t.pageY),t.relatedTarget&&~["mouseenter","mouseover","mouseleave","mouseout"].indexOf(t.type)&&i(e,t.target)&&i(e,t.relatedTarget)?o({},t,g):t},p.drag=new c.default(p.wnd,p.doc,p),p.onWindowResize(),p.animate(),p}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.getDiag=function(){var e=(0,r.$)('<div style="height: 1in; width: 1in; display: none;"></div>').appendTo(this.jContainer),t=new r.THREE.Vector2(screen.width/e.width(),screen.height/e.height());return e.remove(),t.length()},t.prototype.updateThree=function(){this.light.userData.needsUpdate=!0},t.prototype.setLight=function(e,t){this.ambientLight.color.set(e),this.light.color.set(t),this.updateThree()},t.prototype.dispose=function(){delete this.binds.animate,(0,r.$)(this.wnd).off("resize",this.binds.onWindowResize),this.mouseEvents.dispose(),this.touchEvents.dispose(),this.drag.dispose(),this.controls.dispose()},t.prototype.width=function(){return this.jContainer.width()||200},t.prototype.height=function(){return this.jContainer.height()||200},t.prototype.setExtraLighting=function(e){this.light.intensity=e},t.prototype.isMobile=function(){return this.diag<s.default.MOBILE_DIAG},t.prototype.getOrbit=function(){return this.controls},t.prototype.setControlsState=function(e){this.controls.enabled=e},t.prototype.getControlsState=function(){return this.controls.enabled},t.prototype.onWindowResize=function(){var e=this,t=this.width(),i=this.height();if(t>1&&i>1){var n=function(e){e.setSize(t,i)};if(!this.lastResize||Math.abs(this.lastResize.width-t)+Math.abs(this.lastResize.height-i)>1){this.lastResize={width:t,height:i};var o=this.resizeStamp=Date.now();setTimeout(function(){var r;o===e.resizeStamp&&((r=e.camera).aspect=t/i,r.updateProjectionMatrix(),n(e.renderer),n(e.cssRenderer),e.updateThree(),e.dispatchEvent({type:"resize"}))},10)}}else setTimeout(function(){e.onWindowResize()},250)},t.prototype.addObject=function(e){this.scene.add(e)},t.prototype.addCssObject=function(e){this.cssScene.add(e)},t.prototype.removeCssObject=function(e){this.cssScene.remove(e)},t.prototype.removeObject=function(e){this.scene.remove(e)},t.prototype.animate=function(){this.binds.animate&&requestAnimationFrame(this.binds.animate),this.render()},t.prototype.addRenderCallback=function(e){this.renderCallbacks.push(e)},t.prototype.removeRenderCallback=function(e){var t=this.renderCallbacks.indexOf(e);~t&&this.renderCallbacks.splice(t,1)},t.prototype.render=function(){var e=Math.min(this.clock.getDelta(),.034);this.controls.update(e);var t=this.renderCallbacks,i=Array.isArray(t),n=0;for(t=i?t:t[Symbol.iterator]();;){var o;if(i){if(n>=t.length)break;o=t[n++]}else{if((n=t.next()).done)break;o=n.value}o(e)}this.cssRenderer.render(this.cssScene,this.camera);var r=!0;if(this.checkUpdateFlag){r=!1;var s=this.scene.children,a=Array.isArray(s),l=0;for(s=a?s:s[Symbol.iterator]();;){var h;if(a){if(l>=s.length)break;h=s[l++]}else{if((l=s.next()).done)break;h=l.value}var c=h;r=r||c.userData.needsUpdate,c.userData.needsUpdate=!1}}r&&this.renderer.render(this.scene,this.camera)},t.getPrecision=function(){var e=new r.THREE.Scene;e.add(new r.THREE.AmbientLight(16777215));var t=new r.THREE.PerspectiveCamera(30,1,1,100);t.position.set(0,0,1),t.lookAt(0,0,0);var i=new r.THREE.WebGLRenderer;i.setClearColor(16777215),i.setSize(1,1);var n=document.createElement("canvas"),o=n.getContext("2d");n.width=n.height=1,o.fillStyle="#ff0000",o.fillRect(0,0,n.width,n.height);var s=new r.THREE.Texture(n);s.needsUpdate=!0,e.add(new r.THREE.Mesh(new r.THREE.PlaneGeometry(1,1,1,1),new r.THREE.MeshPhongMaterial({map:s}))),i.render(e,t);var a=function(e){var t=new Uint8Array(4);return e.readPixels(0,0,1,1,e.RGBA,e.UNSIGNED_BYTE,t),t}(i.domElement.getContext("webgl")||i.domElement.getContext("experimental-webgl"));return 255===a[0]&&0===a[1]&&0===a[2]?"highp":"mediump"},t}(r.THREE.EventDispatcher);t.default=d},function(e,t,i){"use strict";t.__esModule=!0;var n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.init=function(){return e.task||(e.task=new Promise(function(e){window.YT||(window.YT={loading:0,loaded:0}),window.YTConfig||(window.YTConfig={host:"http://www.youtube.com"}),YT.loading||(YT.loading=1,function(){var t=[];YT.ready=function(e){YT.loaded?e():t.push(e)},window.onYTReady=function(){YT.loaded=1;for(var i=0;i<t.length;i++)try{t[i]()}catch(e){}e()},YT.setConfig=function(e){for(var t in e)e.hasOwnProperty(t)&&(YTConfig[t]=e[t])};var i=document.createElement("script");i.type="text/javascript",i.id="www-widgetapi-script",i.src="https://s.ytimg.com/yts/jsbin/www-widgetapi-vfldn1jRM/www-widgetapi.js",i.async=!1;var n=document.currentScript;if(n){var o=n.nonce||n.getAttribute("nonce");o&&i.setAttribute("nonce",o)}var r=document.getElementsByTagName("script")[0];r.parentNode.insertBefore(i,r)}())})),e.task},e}();t.default=n},function(e,t,i){"use strict";t.__esModule=!0;var n,o=function(e){function t(i,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this));return r.p={x:i,y:n,r:o},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.testIntersection=function(e,t){var i=void 0,n=t.x,o=t.y,r=this.p;return(n-r.x)*(n-r.x)+(o-r.y)*(o-r.y)<=r.r*r.r&&(i={target:this,data:t}),i},t}(((n=i(23))&&n.__esModule?n:{default:n}).default);t.default=o},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o=n(i(23)),r=n(i(2)),s=function(e){function t(i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this));return n.poly=i,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.testIntersection=function(e,t){return r.default.isInsidePoly(this.poly,t)?{target:this,data:t}:void 0},t}(o.default);t.default=s},function(e,t,i){var n;n=function(e){function t(t){var s=t||window.event,a=l.call(arguments,1),h=0,u=0,d=0,p=0,f=0,v=0;if((t=e.event.fix(s)).type="mousewheel","detail"in s&&(d=-1*s.detail),"wheelDelta"in s&&(d=s.wheelDelta),"wheelDeltaY"in s&&(d=s.wheelDeltaY),"wheelDeltaX"in s&&(u=-1*s.wheelDeltaX),"axis"in s&&s.axis===s.HORIZONTAL_AXIS&&(u=-1*d,d=0),h=0===d?u:d,"deltaY"in s&&(h=d=-1*s.deltaY),"deltaX"in s&&(u=s.deltaX,0===d&&(h=-1*u)),0!==d||0!==u){if(1===s.deltaMode){var g=e.data(this,"mousewheel-line-height");h*=g,d*=g,u*=g}else if(2===s.deltaMode){var m=e.data(this,"mousewheel-page-height");h*=m,d*=m,u*=m}if(p=Math.max(Math.abs(d),Math.abs(u)),(!r||p<r)&&(r=p,n(s,p)&&(r/=40)),n(s,p)&&(h/=40,u/=40,d/=40),h=Math[h>=1?"floor":"ceil"](h/r),u=Math[u>=1?"floor":"ceil"](u/r),d=Math[d>=1?"floor":"ceil"](d/r),c.settings.normalizeOffset&&this.getBoundingClientRect){var b=this.getBoundingClientRect();f=t.clientX-b.left,v=t.clientY-b.top}return t.deltaX=u,t.deltaY=d,t.deltaFactor=r,t.offsetX=f,t.offsetY=v,t.deltaMode=0,a.unshift(t,h,u,d),o&&clearTimeout(o),o=setTimeout(i,200),(e.event.dispatch||e.event.handle).apply(this,a)}}function i(){r=null}function n(e,t){return c.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120==0}var o,r,s=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],a="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],l=Array.prototype.slice;if(e.event.fixHooks)for(var h=s.length;h;)e.event.fixHooks[s[--h]]=e.event.mouseHooks;var c=e.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var i=a.length;i;)this.addEventListener(a[--i],t,!1);else this.onmousewheel=t;e.data(this,"mousewheel-line-height",c.getLineHeight(this)),e.data(this,"mousewheel-page-height",c.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var i=a.length;i;)this.removeEventListener(a[--i],t,!1);else this.onmousewheel=null;e.removeData(this,"mousewheel-line-height"),e.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var i=e(t),n=i["offsetParent"in e.fn?"offsetParent":"parent"]();return n.length||(n=e("body")),parseInt(n.css("fontSize"),10)||parseInt(i.css("fontSize"),10)||16},getPageHeight:function(t){return e(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})},e.exports=n},function(e,t,i){var n;e.exports=((n=function(){function e(e){return o.appendChild(e.dom),e}function t(e){for(var t=0;t<o.children.length;t++)o.children[t].style.display=t===e?"block":"none";i=e}var i=0,o=document.createElement("div");o.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",o.addEventListener("click",function(e){e.preventDefault(),t(++i%o.children.length)},!1);var r=(performance||Date).now(),s=r,a=0,l=e(new n.Panel("FPS","#0ff","#002")),h=e(new n.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var c=e(new n.Panel("MB","#f08","#201"));return t(0),{REVISION:16,dom:o,addPanel:e,showPanel:t,begin:function(){r=(performance||Date).now()},end:function(){a++;var e=(performance||Date).now();if(h.update(e-r,200),e>s+1e3&&(l.update(1e3*a/(e-s),100),s=e,a=0,c)){var t=performance.memory;c.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e},update:function(){r=this.end()},domElement:o,setMode:t}}).Panel=function(e,t,i){var n=1/0,o=0,r=Math.round,s=r(window.devicePixelRatio||1),a=80*s,l=48*s,h=3*s,c=2*s,u=3*s,d=15*s,p=74*s,f=30*s,v=document.createElement("canvas");v.width=a,v.height=l,v.style.cssText="width:80px;height:48px";var g=v.getContext("2d");return g.font="bold "+9*s+"px Helvetica,Arial,sans-serif",g.textBaseline="top",g.fillStyle=i,g.fillRect(0,0,a,l),g.fillStyle=t,g.fillText(e,h,c),g.fillRect(u,d,p,f),g.fillStyle=i,g.globalAlpha=.9,g.fillRect(u,d,p,f),{dom:v,update:function(l,m){n=Math.min(n,l),o=Math.max(o,l),g.fillStyle=i,g.globalAlpha=1,g.fillRect(0,0,a,d),g.fillStyle=t,g.fillText(r(l)+" "+e+" ("+r(n)+"-"+r(o)+")",h,c),g.drawImage(v,u+s,d,p-s,f,u,d,p-s,f),g.fillRect(u+p-s,d,s,f),g.fillStyle=i,g.globalAlpha=.9,g.fillRect(u+p-s,d,s,r((1-l/m)*f))}}},n)},function(e,t,i){i(25),e.exports=i(24)}]);